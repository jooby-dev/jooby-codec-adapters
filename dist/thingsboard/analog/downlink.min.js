// these options can be edited
// available hardware types can be found here:
// https://github.com/jooby-dev/jooby-docs/blob/main/docs/analog/basics.md#hardware-types
var config = {
    hardwareType: 0
};


//#region [autogenerated jooby-codec bundle]
var toBytes,getBase64FromBytes;(function(){"use strict";Array.prototype.fill=Array.prototype.fill||function(t){var e=Object(this);var n=parseInt(e.length,10);var r=arguments[1];var i=parseInt(r,10)||0;var a=i<0?Math.max(n+i,0):Math.min(i,n);var s=arguments[2];var o=s===undefined?n:parseInt(s)||0;var f=o<0?Math.max(n+o,0):Math.min(o,n);for(;a<f;a++){e[a]=t}return e};function t(t){return e(t)||n(t)||r(t)||a()}function e(t){if(Array.isArray(t))return i(t)}function n(t){if(typeof Symbol!=="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function r(t,e){if(!t)return;if(typeof t==="string")return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor)n=t.constructor.name;if(n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}function i(t,e){if(e==null||e>t.length)e=t.length;for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s=1;var o=2;var f=4;var u=Math.log,h=Math.pow,v=Math.LN2;var c=function(t,e,n,r,i){var a,s,o=i*8-r-1,f=(1<<o)-1,u=f>>1,v=-7,c=n?i-1:0,l=n?-1:1,d=t[e+c];c+=l;a=d&(1<<-v)-1;d>>=-v;v+=o;for(;v>0;a=a*256+t[e+c],c+=l,v-=8);s=a&(1<<-v)-1;a>>=-v;v+=r;for(;v>0;s=s*256+t[e+c],c+=l,v-=8);if(a===0){a=1-u}else if(a===f){return s?NaN:d?-Infinity:Infinity}else{s=s+h(2,r);a=a-u}return(d?-1:1)*s*h(2,a-r)};var l=function(t,e,n,r,i,a){var s,o,f,c=a*8-i-1,l=(1<<c)-1,d=l>>1,p=i===23?h(2,-24)-h(2,-77):0,g=r?0:a-1,y=r?1:-1,w=n<0||n===0&&1/n<0?1:0;n<0&&(n=-n);if(n!==n||n===Infinity){o=n!==n?1:0;s=l}else{s=u(n)/v|0;if(n*(f=h(2,-s))<1){s--;f*=2}if(s+d>=1){n+=p/f}else{n+=p*h(2,1-d)}if(n*f>=2){s++;f/=2}if(s+d>=l){o=0;s=l}else if(s+d>=1){o=(n*f-1)*h(2,i);s=s+d}else{o=n*h(2,d-1)*h(2,i);s=0}}for(;i>=8;t[e+g]=o&255,g+=y,o/=256,i-=8);s=s<<i|o;c+=i;for(;c>0;t[e+g]=s&255,g+=y,s/=256,c-=8);t[e+g-y]|=w*128};var d=[1,0];var p=[3,2,1,0];var g=[0,1];var y=[0,1,2,3];var w=function(t,e){return t[e]};var m=function(t,e,n){var r=n?g:d;var i=t[e+r[0]];var a=t[e+r[1]]<<8;return i|a};var C=function(t,e,n){var r=n?y:p;var i=t[e+r[3]]*16777216;var a=t[e+r[2]]*65536;var s=t[e+r[1]]*256;var o=t[e+r[0]];return i+a+s+o};var E=function(t,e,n){t[e]=n&255};var M=function(t,e,n,r){var i=r?g:d;t[e+i[0]]=n&255;t[e+i[1]]=n>>>8&255};var U=function(t,e,n,r){var i=r?y:p;t[e+i[0]]=n&255;t[e+i[1]]=n>>>8&255;t[e+i[2]]=n>>>16&255;t[e+i[3]]=n>>>24&255};function x(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof t==="number"){var n=new Array(t).fill(0);this.data=n}else{this.data=t}this.offset=0;this.isLittleEndian=e}x.prototype={toUint8Array:function(){return this.data},seek:function(t){if(t<0||t>=this.data.length){throw new Error("Invalid position.")}this.offset=t},setInt8:function(t){E(this.data,this.offset,t<0?t|256:t);this.offset+=s},getInt8:function(){var t=w(this.data,this.offset);this.offset+=s;return t&128?t^-256:t},setUint8:function(t){E(this.data,this.offset,t);this.offset+=s},getUint8:function(){var t=w(this.data,this.offset);this.offset+=s;return t},setInt16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;M(this.data,this.offset,t<0?t|65536:t,e);this.offset+=o},getInt16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=m(this.data,this.offset,t);this.offset+=o;return e&32768?e^-65536:e},setUint16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;M(this.data,this.offset,t,e);this.offset+=o},getUint16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=m(this.data,this.offset,t);this.offset+=o;return e},setInt32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;U(this.data,this.offset,t<0?t|4294967296:t,e);this.offset+=f},getInt32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=C(this.data,this.offset,t);this.offset+=f;return e&2147483648?e^-4294967296:e},setUint32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;U(this.data,this.offset,t,e);this.offset+=f},getUint32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=C(this.data,this.offset,t);this.offset+=f;return e},setFloat32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;l(this.data,this.offset,t,e,23,4);this.offset+=f},getFloat32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=c(this.data,this.offset,t,23,4);this.offset+=f;return e},setString:function(t){this.setUint8(t.length);for(var e=0;e<t.length;++e){this.setUint8(t.charCodeAt(e))}},getString:function(){var t=this.getUint8();var e=this.offset+t;var n=[];while(this.offset<e){n.push(String.fromCharCode(this.getUint8()))}return n.join("")},getBytesToOffset:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,t)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=e+t;return this.data.slice(e,this.offset)},setBytes:function(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var r=this.data;r.splice.apply(r,[n,e.length].concat(t(e)));this.data=r;this.offset=n+e.length}};Object.defineProperties(x.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var L=31;var I=function(t,e){if((t&L)===0){if(e>L){throw new Error("Wrong command id/size. Id: ".concat(t,", size: ").concat(e,"."))}return[t|e]}if(t>L){return[L,t>>8,e]}return[t,e]};var b=function(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var r=I(e,n.length);return[].concat(t(r),t(n))};var V=12;var T=2;var S=function(t){var e=t.sequenceNumber,n=t.seconds;var r=new x(T,false);r.setUint8(e);r.setInt8(n);return b(V,r.data)};var B=7;var O=function(){return b(B)};var A=24;var D=function(){return b(A)};var H=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=0;for(var r in e){if(r in t&&e[r]){n|=t[r]}}return n};var P=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var n={};for(var r in t){n[r]=(e&t[r])!==0}return n};var F=9466848e5;var j=1e3;var N=function(t){return new Date(F+t*j)};var W=function(t){return(t.getTime()-F)/j};var k=1;var z=2;var R=3;var q=4;var Y=5;var $=6;var G=7;var J=8;var K=9;var Q=10;var X=11;var Z=12;var _=function(t){var e={};for(var n in t){var r=t[n];e[r]=n}return e};var tt=2e3;var et=4;var nt=5;var rt=1;var it=4095;var at=128;var st=7;var ot=[z,R,k,Z];var ft=[J,Y,K,q];var ut=[X];var ht=[$,Q];var vt=[G];var ct={isBatteryLow:Math.pow(2,0),isMagneticInfluence:Math.pow(2,1),isButtonReleased:Math.pow(2,2),isConnectionLost:Math.pow(2,3)};var lt={isBatteryLow:Math.pow(2,0),isConnectionLost:Math.pow(2,3),isFirstChannelInactive:Math.pow(2,4),isSecondChannelInactive:Math.pow(2,5)};var dt={isConnectionLost:Math.pow(2,3)};var pt={isBatteryLow:Math.pow(2,0),isConnectionLost:Math.pow(2,3),isFirstChannelInactive:Math.pow(2,4),isSecondChannelInactive:Math.pow(2,5),isThirdChannelInactive:Math.pow(2,6),isForthChannelInactive:Math.pow(2,7)};var gt={isMeterCaseOpen:Math.pow(2,0),isMagneticInfluence:Math.pow(2,1),isParametersSetRemotely:Math.pow(2,2),isParametersSetLocally:Math.pow(2,3),isMeterProgramRestarted:Math.pow(2,4),isLockedOut:Math.pow(2,5),isTimeSet:Math.pow(2,6),isTimeCorrected:Math.pow(2,7),isMeterFailure:Math.pow(2,8),isMeterTerminalBoxOpen:Math.pow(2,9),isModuleCompartmentOpen:Math.pow(2,10),isTariffPlanChanged:Math.pow(2,11),isNewTariffPlanReceived:Math.pow(2,12)};var yt={128:1,129:5,130:10,131:100,132:1e3,133:1e4,134:1e5};var wt=_(yt);var mt=function(t){return!!(t&128)};function Ct(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;x.call(this,t,e)}Ct.prototype=Object.create(x.prototype);Ct.prototype.constructor=Ct;Ct.prototype.getExtendedValue=function(){var t=0;var e=true;var n=0;while(e&&this.offset<=this.data.length){var r=this.getUint8();e=!!(r&at);t+=(r&127)<<7*n;++n}if(t<0){t=0}return t};Ct.prototype.setExtendedValue=function(t){var e=this;if(t===0){this.setUint8(0);return}var n=[];var r=t;while(r){n.push(at|r&127);r>>=7}var i=n.pop();if(i){n.push(i&127)}n.forEach((function(t){return e.setUint8(t)}))};Ct.prototype.getExtendedValueSize=function(t){var e=Math.ceil(t/7);var n=t+e;var r=Math.ceil(n/8);return r};Ct.prototype.getTime=function(){return this.getUint32(false)};Ct.prototype.setTime=function(t){this.setUint32(t,false)};Ct.prototype.getBatteryVoltage=function(){var t=this.getUint8();var e=this.getUint8();var n=this.getUint8();var r=t<<4;r|=(e&240)>>4;var i=(e&15)<<8|n;if(i===it){i=undefined}if(r===it){r=undefined}return{underLowLoad:r,underHighLoad:i}};Ct.prototype.setBatteryVoltage=function(t){var e=this;var n=t.underLowLoad,r=t.underHighLoad;if(n===undefined){n=it}if(r===undefined){r=it}var i=n>>4&255;var a=(n&15)<<4|r>>8&15;var s=r&255;[i,a,s].forEach((function(t){return e.setUint8(t)}))};Ct.prototype.getChannels=function(){var t=[];var e=true;var n=1;while(e){var r=this.getUint8();var i=r.toString(2).padStart(st+1,"0").split("").reverse();i.forEach((function(r,i){var a=Number(r);if(i===st){e=!!a}else{if(a){t.push(n)}++n}}))}return t};Ct.prototype.setChannels=function(e){var n=this;if(e.length===0){this.setUint8(0);return}e.sort((function(t,e){return t.index-e.index}));var r=Math.max.apply(Math,t(e.map((function(t){var e=t.index;return e}))));var i=(r-r%8)/8;var a=new Array(i+1).fill(0);var s=0;a.forEach((function(t,n){var r=n*st+1;var i=r+st;while(r<i){var o=e.find((function(t){return t.index===r}));if(o!==undefined){s|=1<<(o.index-1)%st}++r}if(a[n+1]!==undefined){s|=1<<st}a[n]=s;s=0}));a.forEach((function(t){return n.setUint8(t)}))};Ct.prototype.getChannelsValuesWithHourDiff=function(){var t=this;var e=this.getDate();var n=this.getHours(),r=n.hour,i=n.hours;var a=this.getChannels();var s=[];e.setUTCHours(r);a.forEach((function(e){var n=[];var r=t.getExtendedValue();for(var a=1;a<i;++a){n.push(t.getExtendedValue())}s.push({value:r,diff:n,index:e})}));return{startTime2000:W(e),hours:i,channelList:s}};Ct.prototype.setChannelsValuesWithHourDiff=function(t,e,n){var r=this;var i=N(e);var a=i.getUTCHours();this.setDate(i);this.setHours(a,t);this.setChannels(n);n.forEach((function(t){var e=t.value,n=t.diff;r.setExtendedValue(e);n.forEach((function(t){return r.setExtendedValue(t)}))}))};Ct.prototype.getHours=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.getUint8();if(t===0){return{hours:0,hour:0}}var e=((t&224)>>5)+1;var n=t&31;return{hours:e,hour:n}};Ct.prototype.setHours=function(t,e){if(t===0&&e===0){this.setUint8(0);return}this.setUint8((e-1&7)<<5|t&31)};Ct.prototype.getDate=function(){var t=this.getUint8();var e=this.getUint8();var n=t>>rt;var r=(t&1)<<et-rt|e>>nt;var i=e&31;return new Date(Date.UTC(n+tt,r-1,i,0,0,0,0))};Ct.prototype.setDate=function(t){var e=this;var n;if(t instanceof Date){n=t}else{n=N(t)}var r=n.getUTCFullYear()-tt;var i=n.getUTCMonth()+1;var a=n.getUTCDate();var s=r<<rt|i>>et-rt;var o=(i&7)<<nt|a;[s,o].forEach((function(t){return e.setUint8(t)}))};Ct.prototype.getPulseCoefficient=function(){var t=this.getUint8();if(mt(t)){var e=yt[t];if(e){return e}throw new Error("pulseCoefficient MSB is set, but value unknown")}return t};Ct.prototype.setPulseCoefficient=function(t){if(t in wt){var e=wt[t];if(e){this.setUint8(e)}else{throw new Error("pulseCoefficient MSB is set, but value unknown")}}else{this.setUint8(t)}};Ct.prototype.getChannelsWithAbsoluteValues=function(){var t=this;var e=this.getChannels();var n=[];e.forEach((function(e){n.push({pulseCoefficient:t.getPulseCoefficient(),value:t.getExtendedValue(),index:e})}));return n};Ct.prototype.setChannelsWithAbsoluteValues=function(t){var e=this;this.setChannels(t);t.forEach((function(t){var n=t.value,r=t.pulseCoefficient;e.setPulseCoefficient(r);e.setExtendedValue(n)}))};Ct.prototype.getChannelsAbsoluteValuesWithHourDiff=function(t){var e=this;var n=this.getChannels();var r=[];n.forEach((function(n){var i=e.getPulseCoefficient();var a=e.getExtendedValue();var s=[];for(var o=1;o<t;++o){s.push(e.getExtendedValue())}r.push({diff:s,value:a,pulseCoefficient:i,index:n})}));return r};Ct.prototype.setChannelsAbsoluteValuesWithHourDiff=function(t){var e=this;this.setChannels(t);t.forEach((function(t){var n=t.value,r=t.diff,i=t.pulseCoefficient;e.setPulseCoefficient(i);e.setExtendedValue(n);r.forEach((function(t){return e.setExtendedValue(t)}))}))};Ct.prototype.getEventStatus=function(t){var e;if(ot.indexOf(t)!==-1){e=P(ct,this.getUint8())}else if(ft.indexOf(t)!==-1){e=P(lt,this.getUint8())}else if(ut.indexOf(t)!==-1){e=P(dt,this.getUint8())}else if(ht.indexOf(t)!==-1){e=P(pt,this.getExtendedValue())}else if(vt.indexOf(t)!==-1){e=P(gt,this.getUint16())}else{throw new Error("wrong hardwareType")}return e};Ct.prototype.setEventStatus=function(t,e){if(ot.indexOf(t)!==-1){this.setUint8(H(ct,e))}else if(ft.indexOf(t)!==-1){this.setUint8(H(lt,e))}else if(ut.indexOf(t)!==-1){this.setUint8(H(dt,e))}else if(ht.indexOf(t)!==-1){this.setExtendedValue(H(pt,e))}else if(vt.indexOf(t)!==-1){this.setUint16(H(gt,e))}else{throw new Error("wrong hardwareType")}};var Et=11;var Mt=5;var Ut=function(t){var e=t.startTime2000,n=t.events;var r=new Ct(Mt);r.setTime(e);r.setUint8(n);return b(Et,r.data)};var xt=543;var Lt=function(){return b(xt)};var It=20;var bt=function(){return b(It)};var Vt=9;var Tt=function(){return b(Vt,[])};var St=2;var Bt=5;var Ot=function(t){var e=t.sequenceNumber,n=t.seconds;var r=new x(Bt,false);r.setUint8(e);r.setInt32(n);return b(St,r.data)};var At=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var n=e;t.forEach((function(t){n^=t}));return n};var Dt=function(e){return function(n){var r;var i=n.map((function(t){if("parameters"in t){return e[t.id](t.parameters,t.config)}if("command"in t){return t.command.bytes}throw new Error("wrong command format")}));var a=(r=[]).concat.apply(r,t(i));return[].concat(t(a),[At(a)])}};var Ht={};var Pt=Dt(Ht);Ht[V]=S;Ht[B]=O;Ht[A]=D;Ht[Et]=Ut;Ht[xt]=Lt;Ht[It]=bt;Ht[Vt]=Tt;Ht[St]=Ot;var Ft=function(t){return btoa(t.map((function(t){return String.fromCharCode(t)})).join(""))};getBase64FromBytes=Ft;toBytes=Pt})();
//#endregion


/*
  Incoming arguments:
    * msg - JSON message payload downlink message json
    * msgType - type of message, for ex. 'ATTRIBUTES_UPDATED', 'POST_TELEMETRY_REQUEST', etc.
    * metadata - list of key-value pairs with additional data about the message
    * integrationMetadata - list of key-value pairs with additional data defined in Integration executing this converter

  Output must be an object with the following fields:
    * contentType - BINARY
    * data - payload in base64
*/

var result = {
    contentType: 'BINARY',
    data: getBase64FromBytes(toBytes(msg.commands, config))
};

return result;
