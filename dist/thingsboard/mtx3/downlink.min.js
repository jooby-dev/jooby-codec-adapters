// IMPORTANT!!!
// This example only for default downlink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/

// encoded message should be less than this size
// to be able to send to a device
var MAX_DATA_SEGMENT_SIZE = 50;


//#region [autogenerated jooby-codec bundle from index.js]
var toBytes,setDataSegment,getBase64FromBytes;(function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,r=Array(e);i<e;i++)r[i]=t[i];return r}function e(t){if(Array.isArray(t))return t}function i(e){if(Array.isArray(e))return t(e)}function r(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function n(t,e){var i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var r,n,a,s,o=[],h=!0,E=!1;try{if(a=(i=i.call(t)).next,0===e);else for(;!(h=(r=a.call(i)).done)&&(o.push(r.value),o.length!==e);h=!0);}catch(t){E=!0,n=t}finally{try{if(!h&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(E)throw n}}return o}}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,i){return e(t)||n(t,i)||E(t,i)||a()}function h(t){return i(t)||r(t)||E(t)||s()}function E(e,i){if(e){if("string"==typeof e)return t(e,i);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,i):void 0}}var _={separator:" ",prefix:""};var f=1;var u=2;var T=3;var v=4;var A=Math.log,R=Math.pow,U=Math.LN2;var d=function(t,e,i,r,n){var a,s,o=n*8-r-1,h=(1<<o)-1,E=h>>1,_=-7,f=i?n-1:0,u=i?-1:1,T=t[e+f];f+=u;a=T&(1<<-_)-1;T>>=-_;_+=o;for(;_>0;a=a*256+t[e+f],f+=u,_-=8);s=a&(1<<-_)-1;a>>=-_;_+=r;for(;_>0;s=s*256+t[e+f],f+=u,_-=8);if(a===0){a=1-E}else if(a===h){return s?NaN:T?-Infinity:Infinity}else{s=s+R(2,r);a=a-E}return(T?-1:1)*s*R(2,a-r)};var p=function(t,e,i,r,n,a){var s,o,h,E=a*8-n-1,_=(1<<E)-1,f=_>>1,u=n===23?R(2,-24)-R(2,-77):0,T=r?0:a-1,v=r?1:-1,d=i<0||i===0&&1/i<0?1:0;i<0&&(i=-i);if(i!==i||i===Infinity){o=i!==i?1:0;s=_}else{s=A(i)/U|0;if(i*(h=R(2,-s))<1){s--;h*=2}if(s+f>=1){i+=u/h}else{i+=u*R(2,1-f)}if(i*h>=2){s++;h/=2}if(s+f>=_){o=0;s=_}else if(s+f>=1){o=(i*h-1)*R(2,n);s=s+f}else{o=i*R(2,f-1)*R(2,n);s=0}}for(;n>=8;t[e+T]=o&255,T+=v,o/=256,n-=8);s=s<<n|o;E+=n;for(;E>0;t[e+T]=s&255,T+=v,s/=256,E-=8);t[e+T-v]|=d*128};var c=[1,0];var g=[2,1,0];var l=[3,2,1,0];var O=[0,1];var y=[0,1,2];var P=[0,1,2,3];var I=function(t,e){return t[e]};var m=function(t,e,i){var r=i?O:c;var n=t[e+r[0]];var a=t[e+r[1]]<<8;return n|a};var N=function(t,e,i){var r=i?y:g;var n=t[e+r[0]];var a=t[e+r[1]]<<8;var s=t[e+r[2]]<<16;return n|a|s};var M=function(t,e,i){var r=i?P:l;var n=t[e+r[3]]*16777216;var a=t[e+r[2]]*65536;var s=t[e+r[1]]*256;var o=t[e+r[0]];return n+a+s+o};var S=function(t,e,i){t[e]=i&255};var D=function(t,e,i,r){var n=r?O:c;t[e+n[0]]=i&255;t[e+n[1]]=i>>>8&255};var C=function(t,e,i,r){var n=r?y:g;t[e+n[0]]=i&255;t[e+n[1]]=i>>>8&255;t[e+n[2]]=i>>>16&255};var L=function(t,e,i,r){var n=r?P:l;t[e+n[0]]=i&255;t[e+n[1]]=i>>>8&255;t[e+n[2]]=i>>>16&255;t[e+n[3]]=i>>>24&255};function F(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof t==="number"){var i=new Array(t).fill(0);this.data=i}else{this.data=t}this.offset=0;this.isLittleEndian=e}F.prototype={toUint8Array:function(){return this.data},seek:function(t){if(t<0||t>=this.data.length){throw new Error("Invalid position.")}this.offset=t},setInt8:function(t){S(this.data,this.offset,t<0?t|256:t);this.offset+=f},getInt8:function(){var t=I(this.data,this.offset);this.offset+=f;return t&128?t^-256:t},setUint8:function(t){S(this.data,this.offset,t);this.offset+=f},getUint8:function(){var t=I(this.data,this.offset);this.offset+=f;return t},setInt16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;D(this.data,this.offset,t<0?t|65536:t,e);this.offset+=u},getInt16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=m(this.data,this.offset,t);this.offset+=u;return e&32768?e^-65536:e},setUint16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;D(this.data,this.offset,t,e);this.offset+=u},getUint16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=m(this.data,this.offset,t);this.offset+=u;return e},setInt24:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;C(this.data,this.offset,t<0?t|16777216:t,e);this.offset+=T},getInt24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=N(this.data,this.offset,t);this.offset+=T;return e&8388608?e^-16777216:e},setUint24:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;C(this.data,this.offset,t,e);this.offset+=T},getUint24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=N(this.data,this.offset,t);this.offset+=T;return e},setInt32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;L(this.data,this.offset,t<0?t|4294967296:t,e);this.offset+=v},getInt32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=M(this.data,this.offset,t);this.offset+=v;return e&2147483648?e^-4294967296:e},setUint32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;L(this.data,this.offset,t,e);this.offset+=v},getUint32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=M(this.data,this.offset,t);this.offset+=v;return e},setFloat32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;p(this.data,this.offset,t,e,23,4);this.offset+=v},getFloat32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=d(this.data,this.offset,t,23,4);this.offset+=v;return e},setString:function(t){this.setUint8(t.length);for(var e=0;e<t.length;++e){this.setUint8(t.charCodeAt(e))}},getString:function(){var t=this.getUint8();var e=this.offset+t;var i=[];while(this.offset<e){i.push(String.fromCharCode(this.getUint8()))}return i.join("")},getBytesToOffset:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,t)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=e+t;return this.data.slice(e,this.offset)},setBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var i=this.data;i.splice.apply(i,[e,t.length].concat(h(t)));this.data=i;this.offset=e+t.length}};Object.defineProperties(F.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var V=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=0;for(var r in e){if(r in t&&e[r]){i|=t[r]}}return i};var Y=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var i={};for(var r in t){i[r]=(e&t[r])!==0}return i};var x=function(t,e,i){return(1<<e)-1&t>>i-1};var w=function(t,e,i,r){var n=(1<<e)-1<<i-1;var a=r;var s=t;s&=~n;a<<=i-1;s|=a;return s};var W=function(t){var e=t.trim();if(!e){return[]}e=e.replace(/0x/g,"").split(/\s+/).map((function(t){return t.padStart(2,"0")})).join("");if(e.length%2!==0){e="0".concat(e)}var i=e.length/2;var r=new Array(i);for(var n=0;n<i;n++){r[n]=parseInt(e.substring(n*2,n*2+2),16)}return r};var H="x";var G=[".","1","3","R","M"];var X=[".","A","G","R","T","D"];var B=[".","0","1","2","3","4","5"];var b=[".","A","B","C","D","E","F"];var Q=[".","A","B","C","D","E","F","H","K","G"];var j=[".","1","2","3","4"];var K=[".","L","M","Z","K"];var q=[".","0","1","2","3","4","5","6","7","8","9"];var k=[".","D","B","C","E","P","R","O","L","F","S","M","Y","G","N","U"];var z=[".","0","1","2","3","4","5","6","P","R","L","E","G","-","/"];var Z=[".","H","A","T","0","0","0","0","0","1","2","3","4","0","0","0"];var $=[".","0","1","2","3","4","5","6","7","8","I","X","G","W","M","-"];var J=function(t){return[t>>4,t&15]};var tt=function(t){var e=new Array(t.length*2).fill(0);t.forEach((function(t,i){var r=J(t),n=o(r,2),a=n[0],s=n[1];e[i*2]=a;e[i*2+1]=s}));return e};var et=function(t){var e=[];t.forEach((function(t){return e.push(t.toString(16))}));if(t.length&1){e.push("0")}return W(e.join(""))};var it=function(t){if(t.length!==14&&t.length!==16){throw new Error("Device type bytes wrong size")}var e=["MTX "];e.push(G[t[0]]??H);e.push(X[t[1]]??H);e.push(B[t[2]]??H);e.push(B[t[3]]??H);e.push(".");e.push(b[t[4]]??H);e.push(Q[t[5]]??H);e.push(".");e.push(j[t[6]]??H);e.push(K[t[7]]??H);var i=t[8];e.push(q[t[9]]??H);e.push("-");var r;if(t.length<14||t[12]===0&&t[13]===0){e.push(k[t[10]]??H);r=11}else if(t[13]===0){e.push(k[t[10]]??H);e.push(k[t[11]]??H);r=12}else{e.push(k[t[10]]??H);e.push(k[t[11]]??H);e.push(k[t[12]]??H);r=13}var n=t[r];if(n&&n!==0){e.push(Z[n]??H)}return{type:e.join(""),revision:i,meterType:0}};var rt=function(t,e,i){var r=[];if(t.length<11){throw new Error("Wrong format")}r.push(G.indexOf(t[0]));r.push(X.indexOf(t[1]));r.push(B.indexOf(t[2]));r.push(B.indexOf(t[3]));if(t[4]!=="."){throw new Error("Wrong format")}r.push(b.indexOf(t[5]));r.push(Q.indexOf(t[6]));if(t[7]!=="."){throw new Error("Wrong format")}r.push(j.indexOf(t[8]));r.push(K.indexOf(t[9]));r.push(i??0);r.push(q.indexOf(t[10]));if(t[11]!=="-"){throw new Error("Wrong format")}var n=t.length>13?t.length-1:t.length;for(var a=12;a<n;a++){r.push(k.indexOf(t[a]))}if(n<t.length){r.push(Z.indexOf(t[n]))}var s=et(r);var o=new Array(9).fill(0);o[0]=0;for(var h=0;h<s.length;h++){o[h+(s.length<8?1:0)]=s[h]}return o};var nt=function(t){if(t.length<14){throw new Error("The buffer is too small")}var e=["MTX "];var i=t[1]===5?"-":" ";e.push(G[t[0]]??H);e.push(X[t[1]]??H);e.push(i);for(var r=2;r<t.length;r++){if(t[r]!==0){e.push(z[t[r]]??H)}}return{type:e.join(""),meterType:0}};var at=function(t){if(t.length<3){throw new Error("Wrong format")}var e=[];e.push(G.indexOf(t[0]));e.push(X.indexOf(t[1]));for(var i=3;i<t.length;i++){e.push(z.indexOf(t[i]))}var r=et(e);if(r.length===8){return r}if(r.length>8){throw new Error("Wrong format")}var n=new Array(8).fill(0);for(var a=0;a<r.length;a++){n[a]=r[a]}return n};var st=function(t){if(t.length<14){throw new Error("The buffer is too small")}var e=[];e.push(G[t[0]]??H);for(var i=1;i<t.length;i++){if(t[i]!==0){e.push($[t[i]]??H)}}return{type:e.join(""),meterType:0}};var ot=function(t){if(t.length<1){throw new Error("Wrong format")}var e=[];e.push(G.indexOf(t[0]));for(var i=1;i<t.length;i++){e.push($.indexOf(t[i]))}var r=et(e);var n=new Array(8).fill(0);for(var a=0;a<r.length&&a<8;a++){n[a]=r[a]}return n};var ht=function(t){if(t.length!==9){throw new Error("The buffer is too small")}var e;var i=[0,5,6,7,9,127,239];var r=i.indexOf(t[0])!==-1?2:0;var n=tt(t.slice(0,8));var a=n[r];var s=G[a];if(s==="1"||s==="3"){e=it(n.slice(r))}else{e=s==="M"?st(n):nt(n)}e.meterType=t[8];return e};var Et=function(t,e){var i=t.type,r=t.revision,n=t.meterType;if(!i.startsWith("MTX ")){throw new Error("Wrong format")}var a;var s=i.substring(4);var o=i[4];if(o==="1"||o==="3"){a=rt(s,e,r)}else{a=o==="M"?ot(s):at(s)}a[8]=n;return a};var _t=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=Object.assign({},_,e),r=i.separator,n=i.prefix;return t.map((function(t){return"".concat(n).concat(t.toString(16).padStart(2,"0"))})).join(r)};var ft=80;var ut=38;var Tt=121;var vt=157;var At={type:ft,destination:65535,source:65534};var Rt=11;var Ut=7;var dt=2+Ut;var pt=4;var ct={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_COEFFICIENT_PHASE_A:524288,POWER_COEFFICIENT_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var gt={...ct,AUTO_SCREEN_SCROLLING:2147483648};var lt={...ct,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var Ot={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_0:8,RELAY_ON_TARIFF_1:16,RELAY_ON_TARIFF_2:32,RELAY_ON_TARIFF_3:64,RELAY_ON_V_GOOD:128};var yt={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_0:4,RELAY_OFF_TARIFF_1:8,RELAY_OFF_TARIFF_2:16,RELAY_OFF_TARIFF_3:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var Pt={RELAY_OFF_LIM_TARIFF_0:2,RELAY_OFF_LIM_TARIFF_1:4,RELAY_OFF_LIM_TARIFF_2:8,RELAY_OFF_LIM_TARIFF_3:16,RELAY_OFF_PF_MIN:32};var It={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var mt={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var Nt={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var Mt={CASE_OPEN:2**0,MAGNETIC_ON:2**1,PARAMETERS_UPDATE_REMOTE:2**2,PARAMETERS_UPDATE_LOCAL:2**3,RESTART:2**4,ERROR_ACCESS:2**5,TIME_SET:2**6,TIME_CORRECT:2**7,DEVICE_FAILURE:2**8,CASE_TERMINAL_OPEN:2**9,CASE_MODULE_OPEN:2**10,TARIFF_TABLE_SET:2**11,TARIFF_TABLE_GET:2**12,PROTECTION_RESET_EM:2**13,PROTECTION_RESET_MAGNETIC:2**14};var St={RELAY_STATE:2**0,RELAY_UBAD:2**1,RELAY_UNEQ_CURRENT:2**4,RELAY_OFF_CENTER:2**5,RELAY_IMAX:2**6,RELAY_PMAX:2**7};var Dt={RELAY_COSFI:2**0,RELAY_SALDO_OFF_FLAG:2**1,RELAY_UNEQUIL_CURRENT_OFF:2**2,RELAY_BIPOLAR_POWER_OFF:2**3,RELAY_SALDO_OFF_ON_MAX_POWER:2**4,RELAY_HARD_ST1:2**5};var Ct={MAXVA:2**0,MINVA:2**1,MAXT:2**2,MINT:2**3,MAXF:2**4,MINF:2**5,MAXIA:2**6,MAXP:2**7};var Lt={MAX_POWER_SALDO:2**0,BATTERY_VBAT_BAD:2**1,CLOCK_UNSET:2**3,MIN_COS_FI:2**5};var Ft={UNEQUIL_CURRENT:2**0,BIPOLAR_POWER:2**1,POWER_A_NEGATIVE:2**6,POWER_B_NEGATIVE:2**7};var Vt={RELAY_OFF_LIMIT_P_MINUS_T1:4,RELAY_OFF_LIMIT_P_MINUS_T2:8,RELAY_OFF_LIMIT_P_MINUS_T3:16,RELAY_OFF_LIMIT_P_MINUS_T4:32};function Yt(t,e,i){var r=i>>pt;var n=new Array(pt).fill(0);n.forEach((function(e,i){var a=!!x(r,1,i+1);if(a){n[i]=t.getUint32()}else{n[i]=null}}));return n}function xt(t,e,i){var r=1+pt;var n=e;i.forEach((function(t,e){n=w(n,1,e+r,Number(!!t))}));t.setUint8(n)}function wt(t){if(t===65535){return{tariff:undefined,energy:undefined}}return{tariff:t>>14&3,energy:t&16383}}function Wt(t,e){var i=e.tariff,r=e.energy;if(i!==undefined&&r!==undefined){t.setUint16(i<<14|r&16383)}else{t.setUint16(65535)}}function Ht(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;F.call(this,t,e)}Ht.prototype=Object.create(F.prototype);Ht.prototype.constructor=Ht;Ht.getDayProfileFromByte=function(t){return{tariff:x(t,2,1),isFirstHalfHour:!x(t,1,3),hour:x(t,5,4)}};Ht.getByteFromDayProfile=function(t){var e=0;e=w(e,2,1,t.tariff);e=w(e,1,3,+!t.isFirstHalfHour);e=w(e,5,4,t.hour);return e};Ht.getDefaultSeasonProfile=function(){return{month:1,date:1,dayIndexes:[0,0,0,0,0,0,0]}};Ht.getDefaultOperatorParameters=function(){return{vpThreshold:265e3,vThreshold:156e3,ipThreshold:12e4,pmaxThreshold0:31800,pmaxThreshold1:31800,pmaxThreshold2:31800,pmaxThreshold3:31800,speedOptoPort:0,tint:30,calcPeriodDate:1,timeoutDisplay:127,timeoutScreen:7,displaySet:Y(gt,2147496324),relaySet4:Y(It,0),relaySet3:Y(Pt,0),relaySet2:Y(yt,3),relaySet1:Y(Ot,3),displayType:0,ten:0,timeoutRefresh:240,deltaCorMin:15,timeoutMagnetOff:5,timeoutMagnetOn:5,define1:Y(Nt,0),timeoutRelayOn:1,timeoutRelayKey:0,timeoutRelayAuto:5,timeoutBadVAVB:5,freqMax:55,freqMin:45,phMin:0,year:0,month:0,date:0,energyDecimalPoint:2,typeMeter:0,timeoutIMax:5,timeoutPMax:5,timeoutCos:5,pMaxDef:1,displaySetExt:Y(lt,137904127),timeoutUneqCurrent:5,timeoutBipolarPower:5,relaySet5:Y(mt,0),timeCorrectPeriod:24,timeCorrectPassHalfhour:false}};Ht.prototype.getFrameHeader=function(){return{type:this.getUint8(),destination:this.getUint16(),source:this.getUint16()}};Ht.prototype.setFrameHeader=function(t){var e=t.type,i=e===void 0?At.type:e,r=t.destination,n=r===void 0?At.destination:r,a=t.source,s=a===void 0?At.source:a;this.setUint8(i);this.setUint16(n);this.setUint16(s)};Ht.prototype.getDeviceId=function(){var t=_t(this.getBytes(3),{separator:""});var e=this.getUint8();var i=this.getUint8();var r=_t(this.getBytes(3),{separator:""});return{manufacturer:t,type:e,year:i,serial:r}};Ht.prototype.setDeviceId=function(t){var e=t.manufacturer,i=t.type,r=t.year,n=t.serial;this.setBytes(W(e));this.setUint8(i);this.setUint8(r);this.setBytes(W(n))};Ht.prototype.getDateTime=function(){return{isSummerTime:!!this.getUint8(),seconds:this.getUint8(),minutes:this.getUint8(),hours:this.getUint8(),day:this.getUint8(),date:this.getUint8(),month:this.getUint8(),year:this.getUint8()}};Ht.prototype.setDateTime=function(t){this.setUint8(t.isSummerTime?1:0);this.setUint8(t.seconds);this.setUint8(t.minutes);this.setUint8(t.hours);this.setUint8(t.day||0);this.setUint8(t.date);this.setUint8(t.month);this.setUint8(t.year)};Ht.prototype.getTariffPlan=function(){return{id:this.getUint32(),tariffSet:this.getUint8(),activateYear:this.getUint8(),activateMonth:this.getUint8(),activateDay:this.getUint8(),specialProfilesArraySize:this.getUint8(),seasonProfilesArraySize:this.getUint8(),dayProfilesArraySize:this.getUint8()}};Ht.prototype.setTariffPlan=function(t){this.setUint32(t.id);this.setUint8(t.tariffSet);this.setUint8(t.activateYear);this.setUint8(t.activateMonth);this.setUint8(t.activateDay);this.setUint8(t.specialProfilesArraySize);this.setUint8(t.seasonProfilesArraySize);this.setUint8(t.dayProfilesArraySize)};Ht.prototype.getTimeCorrectionParameters=function(){return{monthTransitionSummer:this.getUint8(),dateTransitionSummer:this.getUint8(),hoursTransitionSummer:this.getUint8(),hoursCorrectSummer:this.getUint8(),monthTransitionWinter:this.getUint8(),dateTransitionWinter:this.getUint8(),hoursTransitionWinter:this.getUint8(),hoursCorrectWinter:this.getUint8(),isCorrectionNeeded:this.getUint8()===1}};Ht.prototype.setTimeCorrectionParameters=function(t){this.setUint8(t.monthTransitionSummer);this.setUint8(t.dateTransitionSummer);this.setUint8(t.hoursTransitionSummer);this.setUint8(t.hoursCorrectSummer);this.setUint8(t.monthTransitionWinter);this.setUint8(t.dateTransitionWinter);this.setUint8(t.hoursTransitionWinter);this.setUint8(t.hoursCorrectWinter);this.setUint8(+t.isCorrectionNeeded)};Ht.prototype.getDayProfile=function(){return Ht.getDayProfileFromByte(this.getUint8())};Ht.prototype.setDayProfile=function(t){this.setUint8(Ht.getByteFromDayProfile(t))};Ht.prototype.getSeasonProfile=function(){var t=this;return{month:this.getUint8(),date:this.getUint8(),dayIndexes:new Array(Ut).fill(0).map((function(){return t.getUint8()}))}};Ht.prototype.setSeasonProfile=function(t){var e=this;this.setUint8(t.month);this.setUint8(t.date);t.dayIndexes.forEach((function(t){return e.setUint8(t)}))};Ht.prototype.getSpecialDay=function(){return{month:this.getUint8(),date:this.getUint8(),dayIndex:this.getUint8(),isPeriodic:this.getUint8()===0}};Ht.prototype.setSpecialDay=function(t){this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.dayIndex);this.setUint8(+!t.isPeriodic)};Ht.prototype.getDeviceType=function(){return ht(this.getBytes(9))};Ht.prototype.setDeviceType=function(t){this.setBytes(Et(t))};Ht.prototype.getOperatorParameters=function(){var t={vpThreshold:this.getUint32(),vThreshold:this.getUint32(),ipThreshold:this.getUint32(),pmaxThreshold0:this.getUint32(),pmaxThreshold1:this.getUint32(),pmaxThreshold2:this.getUint32(),pmaxThreshold3:this.getUint32(),speedOptoPort:this.getUint8(),tint:this.getUint8(),calcPeriodDate:this.getUint8(),timeoutDisplay:this.getUint8(),timeoutScreen:this.getUint8(),displaySet:Y(gt,this.getUint32()),relaySet4:Y(It,this.getUint8()),relaySet3:Y(Pt,this.getUint8()),relaySet2:Y(yt,this.getUint8()),relaySet1:Y(Ot,this.getUint8()),displayType:this.getUint8(),ten:this.getUint8(),timeoutRefresh:this.getUint16(),deltaCorMin:this.getUint8(),timeoutMagnetOff:this.getUint8(),timeoutMagnetOn:this.getUint8(),define1:Y(Nt,this.getUint8()),timeoutRelayOn:this.getUint8(),timeoutRelayKey:this.getUint8(),timeoutRelayAuto:this.getUint8(),timeoutBadVAVB:this.getUint8(),freqMax:this.getUint8(),freqMin:this.getUint8(),phMin:this.getUint16(),year:this.getUint8(),month:this.getUint8(),date:this.getUint8(),energyDecimalPoint:this.getUint8(),typeMeter:this.getUint8(),timeoutIMax:this.getUint8(),timeoutPMax:this.getUint8(),timeoutCos:this.getUint8(),pMaxDef:this.getUint8(),displaySetExt:Y(lt,this.getUint32()),timeoutUneqCurrent:this.getUint8(),timeoutBipolarPower:this.getUint8(),relaySet5:Y(mt,this.getUint8()),timeCorrectPeriod:0,timeCorrectPassHalfhour:false};var e=this.getUint8();t.timeCorrectPeriod=e&127;t.timeCorrectPassHalfhour=!!(e&128);return t};Ht.prototype.setOperatorParameters=function(t){var e=t.timeCorrectPeriod|(t.timeCorrectPassHalfhour?128:0);this.setUint32(t.vpThreshold);this.setUint32(t.vThreshold);this.setUint32(t.ipThreshold);this.setUint32(t.pmaxThreshold0);this.setUint32(t.pmaxThreshold1);this.setUint32(t.pmaxThreshold2);this.setUint32(t.pmaxThreshold3);this.setUint8(t.speedOptoPort);this.setUint8(t.tint);this.setUint8(t.calcPeriodDate);this.setUint8(t.timeoutDisplay);this.setUint8(t.timeoutScreen);this.setUint32(V(gt,t.displaySet));this.setUint8(V(It,t.relaySet4));this.setUint8(V(Pt,t.relaySet3));this.setUint8(V(yt,t.relaySet2));this.setUint8(V(Ot,t.relaySet1));this.setUint8(t.displayType);this.setUint8(t.ten);this.setUint16(t.timeoutRefresh);this.setUint8(t.deltaCorMin);this.setUint8(t.timeoutMagnetOff);this.setUint8(t.timeoutMagnetOn);this.setUint8(V(Nt,t.define1));this.setUint8(t.timeoutRelayOn);this.setUint8(t.timeoutRelayKey);this.setUint8(t.timeoutRelayAuto);this.setUint8(t.timeoutBadVAVB);this.setUint8(t.freqMax);this.setUint8(t.freqMin);this.setUint16(t.phMin);this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.energyDecimalPoint);this.setUint8(t.typeMeter);this.setUint8(t.timeoutIMax);this.setUint8(t.timeoutPMax);this.setUint8(t.timeoutCos);this.setUint8(t.pMaxDef);this.setUint32(V(lt,t.displaySetExt));this.setUint8(t.timeoutUneqCurrent);this.setUint8(t.timeoutBipolarPower);this.setUint8(V(mt,t.relaySet5));this.setUint8(e)};Ht.prototype.getPackedEnergyWithType=function(){var t=this.getUint8();var e=x(t,pt,1);var i=Yt(this,e,t);return{energyType:e,energies:i}};Ht.prototype.setPackedEnergyWithType=function(t){var e=this;var i=t.energyType,r=t.energies;if(i){xt(this,i,r)}r.forEach((function(t){if(t!==null){e.setUint32(t)}}))};Ht.prototype.getEnergies=function(){var t=this;return new Array(pt).fill(0).map((function(){return t.getInt32()}))};Ht.prototype.setEnergies=function(t){var e=this;t.forEach((function(t){return e.setUint32(t)}))};Ht.prototype.getDate=function(){return{year:this.getUint8(),month:this.getUint8(),date:this.getUint8()}};Ht.prototype.setDate=function(t){this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date)};Ht.prototype.getSaldoParameters=function(){var t=this;return{coefficients:new Array(4).fill(0).map((function(){return t.getUint32()})),decimalPointTariff:this.getUint8(),indicationThreshold:this.getInt32(),relayThreshold:this.getInt32(),mode:this.getUint8(),saldoOffTimeBegin:this.getUint8(),saldoOffTimeEnd:this.getUint8(),decimalPointIndication:this.getUint8(),powerThreshold:this.getUint32(),creditThreshold:this.getInt32()}};Ht.prototype.setSaldoParameters=function(t){var e=this;t.coefficients.forEach((function(t){return e.setUint32(t)}));this.setUint8(t.decimalPointTariff);this.setInt32(t.indicationThreshold);this.setInt32(t.relayThreshold);this.setUint8(t.mode);this.setUint8(t.saldoOffTimeBegin);this.setUint8(t.saldoOffTimeEnd);this.setUint8(t.decimalPointIndication);this.setUint32(t.powerThreshold);this.setInt32(t.creditThreshold)};Ht.prototype.getEnergyPeriods=function(t){var e=this;var i=new Array(t).fill(0).map((function(){return e.getUint16()}));return i.map((function(t){return wt(t)}))};Ht.prototype.setEnergyPeriods=function(t){var e=this;t.forEach((function(t){return Wt(e,t)}))};Ht.prototype.getEventStatus=function(){var t=this.getUint16();return Y(Mt,t)};Ht.prototype.setEventStatus=function(t){this.setUint16(V(Mt,t))};Ht.prototype.getExtendedCurrentValues2=function(){var t=this.getUint16();var e=Y(St,this.getUint8());var i=Y(Dt,this.getUint8());var r=Y(Ct,this.getUint8());var n=Y(Lt,this.getUint8());var a=Y(Ft,this.getUint8());return{uBattery:t,relayStatus:e,relayStatus2:i,status1:r,status2:n,status3:a}};Ht.prototype.setExtendedCurrentValues2=function(t){var e=t.uBattery,i=t.relayStatus,r=t.relayStatus2,n=t.status1,a=t.status2,s=t.status3;this.setUint16(e);this.setUint8(V(St,i));this.setUint8(V(Dt,r));this.setUint8(V(Ct,n));this.setUint8(V(Lt,a));this.setUint8(V(Ft,s))};Ht.prototype.getEvent=function(){var t={hours:this.getUint8(),minutes:this.getUint8(),seconds:this.getUint8(),event:this.getUint8()};var e=t.event;var i=this.bytesLeft;switch(e){case vt:if(i<4){return t}t.power=[this.getUint8(),this.getUint8(),this.getUint8(),this.getUint8()];break;case ut:case Tt:if(i<8){return t}t.newDate=this.getDateTime();break}return t};Ht.prototype.setEvent=function(t){this.setUint8(t.hours);this.setUint8(t.minutes);this.setUint8(t.seconds);this.setUint8(t.event);switch(t.event){case vt:for(var e of t.power){this.setUint8(e)}break;case ut:case Tt:this.setDateTime(t.newDate);break}};Ht.prototype.getDemand=function(){var t=this.getUint8();var e=this.getUint8();return{date:{year:t>>1,month:t<<3&15|e>>5,date:e&31},energyType:this.getUint8(),firstIndex:this.getUint16(),count:this.getUint8(),period:this.getUint8()}};Ht.prototype.setDemand=function(t){var e=t.date.year<<1|t.date.month>>3&1;var i=t.date.month<<5&224|t.date.date&31;this.setUint8(e);this.setUint8(i);this.setUint8(t.energyType);this.setUint16(t.firstIndex);this.setUint8(t.count);this.setUint8(t.period)};Ht.prototype.getDayMaxDemandResponse=function(){var t=this;var e=this.getDate();var i=new Array(pt).fill(0).map((function(){return{hours:t.getUint8(),minutes:t.getUint8(),power:t.getUint32()}}));return{date:e,power:i}};Ht.prototype.setDayMaxDemandResponse=function(t){var e=this;this.setDate(t.date);t.power.forEach((function(t){e.setUint8(t.hours);e.setUint8(t.minutes);e.setUint32(t.power)}))};Ht.prototype.getOperatorParametersExtended3=function(){return{pmaxMinusThreshold0:this.getUint32(),pmaxMinusThreshold1:this.getUint32(),pmaxMinusThreshold2:this.getUint32(),pmaxMinusThreshold3:this.getUint32(),relaySet:Y(Vt,this.getUint8())}};Ht.prototype.setOperatorParametersExtended3=function(t){var e=t.pmaxMinusThreshold0,i=t.pmaxMinusThreshold1,r=t.pmaxMinusThreshold2,n=t.pmaxMinusThreshold3,a=t.relaySet;this.setUint32(e);this.setUint32(i);this.setUint32(r);this.setUint32(n);this.setUint8(V(Vt,a))};Ht.prototype.getMonthMaxPowerByTariffs=function(){var t=this;return new Array(pt).fill(0).map((function(){return{date:t.getUint8(),hours:t.getUint8(),minutes:t.getUint8(),power:t.getUint32()}}))};Ht.prototype.setMonthMaxPowerByTariffs=function(t){var e=this;t.forEach((function(t){e.setUint8(t.date);e.setUint8(t.hours);e.setUint8(t.minutes);e.setUint32(t.power)}))};var Gt=function(t){return btoa(t.map((function(t){return String.fromCharCode(t)})).join(""))};var Xt=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[t,e.length].concat(h(e))};var Bt=0;var bt=3;var Qt=19;var jt=1+Rt;var Kt=function(t){var e=new Ht(jt);e.setUint8(t.tariffTable);e.setTariffPlan(t.tariffPlan);return Xt(Qt,e.data)};var qt=112;var kt=function(){return Xt(qt)};var zt=62;var Zt=function(){return Xt(zt)};var $t=57;var Jt=function(){return Xt($t)};var te=13;var ee=function(){return Xt(te)};var ie=7;var re=function(){return Xt(ie)};var ne=49;var ae=3;var se=function(t){var e=new Ht(ae);e.setDate(t.date);return Xt(ne,e.data)};var oe=88;var he=3;var Ee=function(t){var e=new Ht(he);e.setDate(t.date);return Xt(oe,e.data)};var _e=59;var fe=3;var ue=function(t){var e=new Ht(fe);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return Xt(_e,e.data)};var Te=5;var ve=function(){return Xt(Te)};var Ae=4;var Re=function(){return Xt(Ae)};var Ue=51;var de=4;var pe=function(t){var e=new Ht(de);e.setDate(t.date);e.setUint8(t.offset);return Xt(Ue,e.data)};var ce=52;var ge=function(){return Xt(ce)};var le=1;var Oe=function(){return Xt(le)};var ye=58;var Pe=function(){return Xt(ye)};var Ie=21;var me=3;var Ne=function(t){var e=new Ht(me);e.setDate(t.date);return Xt(Ie,e.data)};var Me=83;var Se=3;var De=function(t){var e=new Ht(Se);e.setDate(t.date);return Xt(Me,e.data)};var Ce=4;var Le=4294967295;var Fe={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var Ve=function(t){var e={};Object.keys(t).forEach((function(i){e[i]=!!t[i]}));return V(Fe,e)};var Ye=function(t){return t<Ce?1<<t:0};var xe=function(t){return t<Ce?1<<t<<4:0};var we=function(t,e){var i=0;if(t<Ce){if(e["A+"]||e["A+R+"]||e["A+R-"]){i|=Ye(t)}if(e["A-"]||e["A-R+"]||e["A-R-"]){i|=xe(t)}}return i};function We(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;F.call(this,t,e)}We.prototype=Object.create(F.prototype);We.prototype.constructor=We;We.prototype.getDate=function(){var t=this.getUint8();var e=this.getUint8();return{year:t>>1,month:t<<3&15|e>>5,date:e&31}};We.prototype.setDate=function(t){var e=t.year,i=t.month,r=t.date;var n=e<<1|i>>3&1;var a=i<<5&224|r&31;this.setUint8(n);this.setUint8(a)};We.prototype.getEnergiesFlags=function(){var t=this.getUint8();return Y(Fe,t)};We.prototype.setEnergiesFlags=function(t){this.setUint8(Ve(t))};We.prototype.getHalfhoursEnergy=function(t){var e=[];for(var i=0;i<t;i++){var r=this.getUint16();e.push(r===Le?undefined:r)}return e};We.prototype.setHalfhoursEnergy=function(t){if(t){for(var e=0;e<t.length;e++){var i=t[e];this.setUint16(i===undefined?Le:i)}}};We.prototype.getHalfhoursEnergies=function(t,e){var i={};if(t["A+"]){i["A+"]=this.getHalfhoursEnergy(e)}if(t["A+R+"]){i["A+R+"]=this.getHalfhoursEnergy(e)}if(t["A+R-"]){i["A+R-"]=this.getHalfhoursEnergy(e)}if(t["A-"]){i["A-"]=this.getHalfhoursEnergy(e)}if(t["A-R+"]){i["A-R+"]=this.getHalfhoursEnergy(e)}if(t["A-R-"]){i["A-R-"]=this.getHalfhoursEnergy(e)}return i};We.prototype.setHalfhoursEnergies=function(t){this.setHalfhoursEnergy(t["A+"]);this.setHalfhoursEnergy(t["A+R+"]);this.setHalfhoursEnergy(t["A+R-"]);this.setHalfhoursEnergy(t["A-"]);this.setHalfhoursEnergy(t["A-R+"]);this.setHalfhoursEnergy(t["A-R-"])};We.prototype.getAPlusTariffEnergies=function(t){var e={};if(t&Fe["A+"]){e["A+"]=this.getUint16()}if(t&Fe["A+R+"]){e["A+R+"]=this.getUint16()}if(t&Fe["A+R-"]){e["A+R-"]=this.getUint16()}return e};We.prototype.setAPlusTariffEnergies=function(t){if(t){if(t["A+"]){this.setUint16(t["A+"])}if(t["A+R+"]){this.setUint16(t["A+R+"])}if(t["A+R-"]){this.setUint16(t["A+R-"])}}};We.prototype.getAMinusTariffEnergies=function(t){var e={};if(t&Fe["A-"]){e["A-"]=this.getUint16()}if(t&Fe["A-R+"]){e["A-R+"]=this.getUint16()}if(t&Fe["A-R-"]){e["A-R-"]=this.getUint16()}return e};We.prototype.setAMinusTariffEnergies=function(t){if(t){if(t["A-"]){this.setUint16(t["A-"])}if(t["A-R+"]){this.setUint16(t["A-R+"])}if(t["A-R-"]){this.setUint16(t["A-R-"])}}};We.prototype.getTariffsEnergies=function(){var t=this.getUint8();var e=this.getUint8();var i=[];for(var r=0;r<Ce;r++){if(e&Ye(r)){i[r]=this.getAPlusTariffEnergies(t)}}for(var n=0;n<Ce;n++){if(e&xe(n)){i[n]={...i[n],...this.getAMinusTariffEnergies(t)}}}return i};We.prototype.setTariffsEnergies=function(t){var e=this;var i=0;var r=0;t.forEach((function(t,e){if(t){i|=Ve(t);r|=we(e,t)}}));this.setUint8(i);this.setUint8(r);t.forEach((function(t){return e.setAPlusTariffEnergies(t)}));t.forEach((function(t){return e.setAMinusTariffEnergies(t)}))};We.prototype.getPowerMax=function(){return{hours:this.getUint8(),minutes:this.getUint8(),power:this.getUint32()}};We.prototype.setPowerMax=function(t){if(t){var e=t.hours,i=t.minutes,r=t.power;this.setUint8(e);this.setUint8(i);this.setUint32(r)}};We.prototype.getAPlusTariffPowerMax=function(t){var e={};if(t&Fe["A+"]){e["A+"]=this.getPowerMax()}if(t&Fe["A+R+"]){e["A+R+"]=this.getPowerMax()}if(t&Fe["A+R-"]){e["A+R-"]=this.getPowerMax()}return e};We.prototype.setAPlusTariffPowerMax=function(t){if(t){this.setPowerMax(t["A+"]);this.setPowerMax(t["A+R+"]);this.setPowerMax(t["A+R+"])}};We.prototype.getAMinusTariffPowerMax=function(t){var e={};if(t&Fe["A-"]){e["A-"]=this.getPowerMax()}if(t&Fe["A-R+"]){e["A-R+"]=this.getPowerMax()}if(t&Fe["A-R-"]){e["A-R-"]=this.getPowerMax()}return e};We.prototype.setAMinusTariffPowerMax=function(t){if(t){this.setPowerMax(t["A-"]);this.setPowerMax(t["A-R+"]);this.setPowerMax(t["A-R-"])}};We.prototype.getTariffsPowerMax=function(){var t=this.getUint8();var e=this.getUint8();var i=[];for(var r=0;r<Ce;r++){if(e&Ye(r)){i[r]=this.getAPlusTariffPowerMax(t)}}for(var n=0;n<Ce;n++){if(e&xe(n)){i[n]={...i[n],...this.getAMinusTariffPowerMax(t)}}}return i};We.prototype.setTariffsPowerMax=function(t){var e=this;var i=0;var r=0;t.forEach((function(t,e){if(t){i|=Ve(t);r|=we(e,t)}}));this.setUint8(i);this.setUint8(r);t.forEach((function(t){return e.setAPlusTariffPowerMax(t)}));t.forEach((function(t){return e.setAMinusTariffPowerMax(t)}))};var He=111;var Ge=5;var Xe=function(t){var e=new We(Ge);e.setDate(t.date);e.setEnergiesFlags(t.energies);e.setUint8(t.firstHalfhour);e.setUint8(t.halfhoursNumber);return Xt(He,e.data)};var Be=109;var be=function(){return Xt(Be)};var Qe=122;var je=function(){return Xt(Qe)};var Ke=23;var qe=2;var ke=function(t){var e=new Ht(qe);e.setUint8(t.year);e.setUint8(t.month);return Xt(Ke,e.data)};var ze=82;var Ze=2;var $e=function(t){var e=new Ht(Ze);e.setUint8(t.year);e.setUint8(t.month);return Xt(ze,e.data)};var Je=50;var ti=function(t){var e=t.year,i=t.month;return Xt(Je,[e,i])};var ei=89;var ii=function(t){var e=t.year,i=t.month;return Xt(ei,[e,i])};var ri=113;var ni=function(){return Xt(ri)};var ai=30;var si=function(){return Xt(ai)};var oi=44;var hi=function(t){return Xt(oi,[t.tariffTable])};var Ei=41;var _i=function(){return Xt(Ei)};var fi=46;var ui=function(){return Xt(fi)};var Ti=60;var vi=3;var Ai=function(t){var e=new Ht(vi);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return Xt(Ti,e.data)};var Ri=61;var Ui=3;var di=function(t){var e=new Ht(Ui);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return Xt(Ri,e.data)};var pi=40;var ci=function(){return Xt(pi)};var gi=20;var li=5;var Oi=function(t){var e=new Ht(li);e.setUint8(t.tariffTable);e.setUint32(t.id);return Xt(gi,e.data)};var yi=53;var Pi=function(){return Xt(yi)};var Ii=54;var mi=function(){return Xt(Ii)};var Ni=70;var Mi=function(t){return Xt(Ni,[t.tariffTable])};var Si=16;var Di=9;var Ci=1+Si;var Li=function(t){var e=new Ht(Ci);e.setUint8(t.accessLevel);e.setBytes(t.key);return Xt(Di,e.data)};var Fi=92;var Vi=2;var Yi=function(t){var e=new Ht(Vi);e.setInt16(t.seconds);return Xt(Fi,e.data)};var xi=28;var wi=9;var Wi=function(t){var e=new Ht(wi);e.setTimeCorrectionParameters(t);return Xt(xi,e.data)};var Hi=8;var Gi=8;var Xi=function(t){var e=new Ht(Gi);e.setDateTime(t);return Xt(Hi,e.data)};var Bi=8;var bi=255;var Qi=16;var ji=function(t){var e=t.periods.length<Bi;var i=2+t.periods.length+ +e;var r=new Ht(i);r.setUint8(t.tariffTable);r.setUint8(t.index);t.periods.forEach((function(t){r.setDayProfile(t)}));if(e){r.setUint8(bi)}return Xt(Qi,r.data)};var Ki=114;var qi=17;var ki=function(t){var e=new Ht(qi);e.setOperatorParametersExtended3(t);return Xt(Ki,e.data)};var zi=42;var Zi=12;var $i=function(t){var e=new Ht(Zi);e.setUint8(t.date.month);e.setUint8(t.date.date);e.setUint8(t.date.hours);e.setUint8(t.date.minutes);e.setInt32(t.saldoNew);e.setInt32(t.saldoOld);return Xt(zi,e.data)};var Ji=47;var tr=37;var er=function(t){var e=new Ht(tr);e.setSaldoParameters(t);return Xt(Ji,e.data)};var ir=17;var rr=dt;var nr=function(t){var e=new Ht(rr);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setSeasonProfile(t);return Xt(ir,e.data)};var ar=18;var sr=6;var or=function(t){var e=new Ht(sr);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setSpecialDay(t);return Xt(ar,e.data)};var hr=100;var Er=2;var _r=function(t){var e=new Ht(Er);var i=0;if(t.readScreensInfo){i|=128}if(t.resetElectroMagneticIndication){i|=1}if(t.resetMagneticIndication){i|=2}e.setUint8(t.type);e.setUint8(i);return Xt(hr,e.data)};var fr=25;var ur=function(){return Xt(fr)};var Tr=24;var vr=function(){return Xt(Tr)};var Ar={encrypt:function(){},decrypt:function(){}};var Rr=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var i=e;t.forEach((function(t){i^=t}));return i};var Ur=16;var dr=[0];var pr=function(t){return function(e,i){var r;var n=i.messageId,a=i.accessLevel,s=a===void 0?bt:a,o=i.aesKey;var E=e.map((function(e){if("id"in e){return t[e.id](e.parameters||{})}if("command"in e){return e.command.bytes}throw new Error("wrong command format")}));var _=s|16;var f=[n,_];var u=(r=[]).concat.apply(r,[_].concat(h(E),[dr]));if(s!==Bt){var T=(u.length+1)%Ur;if(T){u=u.concat(new Array(Ur-T).fill(0))}}u=u.concat(Rr(u));if(o&&s!==Bt){u=h(Ar.encrypt(o,u))}return f.concat(u)}};var cr=0;var gr=128;var lr=129;var Or=130;var yr=131;var Pr=132;var Ir=133;var mr=134;var Nr=135;var Mr=136;var Sr=137;var Dr=144;var Cr=145;var Lr=146;var Fr=147;var Vr=149;var Yr=151;var xr=152;var wr=153;var Wr=154;var Hr=155;var Gr=156;var Xr=159;var Br=160;var br=240;var Qr=Object.freeze({__proto__:null,ACCESS_DENIED:Fr,BAD_ARRAY_INDEX:mr,BAD_BLOCK_NUMBER:Gr,BAD_DATA_LENGTH:Ir,BAD_MESSAGE:Pr,BAD_RATE_PLAN_ID:Mr,BAD_RATE_PLAN_SIZE:Sr,BAD_RESPONSE_LENGTH:Dr,BAD_SALDO_WRITE:Vr,BLOCKED_METER:Yr,CALIBRATION_DISABLED:Lr,DECRYPTION_FAILURE:Or,INTERNAL:br,INVALID_CORRECTION_INTERVAL:Wr,NOT_ALIGNED_DATA:lr,NOT_PREPARED_RATE_PLAN:Nr,NO_DATA_FOR_DATE:Cr,OK:cr,OUT_OFF_RANGE:Xr,SET_METER_TYPE_FAILURE:Br,TIME_CORRECTION_FAILURE:wr,TIME_CORRECTION_OUT_HALF_HOUR_DISABLED:Hr,UNENCRYPTED_COMMAND_DISABLED:xr,UNKNOWN_COMMAND:gr,UNKNOWN_PROTOCOL:yr});var jr=function(t){var e={};for(var i in t){var r=t[i];e[r]=i}return e};jr(Qr);var Kr=1;var qr=2;var kr=3;var zr=4;var Zr=5;var $r=6;var Jr=7;var tn=8;var en=9;var rn=10;var nn=11;var an=12;var sn=13;var on=14;var hn=15;var En=16;var _n=17;var fn=18;var un=19;var Tn=20;var vn=21;var An=22;var Rn=23;var Un=24;var dn=25;var pn=26;var cn=28;var gn=30;var ln=31;var On=Object.freeze({__proto__:null,ACTIVE_ENERGY_T1:zr,ACTIVE_ENERGY_T2:Zr,ACTIVE_ENERGY_T3:$r,ACTIVE_ENERGY_T4:Jr,ACTIVE_POWER_IN_NEUTRAL:en,ACTIVE_POWER_PER_PHASE:tn,BATTERY_VOLTAGE:An,CURRENT_BALANCE:gn,CURRENT_IN_NEUTRAL:nn,CURRENT_IN_PHASE:rn,DATE_MONTH_YEAR:on,EXPORTED_ACTIVE_ENERGY_T1:En,EXPORTED_ACTIVE_ENERGY_T2:_n,EXPORTED_ACTIVE_ENERGY_T3:fn,EXPORTED_ACTIVE_ENERGY_T4:un,HOUR_MINUTE_SECOND:sn,MAGNET_INDUCTION:cn,OPTOPORT_SPEED:ln,POWER_COEFFICIENT_PHASE_A:Tn,POWER_COEFFICIENT_PHASE_B:vn,POWER_THRESHOLD_T1:Rn,POWER_THRESHOLD_T2:Un,POWER_THRESHOLD_T3:dn,POWER_THRESHOLD_T4:pn,SET_ALL_SEGMENT_DISPLAY:Kr,SOFTWARE_VERSION:qr,TOTAL_ACTIVE_ENERGY:kr,TOTAL_EXPORTED_ACTIVE_ENERGY:hn,VOLTAGE:an});jr(On);var yn=2400;var Pn=9600;var In={plc:{0:Pn,2:yn,4:Pn},optoport:{0:yn,2:yn,4:Pn}};var mn={plc:jr(In.plc),optoport:jr(In.optoport)};var Nn=86;var Mn=function(t){return Xt(Nn,[t.event,t.index])};var Sn=95;var Dn=9;var Cn=28;var Ln=28;var Fn=4;var Vn={SET_ALL_SEGMENT_DISPLAY:1<<0,SOFTWARE_VERSION:1<<1,TOTAL_ACTIVE_ENERGY:1<<2,ACTIVE_ENERGY_T1:1<<3,ACTIVE_ENERGY_T2:1<<4,ACTIVE_ENERGY_T3:1<<5,ACTIVE_ENERGY_T4:1<<6,TOTAL_REACTIVE_ENERGY:1<<7,REACTIVE_ENERGY_T1:1<<8,REACTIVE_ENERGY_T2:1<<9,REACTIVE_ENERGY_T3:1<<10,REACTIVE_ENERGY_T4:1<<11,TOTAL_NEGATIVE_REACTIVE_ENERGY:1<<12,NEGATIVE_REACTIVE_ENERGY_T1:1<<13,NEGATIVE_REACTIVE_ENERGY_T2:1<<14,NEGATIVE_REACTIVE_ENERGY_T3:1<<15,NEGATIVE_REACTIVE_ENERGY_T4:1<<16,TOTAL_EXPORTED_ACTIVE_ENERGY:1<<17,EXPORTED_ACTIVE_ENERGY_T1:1<<18,EXPORTED_ACTIVE_ENERGY_T2:1<<19,EXPORTED_ACTIVE_ENERGY_T3:1<<20,EXPORTED_ACTIVE_ENERGY_T4:1<<21,TOTAL_EXPORTED_REACTIVE_ENERGY:1<<22,EXPORTED_REACTIVE_ENERGY_T1:1<<23,EXPORTED_REACTIVE_ENERGY_T2:1<<24,EXPORTED_REACTIVE_ENERGY_T3:1<<25,EXPORTED_REACTIVE_ENERGY_T4:1<<26,TOTAL_EXPORTED_NEGATIVE_REACTIVE_ENERGY:1<<27,EXPORTED_NEGATIVE_REACTIVE_ENERGY_T1:1<<28,EXPORTED_NEGATIVE_REACTIVE_ENERGY_T2:1<<29,EXPORTED_NEGATIVE_REACTIVE_ENERGY_T3:1<<30,EXPORTED_NEGATIVE_REACTIVE_ENERGY_T4:1<<31};var Yn={CURRENT_IN_PHASE_A:1<<0,CURRENT_IN_PHASE_B:1<<1,CURRENT_IN_PHASE_C:1<<2,CURRENT_IN_NEUTRAL:1<<3,VOLTAGE_IN_PHASE_A:1<<4,VOLTAGE_IN_PHASE_B:1<<5,VOLTAGE_IN_PHASE_C:1<<6,BATTERY_VOLTAGE:1<<7,FREQUENCY:1<<8,ACTIVE_POWER_SUM:1<<9,ACTIVE_POWER_PHASE_A:1<<10,ACTIVE_POWER_PHASE_B:1<<11,ACTIVE_POWER_PHASE_C:1<<12,REACTIVE_POWER_QPLUS_SUM:1<<13,REACTIVE_POWER_QPLUS_PHASE_A:1<<14,REACTIVE_POWER_QPLUS_PHASE_B:1<<15,REACTIVE_POWER_QPLUS_PHASE_C:1<<16,REACTIVE_POWER_QMINUS_SUM:1<<17,REACTIVE_POWER_QMINUS_PHASE_A:1<<18,REACTIVE_POWER_QMINUS_PHASE_B:1<<19,REACTIVE_POWER_QMINUS_PHASE_C:1<<20,POWER_COEFFICIENT_SUM:1<<21,POWER_COEFFICIENT_PHASE_A:1<<22,POWER_COEFFICIENT_PHASE_B:1<<23,POWER_COEFFICIENT_PHASE_C:1<<24,APPARENT_POWER_QPLUS_SUM:1<<25,APPARENT_POWER_QPLUS_PHASE_A:1<<26,APPARENT_POWER_QPLUS_PHASE_B:1<<27,APPARENT_POWER_QPLUS_PHASE_C:1<<28,APPARENT_POWER_QMINUS_SUM:1<<29,APPARENT_POWER_QMINUS_PHASE_A:1<<30,APPARENT_POWER_QMINUS_PHASE_B:1<<31};var xn={APPARENT_POWER_QMINUS_PHASE_C:1<<0,MAX_ACTIVE_POWER_DAY_T1:1<<1,MAX_ACTIVE_POWER_DAY_T2:1<<2,MAX_ACTIVE_POWER_DAY_T3:1<<3,MAX_ACTIVE_POWER_DAY_T4:1<<4,MAX_ACTIVE_POWER_MONTH_T1:1<<5,MAX_ACTIVE_POWER_MONTH_T2:1<<6,MAX_ACTIVE_POWER_MONTH_T3:1<<7,MAX_ACTIVE_POWER_MONTH_T4:1<<8,MAX_REACTIVE_POWER_DAY_T1:1<<9,MAX_REACTIVE_POWER_DAY_T2:1<<10,MAX_REACTIVE_POWER_DAY_T3:1<<11,MAX_REACTIVE_POWER_DAY_T4:1<<12,MAX_REACTIVE_POWER_MONTH_T1:1<<13,MAX_REACTIVE_POWER_MONTH_T2:1<<14,MAX_REACTIVE_POWER_MONTH_T3:1<<15,MAX_REACTIVE_POWER_MONTH_T4:1<<16,MAX_NEGATIVE_REACTIVE_POWER_DAY_T1:1<<17,MAX_NEGATIVE_REACTIVE_POWER_DAY_T2:1<<18,MAX_NEGATIVE_REACTIVE_POWER_DAY_T3:1<<19,MAX_NEGATIVE_REACTIVE_POWER_DAY_T4:1<<20,MAX_NEGATIVE_REACTIVE_POWER_MONTH_T1:1<<21,MAX_NEGATIVE_REACTIVE_POWER_MONTH_T2:1<<22,MAX_NEGATIVE_REACTIVE_POWER_MONTH_T3:1<<23,MAX_NEGATIVE_REACTIVE_POWER_MONTH_T4:1<<24,MAX_EXPORTED_ACTIVE_POWER_DAY_T1:1<<25,MAX_EXPORTED_ACTIVE_POWER_DAY_T2:1<<26,MAX_EXPORTED_ACTIVE_POWER_DAY_T3:1<<27,MAX_EXPORTED_ACTIVE_POWER_DAY_T4:1<<28,MAX_EXPORTED_ACTIVE_POWER_MONTH_T1:1<<29,MAX_EXPORTED_ACTIVE_POWER_MONTH_T2:1<<30,MAX_EXPORTED_ACTIVE_POWER_MONTH_T3:1<<31};var wn={MAX_EXPORTED_ACTIVE_POWER_MONTH_T4:1<<0,MAX_EXPORTED_REACTIVE_POWER_DAY_T1:1<<1,MAX_EXPORTED_REACTIVE_POWER_DAY_T2:1<<2,MAX_EXPORTED_REACTIVE_POWER_DAY_T3:1<<3,MAX_EXPORTED_REACTIVE_POWER_DAY_T4:1<<4,MAX_EXPORTED_REACTIVE_POWER_MONTH_T1:1<<5,MAX_EXPORTED_REACTIVE_POWER_MONTH_T2:1<<6,MAX_EXPORTED_REACTIVE_POWER_MONTH_T3:1<<7,MAX_EXPORTED_REACTIVE_POWER_MONTH_T4:1<<8,MAX_NEGATIVE_EXPORTED_REACTIVE_POWER_DAY_T1:1<<9,MAX_NEGATIVE_EXPORTED_REACTIVE_POWER_DAY_T2:1<<10,MAX_NEGATIVE_EXPORTED_REACTIVE_POWER_DAY_T3:1<<11,MAX_NEGATIVE_EXPORTED_REACTIVE_POWER_DAY_T4:1<<12,MAX_NEGATIVE_EXPORTED_REACTIVE_POWER_MONTH_T1:1<<13,MAX_NEGATIVE_EXPORTED_REACTIVE_POWER_MONTH_T2:1<<14,MAX_NEGATIVE_EXPORTED_REACTIVE_POWER_MONTH_T3:1<<15,MAX_NEGATIVE_EXPORTED_REACTIVE_POWER_MONTH_T4:1<<16,HOUR_MINUTE_SECOND:1<<17,DATE_MONTH_YEAR:1<<18,CURRENT_TRANSFORMATION_RATIO:1<<19,VOLTAGE_TRANSFORMATION_RATIO:1<<20,CURRENT_BALANCE:1<<21,POWER_THRESHOLD_T1:1<<22,POWER_THRESHOLD_T2:1<<23,POWER_THRESHOLD_T3:1<<24,POWER_THRESHOLD_T4:1<<25,OPTOPORT_SPEED:1<<26,MAGNET_INDUCTION:1<<27,SORT_DISPLAY_SCREENS:1<<29,TURN_OFF_DISPLAY:1<<30,AUTO_SCREEN_SCROLLING:1<<31};var Wn={EVENT:1<<0,PROFILE_P01:1<<1,PROFILE_P02:1<<2,PROFILE_P03:1<<3,PROFILE_P04:1<<4,PROFILE_P05:1<<5,PROFILE_P06:1<<6};var Hn={RELAY_ON_Y:1<<0,RELAY_ON_CENTER:1<<1,RELAY_ON_PB:1<<2,RELAY_ON_TARIFF_0:1<<3,RELAY_ON_TARIFF_1:1<<4,RELAY_ON_TARIFF_2:1<<5,RELAY_ON_TARIFF_3:1<<6,RELAY_ON_V_GOOD:1<<7,RELAY_OFF_Y:1<<8,RELAY_OFF_CENTER:1<<9,RELAY_OFF_TARIFF_0:1<<10,RELAY_OFF_TARIFF_1:1<<11,RELAY_OFF_TARIFF_2:1<<12,RELAY_OFF_TARIFF_3:1<<13,RELAY_OFF_I_LIMIT:1<<14,RELAY_OFF_V_BAD:1<<15,RELAY_OFF_DIFF_BAD:1<<16,RELAY_OFF_LIM_TARIFF_0:1<<17,RELAY_OFF_LIM_TARIFF_1:1<<18,RELAY_OFF_LIM_TARIFF_2:1<<19,RELAY_OFF_LIM_TARIFF_3:1<<20,RELAY_OFF_LIM_VAR_TARIFF_0:1<<21,RELAY_OFF_LIM_VAR_TARIFF_1:1<<22,RELAY_OFF_LIM_VAR_TARIFF_2:1<<23,RELAY_OFF_LIM_VAR_TARIFF_3:1<<24,RELAY_ON_PF_MIN:1<<25,RELAY_OFF_PF_MIN:1<<26,RELAY_ON_TIMEOUT:1<<27,RELAY_ON_SALDO:1<<28,RELAY_OFF_SALDO:1<<29,RELAY_OFF_SALDO_SOFT:1<<30};var Gn={TRANSFORMATION_RATIO:1<<0,METER_TYPE_R:1<<4,ACCUMULATE_BY_R_PLUS_MINUS:1<<7};var Xn={RESET_DAY_MAX_POWER_KEY:1<<0,RESET_MONTH_MAX_POWER_KEY:1<<1,BLOCK_KEY_OPTOPORT:1<<2,MAGNET_SCREEN_CONST:1<<5,ALLOW_BROWNOUT_INDICATION:1<<7};var Bn={OPTOPORT_SPEED:1<<26};var bn={RELAY_OFF_MAGNET:1<<0,RELAY_ON_MAGNET_TIMEOUT:1<<1,RELAY_ON_MAGNET_AUTO:1<<2};var Qn=function(t){return{plc:In.plc[x(t,4,1)],optoport:In.optoport[x(t,4,5)]}};var jn=function(t){var e=0;e=w(e,4,1,Number(mn.plc[t.plc]));e=w(e,4,5,Number(mn.optoport[t.optoport]));return e};function Kn(t,e,i){var r=i>>Fn;var n=[];var a=[];var s=[];for(var o=0;o<pt;o++){var h=!!x(r,1,o+1);if(h){n.push(t.getInt32());a.push(t.getInt32());s.push(t.getInt32())}else{n.push(null);a.push(null);s.push(null)}}return{wh:n,vari:a,vare:s}}function qn(t,e){var i=e.wh,r=e.vari,n=e.vare;var a=1+Fn;var s=t;for(var o=0;o<pt;o++){s=w(s,1,o+a,Number(!!i[o]&&!!r[o]&&!!n[o]))}return s}function kn(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;Ht.call(this,t,e)}kn.prototype=Object.create(Ht.prototype);kn.prototype.constructor=kn;kn.getDefaultOperatorParameters=function(){return{vpThreshold:265e3,vThreshold:156e3,ipThreshold:12e4,pmaxThreshold0:31800,pmaxThreshold1:31800,pmaxThreshold2:31800,pmaxThreshold3:31800,rmaxThreshold0:31800,rmaxThreshold1:31800,rmaxThreshold2:31800,rmaxThreshold3:31800,tint:30,calcPeriodDate:1,timeoutDisplay:127,timeoutScreen:7,displaySet1:Y(Vn,4229),displaySet2:Y(Yn,139776),displaySet3:Y(xn,0),relaySet:Y(Hn,771),speedOptoPort:Qn(64),ten:30,tu:30,timeIntervalPowerOff:3,reserved:0,timeoutBadVAVB:5,freqMax:55,freqMin:45,year:0,month:0,date:0,energyDecimalPoint:2,voltageTransformationRatioNumerator:1,voltageTransformationRatioDenominator:1,currentTransformationRatioNumerator:1,currentTransformationRatioDenominator:1,typeMeter:Y(Gn,0),phMin:0,timeoutIMax:5,timeoutPMax:5,timeoutCos:5,pMaxDef:1,displaySet4:Y(wn,2147876864)}};kn.prototype.getOperatorParameters=function(){return{vpThreshold:this.getUint32(),vThreshold:this.getUint32(),ipThreshold:this.getUint32(),pmaxThreshold0:this.getUint32(),pmaxThreshold1:this.getUint32(),pmaxThreshold2:this.getUint32(),pmaxThreshold3:this.getUint32(),rmaxThreshold0:this.getUint32(),rmaxThreshold1:this.getUint32(),rmaxThreshold2:this.getUint32(),rmaxThreshold3:this.getUint32(),tint:this.getUint8(),calcPeriodDate:this.getUint8(),timeoutDisplay:this.getUint8(),timeoutScreen:this.getUint8(),displaySet1:Y(Vn,this.getUint32()),displaySet2:Y(Yn,this.getUint32()),displaySet3:Y(xn,this.getUint32()),relaySet:Y(Hn,this.getUint32()),speedOptoPort:Qn(this.getUint8()),ten:this.getUint8(),tu:this.getUint8(),timeIntervalPowerOff:this.getUint8(),reserved:this.getUint8(),timeoutBadVAVB:this.getUint8(),freqMax:this.getUint8(),freqMin:this.getUint8(),year:this.getUint8(),month:this.getUint8(),date:this.getUint8(),energyDecimalPoint:this.getUint8(),voltageTransformationRatioNumerator:this.getUint16(),voltageTransformationRatioDenominator:this.getUint16(),currentTransformationRatioNumerator:this.getUint16(),currentTransformationRatioDenominator:this.getUint16(),typeMeter:Y(Gn,this.getUint8()),phMin:this.getUint16(),timeoutIMax:this.getUint8(),timeoutPMax:this.getUint8(),timeoutCos:this.getUint8(),pMaxDef:this.getUint8(),displaySet4:Y(wn,this.getUint32())}};kn.prototype.setOperatorParameters=function(t){this.setUint32(t.vpThreshold);this.setUint32(t.vThreshold);this.setUint32(t.ipThreshold);this.setUint32(t.pmaxThreshold0);this.setUint32(t.pmaxThreshold1);this.setUint32(t.pmaxThreshold2);this.setUint32(t.pmaxThreshold3);this.setUint32(t.rmaxThreshold0);this.setUint32(t.rmaxThreshold1);this.setUint32(t.rmaxThreshold2);this.setUint32(t.rmaxThreshold3);this.setUint8(t.tint);this.setUint8(t.calcPeriodDate);this.setUint8(t.timeoutDisplay);this.setUint8(t.timeoutScreen);this.setUint32(V(Vn,t.displaySet1));this.setUint32(V(Yn,t.displaySet2));this.setUint32(V(xn,t.displaySet3));this.setUint32(V(Hn,t.relaySet));this.setUint8(jn(t.speedOptoPort));this.setUint8(t.ten);this.setUint8(t.tu);this.setUint8(t.timeIntervalPowerOff);this.setUint8(t.reserved);this.setUint8(t.timeoutBadVAVB);this.setUint8(t.freqMax);this.setUint8(t.freqMin);this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.energyDecimalPoint);this.setUint16(t.voltageTransformationRatioNumerator);this.setUint16(t.voltageTransformationRatioDenominator);this.setUint16(t.currentTransformationRatioNumerator);this.setUint16(t.currentTransformationRatioDenominator);this.setUint8(V(Gn,t.typeMeter));this.setUint16(t.phMin);this.setUint8(t.timeoutIMax);this.setUint8(t.timeoutPMax);this.setUint8(t.timeoutCos);this.setUint8(t.pMaxDef);this.setUint32(V(wn,t.displaySet4))};kn.prototype.getOperatorParametersExtended=function(){return{timeoutRelayOn:this.getUint8(),define1:Y(Xn,this.getUint8()),timeoutRelayKey:this.getUint8(),timeoutRelayAuto:this.getUint8()}};kn.prototype.setOperatorParametersExtended=function(t){this.setUint8(t.timeoutRelayOn);this.setUint8(V(Xn,t.define1));this.setUint8(t.timeoutRelayKey);this.setUint8(t.timeoutRelayAuto);this.setUint32(0);this.setUint8(0)};kn.prototype.getEnergies=function(){var t=[];var e=[];var i=[];for(var r=0;r<pt;r++){t.push(this.getInt32());e.push(this.getInt32());i.push(this.getInt32())}return{wh:t,vari:e,vare:i}};kn.prototype.setEnergies=function(t){for(var e=0;e<pt;e++){this.setInt32(t.wh[e]);this.setInt32(t.vari[e]);this.setInt32(t.vare[e])}};kn.prototype.getPackedEnergyWithType=function(){var t=this.getUint8();var e=x(t,Fn,1);var i=Kn(this,e,t);return{energyType:e,energies:i}};kn.prototype.setPackedEnergyWithType=function(t){var e=t.energyType,i=t.energies;if(e){var r=qn(e,i);var n=r>>Fn;this.setUint8(r);for(var a=0;a<pt;a++){var s=!!x(n,1,a+1);if(s){this.setInt32(i.wh[a]);this.setInt32(i.vari[a]);this.setInt32(i.vare[a])}}return}for(var o=0;o<pt;o++){this.setInt32(i.wh[o]);this.setInt32(i.vari[o]);this.setInt32(i.vare[o])}};kn.prototype.getEnergyPeriods=function(t){var e=this;return new Array(t).fill(0).map((function(){var t=e.getUint16();return t===65535?undefined:t}))};kn.prototype.setEnergyPeriods=function(t){var e=this;t.forEach((function(t){return e.setUint16(t===undefined?65535:t)}))};kn.prototype.getMaxDemand=function(){return{hourPmax:this.getUint8(),minPmax:this.getUint8(),pmax:this.getInt32(),hourVariMax:this.getUint8(),minVariMax:this.getUint8(),variMax:this.getInt32(),hourVareMax:this.getUint8(),minVareMax:this.getUint8(),vareMax:this.getInt32()}};kn.prototype.setMaxDemand=function(t){this.setUint8(t.hourPmax);this.setUint8(t.minPmax);this.setInt32(t.pmax);this.setUint8(t.hourVariMax);this.setUint8(t.minVariMax);this.setInt32(t.variMax);this.setUint8(t.hourVareMax);this.setUint8(t.minVareMax);this.setInt32(t.vareMax)};kn.prototype.getDayMaxDemandResponse=function(){var t=this;var e=this.getDate();var i=new Array(pt).fill(0).map((function(){return t.getMaxDemand()}));return{date:e,maxDemands:i}};kn.prototype.setDayMaxDemandResponse=function(t){var e=this;this.setDate(t.date);t.maxDemands.forEach((function(t){return e.setMaxDemand(t)}))};kn.prototype.getMonthMaxDemandResponse=function(){var t=this;var e={year:this.getUint8(),month:this.getUint8()};var i=new Array(pt).fill(0).map((function(){return t.getMaxDemand()}));return{date:e,maxDemands:i}};kn.prototype.setMonthMaxDemandResponse=function(t){var e=this;this.setUint8(t.date.year);this.setUint8(t.date.month);t.maxDemands.forEach((function(t){return e.setMaxDemand(t)}))};kn.prototype.getDemand=function(){var t=this.getUint8();var e=this.getUint8();return{date:{year:t>>1,month:t<<3&15|e>>5,date:e&31},demandParam:this.getUint8(),firstIndex:this.getUint16(),count:this.getUint8(),period:this.getUint8()}};kn.prototype.setDemand=function(t){var e=t.date.year<<1|t.date.month>>3&1;var i=t.date.month<<5&224|t.date.date&31;this.setUint8(e);this.setUint8(i);this.setUint8(t.demandParam);this.setUint16(t.firstIndex);this.setUint8(t.count);this.setUint8(t.period)};kn.prototype.getOperatorParametersExtended2=function(){return{deltaCorMin:this.getUint8(),timeoutMagnetOff:this.getUint8(),relaySetExt:Y(bn,this.getUint8()),timeoutMagnetOn:this.getUint8(),phaseDefault:this.getUint8(),displaySet21:this.getUint32(),displaySet22:this.getUint32(),displaySet23:this.getUint32(),displaySet24:Y(Bn,this.getUint32()),channel1:this.getUint8(),channel2:this.getUint8(),channel3:this.getUint8(),channel4:this.getUint8(),channel5:this.getUint8(),channel6:this.getUint8(),timeCorrectPeriod:this.getUint8()}};kn.prototype.setOperatorParametersExtended2=function(t){this.setUint8(t.deltaCorMin);this.setUint8(t.timeoutMagnetOff);this.setUint8(V(bn,t.relaySetExt));this.setUint8(t.timeoutMagnetOn);this.setUint8(t.phaseDefault);this.setUint32(t.displaySet21);this.setUint32(t.displaySet22);this.setUint32(t.displaySet23);this.setUint32(V(Bn,t.displaySet24));this.setUint8(t.channel1);this.setUint8(t.channel2);this.setUint8(t.channel3);this.setUint8(t.channel4);this.setUint8(t.channel5);this.setUint8(t.channel6);this.setUint8(t.timeCorrectPeriod)};kn.prototype.getOperatorParametersExtended4=function(){return{displaySet5:Y(Wn,this.getUint32()),displaySet25:Y(Wn,this.getUint32()),displaySet31:Y(Vn,this.getUint32()),displaySet32:Y(Vn,this.getUint32()),displaySet33:Y(Vn,this.getUint32()),displaySet34:Y(Vn,this.getUint32()),displaySet35:Y(Wn,this.getUint32())}};kn.prototype.setOperatorParametersExtended4=function(t){this.setUint32(V(Wn,t.displaySet5));this.setUint32(V(Wn,t.displaySet25));this.setUint32(V(Vn,t.displaySet31));this.setUint32(V(Vn,t.displaySet32));this.setUint32(V(Vn,t.displaySet33));this.setUint32(V(Vn,t.displaySet34));this.setUint32(V(Wn,t.displaySet35))};var zn=3;var Zn=4;var $n=22;var Jn=function(t){var e=new kn(t?.energyType?Zn:zn);e.setDate(t?.date);if(t?.energyType){e.setUint8(t.energyType)}return Xt($n,e.data)};var ta=79;var ea=3;var ia=function(t){var e=new kn(ea);e.setDate(t.date);return Xt(ta,e.data)};var ra=118;var na=7;var aa=function(t){var e=new kn(na);e.setDemand(t);return Xt(ra,e.data)};var sa=94;var oa=1;var ha=function(t){var e=new kn(oa);e.setUint8(t.displayMode);return Xt(sa,e.data)};var Ea=15;var _a=function(){return Xt(Ea)};var fa=3;var ua=function(t){if(t.energyType){return Xt(fa,[t.energyType])}return Xt(fa)};var Ta=78;var va=function(){return Xt(Ta)};var Aa=80;var Ra=function(){return Xt(Aa)};var Ua=90;var da=5;var pa=function(t){var e=new kn(da);e.setUint8(t.channel);e.setUint8(t.channelParameter);e.setDate(t.date);return Xt(Ua,e.data)};var ca=73;var ga=3;var la=function(t){var e=new kn(ga);e.setDate(t.date);return Xt(ca,e.data)};var Oa=85;var ya=3;var Pa=function(t){var e=new kn(ya);e.setDate(t.date);return Xt(Oa,e.data)};var Ia=72;var ma=3;var Na=function(t){var e=new kn(ma);e.setDate(t.date);return Xt(Ia,e.data)};var Ma=84;var Sa=3;var Da=function(t){var e=new kn(Sa);e.setDate(t.date);return Xt(Ma,e.data)};var Ca=63;var La=function(){return Xt(Ca)};var Fa=71;var Va=function(){return Xt(Fa)};var Ya=93;var xa=function(t){return Xt(Ya,[t.displayMode].concat(h(t.order)))};var wa=31;var Wa=Sn;var Ha=function(t){var e=new kn(Wa);e.setOperatorParameters(t);return Xt(wa,e.data)};var Ga=64;var Xa=Dn;var Ba=function(t){var e=new kn(Xa);e.setOperatorParametersExtended(t);return Xt(Ga,e.data)};var ba=69;var Qa=Cn;var ja=function(t){var e=new kn(Qa);e.setOperatorParametersExtended2(t);return Xt(ba,e.data)};var Ka=117;var qa=Ln;var ka=function(t){var e=new kn(qa);e.setOperatorParametersExtended4(t);return Xt(Ka,e.data)};var za={};var Za=pr(za);za[Qt]=Kt;za[qt]=kt;za[zt]=Zt;za[$t]=Jt;za[te]=ee;za[ie]=re;za[ie]=re;za[ne]=se;za[oe]=Ee;za[_e]=ue;za[Te]=ve;za[Ae]=Re;za[Ue]=pe;za[ce]=ge;za[le]=Oe;za[ye]=Pe;za[Ie]=Ne;za[Me]=De;za[He]=Xe;za[Be]=be;za[Qe]=je;za[Ke]=ke;za[ze]=$e;za[Je]=ti;za[ei]=ii;za[ai]=si;za[ri]=ni;za[oi]=hi;za[Ei]=_i;za[fi]=ui;za[Ti]=Ai;za[Ri]=di;za[pi]=ci;za[gi]=Oi;za[yi]=Pi;za[Ii]=mi;za[Ni]=Mi;za[Di]=Li;za[Fi]=Yi;za[xi]=Wi;za[Hi]=Xi;za[Qi]=ji;za[Ki]=ki;za[zi]=$i;za[Ji]=er;za[ir]=nr;za[ar]=or;za[hr]=_r;za[fr]=ur;za[Tr]=vr;za[Nn]=Mn;za[$n]=Jn;za[ta]=ia;za[ra]=aa;za[sa]=ha;za[Ea]=_a;za[fa]=ua;za[Ta]=va;za[Aa]=Ra;za[Ua]=pa;za[ca]=la;za[Oa]=Pa;za[Ia]=Na;za[Ma]=Da;za[Ca]=La;za[Fa]=Va;za[Ya]=xa;za[wa]=Ha;za[Ga]=Ba;za[ba]=ja;za[Ka]=ka;var $a=145;var Ja=30;var ts=function(t){var e=[Ja,t.length+2,0,$a].concat(h(t));return[].concat(h(e),[Rr(e)])};getBase64FromBytes=Gt;toBytes=Za;setDataSegment=ts})();
//#endregion


/*
  Incoming arguments:
    * msg - JSON message payload downlink message json
    * msgType - type of message, for ex. 'ATTRIBUTES_UPDATED', 'POST_TELEMETRY_REQUEST', etc.
    * metadata - list of key-value pairs with additional data about the message
    * integrationMetadata - list of key-value pairs with additional data defined in Integration executing this converter

  Output must be an object with the following fields:
    * contentType - BINARY
    * data - payload in base64
*/

var bytes = toBytes(msg.commands);

// send nothing if not fit in a single data segment
if ( bytes.length > MAX_DATA_SEGMENT_SIZE ) {
    bytes = [];
} else {
    bytes = setDataSegment(bytes);
}

var result = {
    contentType: 'BINARY',
    data: getBase64FromBytes(bytes)
};

return result;
