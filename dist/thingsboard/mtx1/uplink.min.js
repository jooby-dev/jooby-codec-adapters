// IMPORTANT!!!
// This example only for default uplink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/


//#region [autogenerated jooby-codec bundle from index.js]
var fromBytes,getDataSegment;(function(){"use strict";function r(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,a=Array(t);e<t;e++)a[e]=r[e];return a}function t(r){if(Array.isArray(r))return r}function e(t){if(Array.isArray(t))return r(t)}function a(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function n(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var a,n,i,v,o=[],f=true,E=false;try{if(i=(e=e.call(r)).next,0===t){if(Object(e)!==e)return;f=!1}else for(;!(f=(a=i.call(e)).done)&&(o.push(a.value),o.length!==t);f=!0);}catch(r){E=true,n=r}finally{try{if(!f&&null!=e.return&&(v=e.return(),Object(v)!==v))return}finally{if(E)throw n}}return o}}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function v(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(r,e){return t(r)||n(r,e)||s(r,e)||i()}function f(r){return t(r)||a(r)||s(r)||i()}function E(r){return e(r)||a(r)||s(r)||v()}function s(t,e){if(t){if("string"==typeof t)return r(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(t,e):void 0}}var u={separator:" ",prefix:""};var _=function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var e=Object.assign({},u,t),a=e.separator,n=e.prefix;return r.map(function(r){return"".concat(n).concat(r.toString(16).padStart(2,"0"))}).join(a)};var g=0;var A=1;var l=2;var c=3;var R=Object.freeze({__proto__:null,READ_ONLY:c,READ_WRITE:l,ROOT:A,UNENCRYPTED:g});var T=1;var h=3;var d=4;var O=5;var U=7;var N=8;var S=9;var I=13;var D=15;var L=16;var m=17;var C=18;var p=19;var P=20;var M=21;var y=22;var F=23;var w=24;var Y=25;var B=28;var G=30;var b=31;var H=40;var W=41;var V=42;var x=44;var z=45;var K=46;var X=47;var j=49;var k=50;var Q=51;var Z=52;var q=53;var $=54;var J=57;var rr=58;var tr=59;var er=60;var ar=61;var nr=62;var ir=65;var vr=70;var or=74;var fr=75;var Er=79;var sr=80;var ur=82;var _r=83;var gr=88;var Ar=89;var lr=91;var cr=92;var Rr=93;var Tr=94;var hr=100;var dr=109;var Or=111;var Ur=112;var Nr=113;var Sr=114;var Ir=116;var Dr=117;var Lr=118;var mr=122;var Cr=Object.freeze({__proto__:null,activateRatePlan:p,getBv:Ur,getCorrectTime:nr,getCriticalEvent:ir,getCurrentStatusMeter:J,getCurrentValues:I,getDateTime:U,getDayDemand:y,getDayDemandExport:Er,getDayMaxDemand:j,getDayMaxDemandExport:gr,getDayMaxDemandPrevious:or,getDayProfile:tr,getDemand:Lr,getDemandParameters:Dr,getDeviceId:O,getDeviceType:d,getDisplayParam:Tr,getEnergy:D,getEnergyDayPrevious:h,getEnergyExport:lr,getEnergyExportDayPrevious:sr,getEventStatus:T,getEvents:Q,getEventsCounters:Z,getExtendedCurrentValues:rr,getExtendedCurrentValues2:z,getHalfHourDemand:M,getHalfHourDemandExport:_r,getHalfHourDemandPrevious:fr,getHalfHourEnergies:Or,getMagneticFieldThreshold:dr,getMeterInfo:mr,getMonthDemand:F,getMonthDemandExport:ur,getMonthMaxDemand:k,getMonthMaxDemandExport:Ar,getOperatorParameters:G,getOperatorParametersExtended3:Nr,getRatePlanInfo:x,getSaldo:W,getSaldoParameters:K,getSeasonProfile:er,getSpecialDay:ar,getVersion:H,prepareRatePlan:P,resetPowerMaxDay:q,resetPowerMaxMonth:$,runTariffPlan:vr,setAccessKey:S,setCorrectDateTime:cr,setCorrectTime:B,setDateTime:N,setDayProfile:L,setDemandParameters:Ir,setDisplayParam:Rr,setOperatorParameters:b,setOperatorParametersExtended3:Sr,setSaldo:V,setSaldoParameters:X,setSeasonProfile:m,setSpecialDay:C,setSpecialOperation:hr,turnRelayOff:Y,turnRelayOn:w});var pr=120;var Pr=121;var Mr=254;var yr=255;var Fr=Object.freeze({__proto__:null,activateRatePlan:p,errorDataFrameResponse:yr,errorResponse:Mr,getBv:Ur,getCorrectTime:nr,getCriticalEvent:ir,getCurrentStatusMeter:J,getCurrentValues:I,getDateTime:U,getDayDemand:y,getDayDemandExport:Er,getDayEnergies:pr,getDayMaxDemand:j,getDayMaxDemandExport:gr,getDayMaxDemandPrevious:or,getDayMaxPower:Pr,getDayProfile:tr,getDemand:Lr,getDemandParameters:Dr,getDeviceId:O,getDeviceType:d,getDisplayParam:Tr,getEnergy:D,getEnergyDayPrevious:h,getEnergyExport:lr,getEnergyExportDayPrevious:sr,getEventStatus:T,getEvents:Q,getEventsCounters:Z,getExtendedCurrentValues:rr,getExtendedCurrentValues2:z,getHalfHourDemand:M,getHalfHourDemandExport:_r,getHalfHourDemandPrevious:fr,getHalfHourEnergies:Or,getMagneticFieldThreshold:dr,getMeterInfo:mr,getMonthDemand:F,getMonthDemandExport:ur,getMonthMaxDemand:k,getMonthMaxDemandExport:Ar,getOperatorParameters:G,getOperatorParametersExtended3:Nr,getRatePlanInfo:x,getSaldo:W,getSaldoParameters:K,getSeasonProfile:er,getSpecialDay:ar,getVersion:H,prepareRatePlan:P,resetPowerMaxDay:q,resetPowerMaxMonth:$,runTariffPlan:vr,setAccessKey:S,setCorrectDateTime:cr,setCorrectTime:B,setDateTime:N,setDayProfile:L,setDemandParameters:Ir,setDisplayParam:Rr,setOperatorParameters:b,setOperatorParametersExtended3:Sr,setSaldo:V,setSaldoParameters:X,setSeasonProfile:m,setSpecialDay:C,setSpecialOperation:hr,turnRelayOff:Y,turnRelayOn:w});var wr=function(r){var t={};for(var e in r){var a=r[e];t[a]=e}return t};var Yr=wr(Fr);var Br=p;var Gr=0;var br=function(r){if(r.length!==Gr){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var Hr=0;var Wr=128;var Vr=129;var xr=130;var zr=131;var Kr=132;var Xr=133;var jr=134;var kr=135;var Qr=136;var Zr=137;var qr=144;var $r=145;var Jr=146;var rt=147;var tt=149;var et=151;var at=152;var nt=153;var it=154;var vt=155;var ot=156;var ft=159;var Et=160;var st=240;var ut=Object.freeze({__proto__:null,ACCESS_DENIED:rt,BAD_ARRAY_INDEX:jr,BAD_BLOCK_NUMBER:ot,BAD_DATA_LENGTH:Xr,BAD_MESSAGE:Kr,BAD_RATE_PLAN_ID:Qr,BAD_RATE_PLAN_SIZE:Zr,BAD_RESPONSE_LENGTH:qr,BAD_SALDO_WRITE:tt,BLOCKED_METER:et,CALIBRATION_DISABLED:Jr,DECRYPTION_FAILURE:xr,INTERNAL:st,INVALID_CORRECTION_INTERVAL:it,NOT_ALIGNED_DATA:Vr,NOT_PREPARED_RATE_PLAN:kr,NO_DATA_FOR_DATE:$r,OK:Hr,OUT_OFF_RANGE:ft,SET_METER_TYPE_FAILURE:Et,TIME_CORRECTION_FAILURE:nt,TIME_CORRECTION_OUT_HALF_HOUR_DISABLED:vt,UNENCRYPTED_COMMAND_DISABLED:at,UNKNOWN_COMMAND:Wr,UNKNOWN_PROTOCOL:zr});var _t=wr(ut);var gt=yr;var At=Yr[yr];var lt=1;var ct=function(r){if(r.length!==lt){throw new Error("Wrong buffer size: ".concat(r.length,"."))}var t=o(r,1),e=t[0];return{errorCode:e,errorName:_t[e]}};var Rt=1;var Tt=2;var ht=3;var dt=4;var Ot=Math.log,Ut=Math.pow,Nt=Math.LN2;var St=function(r,t,e,a,n){var i,v,o=n*8-a-1,f=(1<<o)-1,E=f>>1,s=-7,u=e?n-1:0,_=e?-1:1,g=r[t+u];u+=_;i=g&(1<<-s)-1;g>>=-s;s+=o;for(;s>0;i=i*256+r[t+u],u+=_,s-=8);v=i&(1<<-s)-1;i>>=-s;s+=a;for(;s>0;v=v*256+r[t+u],u+=_,s-=8);if(i===0){i=1-E}else if(i===f){return v?NaN:g?-Infinity:Infinity}else{v=v+Ut(2,a);i=i-E}return(g?-1:1)*v*Ut(2,i-a)};var It=function(r,t,e,a,n,i){var v,o,f,E=i*8-n-1,s=(1<<E)-1,u=s>>1,_=n===23?Ut(2,-24)-Ut(2,-77):0,g=a?0:i-1,A=a?1:-1,l=e<0||e===0&&1/e<0?1:0;e<0&&(e=-e);if(e!==e||e===Infinity){o=e!==e?1:0;v=s}else{v=Ot(e)/Nt|0;if(e*(f=Ut(2,-v))<1){v--;f*=2}if(v+u>=1){e+=_/f}else{e+=_*Ut(2,1-u)}if(e*f>=2){v++;f/=2}if(v+u>=s){o=0;v=s}else if(v+u>=1){o=(e*f-1)*Ut(2,n);v=v+u}else{o=e*Ut(2,u-1)*Ut(2,n);v=0}}for(;n>=8;r[t+g]=o&255,g+=A,o/=256,n-=8);v=v<<n|o;E+=n;for(;E>0;r[t+g]=v&255,g+=A,v/=256,E-=8);r[t+g-A]|=l*128};var Dt=[1,0];var Lt=[2,1,0];var mt=[3,2,1,0];var Ct=[0,1];var pt=[0,1,2];var Pt=[0,1,2,3];var Mt=function(r,t){return r[t]};var yt=function(r,t,e){var a=e?Ct:Dt;var n=r[t+a[0]];var i=r[t+a[1]]<<8;return n|i};var Ft=function(r,t,e){var a=e?pt:Lt;var n=r[t+a[0]];var i=r[t+a[1]]<<8;var v=r[t+a[2]]<<16;return n|i|v};var wt=function(r,t,e){var a=e?Pt:mt;var n=r[t+a[3]]*16777216;var i=r[t+a[2]]*65536;var v=r[t+a[1]]*256;var o=r[t+a[0]];return n+i+v+o};var Yt=function(r,t,e){r[t]=e&255};var Bt=function(r,t,e,a){var n=a?Ct:Dt;r[t+n[0]]=e&255;r[t+n[1]]=e>>>8&255};var Gt=function(r,t,e,a){var n=a?pt:Lt;r[t+n[0]]=e&255;r[t+n[1]]=e>>>8&255;r[t+n[2]]=e>>>16&255};var bt=function(r,t,e,a){var n=a?Pt:mt;r[t+n[0]]=e&255;r[t+n[1]]=e>>>8&255;r[t+n[2]]=e>>>16&255;r[t+n[3]]=e>>>24&255};function Ht(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof r==="number"){var e=new Array(r).fill(0);this.data=e}else{this.data=r}this.offset=0;this.isLittleEndian=t}Ht.prototype={toUint8Array:function(){return this.data},seek:function(r){if(r<0||r>=this.data.length){throw new Error("Invalid position.")}this.offset=r},setInt8:function(r){Yt(this.data,this.offset,r<0?r|256:r);this.offset+=Rt},getInt8:function(){var r=Mt(this.data,this.offset);this.offset+=Rt;return r&128?r^-256:r},setUint8:function(r){Yt(this.data,this.offset,r);this.offset+=Rt},getUint8:function(){var r=Mt(this.data,this.offset);this.offset+=Rt;return r},setInt16:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Bt(this.data,this.offset,r<0?r|65536:r,t);this.offset+=Tt},getInt16:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=yt(this.data,this.offset,r);this.offset+=Tt;return t&32768?t^-65536:t},setUint16:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Bt(this.data,this.offset,r,t);this.offset+=Tt},getUint16:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=yt(this.data,this.offset,r);this.offset+=Tt;return t},setInt24:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Gt(this.data,this.offset,r<0?r|16777216:r,t);this.offset+=ht},getInt24:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=Ft(this.data,this.offset,r);this.offset+=ht;return t&8388608?t^-16777216:t},setUint24:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Gt(this.data,this.offset,r,t);this.offset+=ht},getUint24:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=Ft(this.data,this.offset,r);this.offset+=ht;return t},setInt32:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;bt(this.data,this.offset,r<0?r|4294967296:r,t);this.offset+=dt},getInt32:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=wt(this.data,this.offset,r);this.offset+=dt;return t&2147483648?t^-4294967296:t},setUint32:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;bt(this.data,this.offset,r,t);this.offset+=dt},getUint32:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=wt(this.data,this.offset,r);this.offset+=dt;return t},setFloat32:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;It(this.data,this.offset,r,t,23,4);this.offset+=dt},getFloat32:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=St(this.data,this.offset,r,23,4);this.offset+=dt;return t},setString:function(r){this.setUint8(r.length);for(var t=0;t<r.length;++t){this.setUint8(r.charCodeAt(t))}},getString:function(){var r=this.getUint8();var t=this.offset+r;var e=[];while(this.offset<t){e.push(String.fromCharCode(this.getUint8()))}return e.join("")},getBytesToOffset:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,r)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=t+r;return this.data.slice(t,this.offset)},setBytes:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var e=this.data;e.splice.apply(e,[t,r.length].concat(E(r)));this.data=e;this.offset=t+r.length}};Object.defineProperties(Ht.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var Wt=Mr;var Vt=function(r){return function(t){var e=new Ht(t,false);var a=e.getUint8();var n=e.getUint8();return{commandId:a,commandName:r[a],errorCode:n,errorName:_t[n]}}};var xt=Vt(Yr);var zt=Ur;var Kt=6;var Xt=function(r){if(r.length!==Kt){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{vector:r}};var jt=function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var e={};for(var a in r){e[a]=(t&r[a])!==0}return e};var kt=function(r,t,e){return(1<<t)-1&r>>e-1};var Qt="x";var Zt=[".","1","3","R","M"];var qt=[".","A","G","R","T","D"];var $t=[".","0","1","2","3","4","5"];var Jt=[".","A","B","C","D","E","F"];var re=[".","A","B","C","D","E","F","H","K","G"];var te=[".","1","2","3","4"];var ee=[".","L","M","Z","K"];var ae=[".","0","1","2","3","4","5","6","7","8","9"];var ne=[".","D","B","C","E","P","R","O","L","F","S","M","Y","G","N","U"];var ie=[".","0","1","2","3","4","5","6","P","R","L","E","G","-","/"];var ve=[".","H","A","T","0","0","0","0","0","1","2","3","4","0","0","0"];var oe=[".","0","1","2","3","4","5","6","7","8","I","X","G","W","M","-"];var fe={typeMeterG:1<<0,downgradedToA:1<<4,supportMeterInfo:1<<6};var Ee={typeMeterTransformer:1<<0,downgradedToR:1<<3,typeMeterG:1<<4,supportMeterInfo:1<<6,reactiveByQuadrants:1<<7};var se=function(r){var t=jt(Ee,r);return{meterType:"mtx3",...t,typeMeterG:!t.typeMeterG}};var ue=function(r){return[r>>4,r&15]};var _e=function(r){var t=new Array(r.length*2).fill(0);r.forEach(function(r,e){var a=ue(r),n=o(a,2),i=n[0],v=n[1];t[e*2]=i;t[e*2+1]=v});return t};var ge=function(r){if(r.length!==14&&r.length!==16){throw new Error("Device type bytes wrong size")}var t=["MTX "];t.push(Zt[r[0]]??Qt);t.push(qt[r[1]]??Qt);t.push($t[r[2]]??Qt);t.push($t[r[3]]??Qt);t.push(".");t.push(Jt[r[4]]??Qt);t.push(re[r[5]]??Qt);t.push(".");t.push(te[r[6]]??Qt);t.push(ee[r[7]]??Qt);var e=r[8];t.push(ae[r[9]]??Qt);t.push("-");var a;if(r.length<14||r[12]===0&&r[13]===0){t.push(ne[r[10]]??Qt);a=11}else if(r[13]===0){t.push(ne[r[10]]??Qt);t.push(ne[r[11]]??Qt);a=12}else{t.push(ne[r[10]]??Qt);t.push(ne[r[11]]??Qt);t.push(ne[r[12]]??Qt);a=13}var n=r[a];if(n&&n!==0){t.push(ve[n]??Qt)}return{type:t.join(""),revision:e}};var Ae=function(r){if(r.length<14){throw new Error("The buffer is too small")}var t=["MTX "];var e=r[1]===5?"-":" ";t.push(Zt[r[0]]??Qt);t.push(qt[r[1]]??Qt);t.push(e);for(var a=2;a<r.length;a++){if(r[a]!==0){t.push(ie[r[a]]??Qt)}}return{type:t.join("")}};var le=function(r){if(r.length<14){throw new Error("The buffer is too small")}var t=[];t.push(Zt[r[0]]??Qt);for(var e=1;e<r.length;e++){if(r[e]!==0){t.push(oe[r[e]]??Qt)}}return{type:t.join("")}};var ce=function(r){if(r.length!==9){throw new Error("The buffer is too small")}var t;var e=[0,5,6,7,9,127,239];var a=e.indexOf(r[0])!==-1?2:0;var n=_e(r.slice(0,8));var i=n[a];var v=Zt[i];if(v==="1"||v==="3"){t={...ge(n.slice(a)),descriptor:v==="3"?se(r[8]):{meterType:"mtx1",...jt(fe,r[8])}}}else{t=v==="M"?le(n):Ae(n)}return t};var Re=80;var Te=81;var he=82;var de=83;var Oe=84;var Ue=85;var Ne=86;var Se=87;var Ie=88;var De=89;var Le=90;var me=91;var Ce=255;var pe=Object.freeze({__proto__:null,DATA_REQUEST:Re,DATA_RESPONSE:Te,FRAGMENT_REQUEST:Le,FRAGMENT_RESPONSE:me,IDENT_REQUEST:he,IDENT_RESPONSE:de,INVALID:Ce,L2_CHECK_ADDRESS_REQUEST:Ne,L2_CHECK_ADDRESS_RESPONSE:Se,L2_RM_ADDRESS_REQUEST:Ie,L2_RM_ADDRESS_RESPONSE:De,L2_SET_ADDRESS_REQUEST:Oe,L2_SET_ADDRESS_RESPONSE:Ue});wr(pe);wr(R);var Pe=0;var Me=1;var ye=2;var Fe=3;var we=4;var Ye=5;var Be=6;var Ge=7;var be=8;var He=9;var We=10;var Ve=11;var xe=12;var ze=13;var Ke=14;var Xe=Object.freeze({__proto__:null,CASE_MODULE_OPEN:We,CASE_OPEN:Pe,CASE_TERMINAL_OPEN:He,DEVICE_FAILURE:be,ERROR_ACCESS:Ye,MAGNETIC_ON:Me,PARAMETERS_UPDATE_LOCAL:Fe,PARAMETERS_UPDATE_REMOTE:ye,PROTECTION_RESET_EM:ze,PROTECTION_RESET_MAGNETIC:Ke,RESTART:we,TARIFF_TABLE_GET:xe,TARIFF_TABLE_SET:Ve,TIME_CORRECT:Ge,TIME_SET:Be});var je=wr(Xe);wr(Cr);var ke=1;var Qe=2;var Ze=3;var qe=16;var $e=17;var Je=18;var ra=19;var ta=20;var ea=21;var aa=32;var na=33;var ia=34;var va=35;var oa=36;var fa=37;var Ea=38;var sa=39;var ua=40;var _a=41;var ga=49;var Aa=50;var la=51;var ca=52;var Ra=53;var Ta=54;var ha=55;var da=56;var Oa=57;var Ua=60;var Na=61;var Sa=62;var Ia=63;var Da=64;var La=65;var ma=66;var Ca=67;var pa=68;var Pa=69;var Ma=70;var ya=71;var Fa=72;var wa=73;var Ya=74;var Ba=75;var Ga=76;var ba=77;var Ha=78;var Wa=79;var Va=80;var xa=81;var za=82;var Ka=83;var Xa=84;var ja=85;var ka=86;var Qa=87;var Za=88;var qa=89;var $a=96;var Ja=97;var rn=98;var tn=99;var en=100;var an=101;var nn=102;var vn=103;var on=104;var fn=105;var En=112;var sn=113;var un=114;var _n=115;var gn=116;var An=117;var ln=118;var cn=119;var Rn=120;var Tn=121;var hn=122;var dn=123;var On=124;var Un=125;var Nn=126;var Sn=144;var In=145;var Dn=147;var Ln=148;var mn=152;var Cn=156;var pn=157;var Pn=158;var Mn=159;var yn=160;var Fn=161;var wn=162;var Yn=176;var Bn=177;var Gn=178;var bn=179;var Hn=180;var Wn=181;var Vn=182;var xn=183;var zn=185;var Kn=186;var Xn=224;var jn=225;var kn=226;var Qn=227;var Zn=228;var qn=229;var $n=230;var Jn=231;var ri=232;var ti=Object.freeze({__proto__:null,ACCESS_LOCKED:qe,ACC_PARAM_BAD:un,ACC_PARAM_EXT_BAD:_n,BAD_TEST_EEPROM:on,BAD_TEST_FRAM:fn,BATTERY_FAULT:Ka,BATTERY_OK:za,BIPOLAR_POWER_FAULT:Hn,BIPOLAR_POWER_OK:Wn,BLOCK_TARIFF_BAD:An,CALC_PERIOD_BAD:gn,CALIBRATION_FAULT:ja,CALIBRATION_FLAG_RESET:vn,CALIBRATION_FLAG_SET:nn,CALIBRATION_OK:Xa,CALIBRATION_PARAM_BAD:ln,CASE_CLOSE:ra,CASE_KLEMA_CLOSE:dn,CASE_KLEMA_OPEN:hn,CASE_MODULE_CLOSE:Un,CASE_MODULE_OPEN:On,CASE_OPEN:Je,CHANGE_ACCESS_KEY0:aa,CHANGE_ACCESS_KEY1:na,CHANGE_ACCESS_KEY2:ia,CHANGE_ACCESS_KEY3:va,CHANGE_COR_TIME:_a,CHANGE_PARAM_CANAL:zn,CHANGE_PAR_LOCAL:oa,CHANGE_PAR_REMOTE:fa,CHANGE_TARIFF_TABLE:Aa,CHANGE_TARIFF_TBL_2:mn,CLOCK_FAULT:Qa,CLOCK_OK:ka,CMD_CHANGE_TIME:Ea,CMD_RELAY_2_OFF:Ja,CMD_RELAY_2_ON:$a,CMD_RELAY_OFF:ua,CMD_RELAY_ON:sa,CROSS_ZERO_ENT0:rn,CROSS_ZERO_ENT1:tn,CROSS_ZERO_ENT2:en,CROSS_ZERO_ENT3:an,CROSS_ZERO_EXPORT_ENT0:Pn,CROSS_ZERO_EXPORT_ENT1:Mn,CROSS_ZERO_EXPORT_ENT2:yn,CROSS_ZERO_EXPORT_ENT3:Fn,CURRENT_UNEQUAL_FAULT:Gn,CURRENT_UNEQUAL_OK:bn,EM_MAGNETIC_OFF:Bn,EM_MAGNETIC_ON:Yn,ENERGY_REGISTER_FAULT:ke,ENERGY_REGISTER_OVERFLOW:ga,ERR_ACCESS:$e,F_MAX_OK:Fa,F_MAX_OVER:wa,F_MIN_OK:Ya,F_MIN_OVER:Ba,I_MAX_OK:Ga,I_MAX_OVER:ba,MAGNETIC_OFF:ea,MAGNETIC_ON:ta,OP_PAR_FAULT:Ze,POWER_A_OFF:Za,POWER_A_ON:qa,POWER_B_OFF:Na,POWER_B_ON:Ua,POWER_C_OFF:Ia,POWER_C_ON:Sa,POWER_GOOD_DIO:Nn,POWER_OVER_RELAY_OFF:pn,POWER_SALDO_OK:Va,POWER_SALDO_OVER:xa,P_MAX_A_MINUS_OK:Jn,P_MAX_A_MINUS_OVER:ri,P_MAX_OK:Ha,P_MAX_OVER:Wa,RELAY_HARD_BAD_OFF:Sn,RELAY_HARD_BAD_ON:Dn,RELAY_HARD_OFF:Ln,RELAY_HARD_ON:In,RELAY_OFF:ha,RELAY_OFF_BAD_SALDO:Kn,RELAY_ON:Ta,RESET_EM_FLAG:Vn,RESET_MAGNET_FLAG:xn,RESTART:da,SALDO_EN_BAD:Rn,SALDO_PARAM_BAD:sn,SET_DEMAND_EN_10MIN:Qn,SET_DEMAND_EN_15MIN:Zn,SET_DEMAND_EN_1MIN:Xn,SET_DEMAND_EN_30MIN:qn,SET_DEMAND_EN_3MIN:jn,SET_DEMAND_EN_5MIN:kn,SET_DEMAND_EN_60MIN:$n,SET_NEW_SALDO:En,SET_SALDO_PARAM:Cn,SET_TARIFF_TABLE:la,SUMMER_TIME:ca,TIME_CORRECT:Tn,TIME_CORRECT_NEW:wn,T_MAX_OK:pa,T_MAX_OVER:Pa,T_MIN_OK:Ma,T_MIN_OVER:ya,VENDOR_PAR_FAULT:Qe,V_MAX_OK:Da,V_MAX_OVER:La,V_MIN_OK:ma,V_MIN_OVER:Ca,WD_RESTART:Oa,WINTER_SUMMER_BAD:cn,WINTER_TIME:Ra});var ei=wr(ti);var ai=1;var ni=2;var ii=3;var vi=4;var oi=5;var fi=6;var Ei=7;var si=8;var ui=9;var _i=10;var gi=11;var Ai=12;var li=13;var ci=14;var Ri=15;var Ti=16;var hi=17;var di=18;var Oi=19;var Ui=20;var Ni=21;var Si=22;var Ii=23;var Di=24;var Li=25;var mi=26;var Ci=28;var pi=30;var Pi=31;var Mi=Object.freeze({__proto__:null,ACTIVE_ENERGY_T1:vi,ACTIVE_ENERGY_T2:oi,ACTIVE_ENERGY_T3:fi,ACTIVE_ENERGY_T4:Ei,ACTIVE_POWER_IN_NEUTRAL:ui,ACTIVE_POWER_PER_PHASE:si,BATTERY_VOLTAGE:Si,CURRENT_BALANCE:pi,CURRENT_IN_NEUTRAL:gi,CURRENT_IN_PHASE:_i,DATE_MONTH_YEAR:ci,EXPORTED_ACTIVE_ENERGY_T1:Ti,EXPORTED_ACTIVE_ENERGY_T2:hi,EXPORTED_ACTIVE_ENERGY_T3:di,EXPORTED_ACTIVE_ENERGY_T4:Oi,HOUR_MINUTE_SECOND:li,MAGNET_INDUCTION:Ci,OPTOPORT_SPEED:Pi,POWER_FACTOR_PHASE_A:Ui,POWER_FACTOR_PHASE_B:Ni,POWER_THRESHOLD_T1:Ii,POWER_THRESHOLD_T2:Di,POWER_THRESHOLD_T3:Li,POWER_THRESHOLD_T4:mi,SET_ALL_SEGMENT_DISPLAY:ai,SOFTWARE_VERSION:ni,TOTAL_ACTIVE_ENERGY:ii,TOTAL_EXPORTED_ACTIVE_ENERGY:Ri,VOLTAGE:Ai});wr(Mi);var yi=2400;var Fi=9600;var wi={rs485orTwi:{0:Fi,2:yi,4:Fi},optoport:{0:yi,2:yi,4:Fi}};({rs485orTwi:wr(wi.rs485orTwi),optoport:wr(wi.optoport)});var Yi=1;var Bi=2;var Gi=11;var bi=7;var Hi=4;var Wi=48;var Vi=50;var xi=3+Wi*2;var zi={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_FACTOR_PHASE_A:524288,POWER_FACTOR_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var Ki={...zi,AUTO_SCREEN_SCROLLING:2147483648};var Xi={...zi,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var ji={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_1:8,RELAY_ON_TARIFF_2:16,RELAY_ON_TARIFF_3:32,RELAY_ON_TARIFF_4:64,RELAY_ON_V_GOOD:128};var ki={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_1:4,RELAY_OFF_TARIFF_2:8,RELAY_OFF_TARIFF_3:16,RELAY_OFF_TARIFF_4:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var Qi={RELAY_OFF_LIM_TARIFF_1:2,RELAY_OFF_LIM_TARIFF_2:4,RELAY_OFF_LIM_TARIFF_3:8,RELAY_OFF_LIM_TARIFF_4:16,RELAY_OFF_PF_MIN:32};var Zi={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var qi={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var $i={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var Ji={CASE_OPEN:2**0,MAGNETIC_ON:2**1,PARAMETERS_UPDATE_REMOTE:2**2,PARAMETERS_UPDATE_LOCAL:2**3,RESTART:2**4,ERROR_ACCESS:2**5,TIME_SET:2**6,TIME_CORRECT:2**7,DEVICE_FAILURE:2**8,CASE_TERMINAL_OPEN:2**9,CASE_MODULE_OPEN:2**10,TARIFF_TABLE_SET:2**11,TARIFF_TABLE_GET:2**12,PROTECTION_RESET_EM:2**13,PROTECTION_RESET_MAGNETIC:2**14};var rv={RELAY_STATE:2**0,RELAY_UBAD:2**1,RELAY_UNEQ_CURRENT:2**4,RELAY_OFF_CENTER:2**5,RELAY_IMAX:2**6,RELAY_PMAX:2**7};var tv={RELAY_COSFI:2**0,RELAY_SALDO_OFF_FLAG:2**1,RELAY_UNEQUAL_CURRENT_OFF:2**2,RELAY_BIPOLAR_POWER_OFF:2**3,RELAY_SALDO_OFF_ON_MAX_POWER:2**4,RELAY_HARD_ST1:2**5,RELAY_MAGNET_OFF:2**6,RELAY_P_MINUS_MAX_OFF:2**7};var ev={MAXVA:2**0,MINVA:2**1,MAXT:2**2,MINT:2**3,MAXF:2**4,MINF:2**5,MAXIA:2**6,MAXP:2**7};var av={MAX_POWER_SALDO:2**0,BATTERY_VBAT_BAD:2**1,CLOCK_UNSET:2**3,MIN_COS_FI:2**5};var nv={UNEQUAL_CURRENT:2**0,BIPOLAR_POWER:2**1,POWER_A_NEGATIVE:2**6,POWER_B_NEGATIVE:2**7};var iv={RELAY_OFF_LIMIT_P_MINUS_T1:8,RELAY_OFF_LIMIT_P_MINUS_T2:16,RELAY_OFF_LIMIT_P_MINUS_T3:32,RELAY_OFF_LIMIT_P_MINUS_T4:64};var vv=function(r){return{rs485orTwi:wi.rs485orTwi[kt(r,4,1)],optoport:wi.optoport[kt(r,4,5)]}};function ov(r,t,e){var a=e>>Hi;var n=new Array(Hi).fill(0);n.forEach(function(t,e){var i=!!kt(a,1,e+1);if(i){n[e]=r.getInt32()}else{n[e]=null}});return n}function fv(r){if(r===65535){return{tariff:undefined,energy:undefined}}return{tariff:r>>14&3,energy:r&16383}}var Ev=function(r){return{tariff:kt(r,2,1),isFirstHalfHour:!kt(r,1,3),hour:kt(r,5,4)}};var sv=function(r){var t=_(r.getBytes(3),{separator:""});var e=r.getUint8();var a=r.getUint8();var n=_(r.getBytes(3),{separator:""});return{manufacturer:t,type:e,year:a,serial:n}};var uv=function(r){return{isSummerTime:!!r.getUint8(),seconds:r.getUint8(),minutes:r.getUint8(),hours:r.getUint8(),day:r.getUint8(),date:r.getUint8(),month:r.getUint8(),year:r.getUint8()}};var _v=function(r){return{id:r.getUint32(),tariffSet:r.getUint8(),activateYear:r.getUint8(),activateMonth:r.getUint8(),activateDay:r.getUint8(),specialProfilesArraySize:r.getUint8(),seasonProfilesArraySize:r.getUint8(),dayProfilesArraySize:r.getUint8()}};var gv=function(r){return{monthTransitionSummer:r.getUint8(),dateTransitionSummer:r.getUint8(),hoursTransitionSummer:r.getUint8(),hoursCorrectSummer:r.getUint8(),monthTransitionWinter:r.getUint8(),dateTransitionWinter:r.getUint8(),hoursTransitionWinter:r.getUint8(),hoursCorrectWinter:r.getUint8(),isCorrectionNeeded:r.getUint8()===1}};var Av=function(r){return{month:r.getUint8(),date:r.getUint8(),dayIndexes:new Array(bi).fill(0).map(function(){return r.getUint8()})}};var lv=function(r){return{month:r.getUint8(),date:r.getUint8(),dayIndex:r.getUint8(),isPeriodic:r.getUint8()===0}};var cv=function(r){return ce(r.getBytes(9))};var Rv=function(r){var t={vpThreshold:r.getUint32(),vThreshold:r.getUint32(),ipThreshold:r.getUint32(),pmaxThreshold0:r.getUint32(),pmaxThreshold1:r.getUint32(),pmaxThreshold2:r.getUint32(),pmaxThreshold3:r.getUint32(),serialPortsSpeed:vv(r.getUint8()),tint:r.getUint8(),calcPeriodDate:r.getUint8(),timeoutDisplay:r.getUint8(),timeoutScreen:r.getUint8(),displaySet:jt(Ki,r.getUint32()),relaySet4:jt(Zi,r.getUint8()),relaySet3:jt(Qi,r.getUint8()),relaySet2:jt(ki,r.getUint8()),relaySet1:jt(ji,r.getUint8()),displayType:r.getUint8(),ten:r.getUint8(),timeoutRefresh:r.getUint16(),deltaCorMin:r.getUint8(),timeoutMagnetOff:r.getUint8(),timeoutMagnetOn:r.getUint8(),define1:jt($i,r.getUint8()),timeoutRelayOn:r.getUint8(),timeoutRelayKey:r.getUint8(),timeoutRelayAuto:r.getUint8(),timeoutBadVAVB:r.getUint8(),freqMax:r.getUint8(),freqMin:r.getUint8(),phMin:r.getUint16(),year:r.getUint8(),month:r.getUint8(),date:r.getUint8(),energyDecimalPoint:r.getUint8(),typeMeter:r.getUint8(),timeoutIMax:r.getUint8(),timeoutPMax:r.getUint8(),timeoutCos:r.getUint8(),pMaxDef:r.getUint8(),displaySetExt:jt(Xi,r.getUint32()),timeoutUneqCurrent:r.getUint8(),timeoutBipolarPower:r.getUint8(),relaySet5:jt(qi,r.getUint8()),timeCorrectPeriod:0,timeCorrectPassHalfhour:false};var e=r.getUint8();t.timeCorrectPeriod=e&127;t.timeCorrectPassHalfhour=!!(e&128);return t};var Tv=function(r){var t=r.getUint8();var e=kt(t,Hi,1);var a=ov(r,e,t);return{energyType:e,energies:a}};var hv=function(r){return new Array(Hi).fill(0).map(function(){return r.getInt32()})};var dv=function(r){return{year:r.getUint8(),month:r.getUint8(),date:r.getUint8()}};var Ov=function(r){return{coefficients:new Array(4).fill(0).map(function(){return r.getUint32()}),decimalPointTariff:r.getUint8(),indicationThreshold:r.getInt32(),relayThreshold:r.getInt32(),mode:r.getUint8(),saldoOffTimeBegin:r.getUint8(),saldoOffTimeEnd:r.getUint8(),decimalPointIndication:r.getUint8(),powerThreshold:r.getUint32(),creditThreshold:r.getInt32()}};var Uv=function(r,t){var e=new Array(t).fill(0).map(function(){return r.getUint16()});return e.map(function(r){return fv(r)})};var Nv=function(r){var t=r.getUint16();return jt(Ji,t)};var Sv=function(r){var t=r.getUint16();var e=jt(rv,r.getUint8());var a=jt(tv,r.getUint8());var n=jt(ev,r.getUint8());var i=jt(av,r.getUint8());var v=jt(nv,r.getUint8());return{uBattery:t,relayStatus:e,relayStatus2:a,status1:n,status2:i,status3:v}};var Iv=function(r){var t={hours:r.getUint8(),minutes:r.getUint8(),seconds:r.getUint8(),event:r.getUint8()};var e=t.event;var a=r.bytesLeft;t.eventName=ei[e];switch(e){case pn:if(a<4){return t}t.power=[r.getUint8(),r.getUint8(),r.getUint8(),r.getUint8()];break;case Ea:case Tn:if(a<8){return t}t.newDate=uv(r);break}return t};var Dv=function(r){var t=r.getUint8();var e=r.getUint8();return{date:{year:t>>1,month:t<<3&15|e>>5,date:e&31},demandType:r.getUint8(),firstIndex:r.getUint16(),count:r.getUint8(),period:r.getUint8()}};var Lv=function(r){var t=r.getUint8();var e=r.getUint8();var a=r.getUint8();return{channelParam1:t,counterInterval:e,channelParam2:a}};var mv=function(r){var t=dv(r);var e=new Array(Hi).fill(0).map(function(){return{hours:r.getUint8(),minutes:r.getUint8(),power:r.getUint32()}});return{date:t,power:e}};var Cv=function(r){return{pmaxMinusThreshold0:r.getUint32(),pmaxMinusThreshold1:r.getUint32(),pmaxMinusThreshold2:r.getUint32(),pmaxMinusThreshold3:r.getUint32(),relaySet:jt(iv,r.getUint8())}};var pv=function(r){return new Array(Hi).fill(0).map(function(){return{date:r.getUint8(),hours:r.getUint8(),minutes:r.getUint8(),power:r.getUint32()}})};var Pv=nr;var Mv=function(r){var t=new Ht(r,false);return gv(t)};var yv=ir;var Fv=9;var wv=function(r){if(r.length!==Fv){throw new Error("Wrong buffer size: ".concat(r.length,"."))}var t=o(r,9),e=t[0],a=t[1],n=t[2],i=t[3],v=t[4],f=t[5],E=t[6],s=t[7],u=t[8];return{event:e,name:je[e],index:a,date:{year:n,month:i,date:v,hours:f,minutes:E,seconds:s},count:u}};var Yv=J;var Bv={calibrationEnable:1,hardkey:2,keyPressTest:4,keyOpenkeyTest:8,keyGerkonTest:16,keyOpenKlemaTest:32,keyOpenModuleTest:64,keyPress2Test:128};var Gv=function(r){var t=new Ht(r,false);var e=t.getUint32();var a=t.getUint32();var n=t.getUint32();var i=t.getUint32();t.getUint32();var v=t.getUint32();var o=jt(rv,t.getUint8());var f=t.getUint8();var E=t.getUint8();var s=jt(Bv,t.getUint8());var u={"A+":t.getUint8(),"A-":t.getUint8()};var _=!!(t.getUint8()&1);var g=f|E<<8;return{operatingSeconds:e,tbadVAVB:a,tbadImaxAll:n,tbadPmaxAll:i,tbadFREQ:v,relayStatus:o,statusEvent:jt(Ji,g),calibrationFlags:s,currentTariffs:u,isSummerTime:_}};var bv=I;var Hv=function(r){var t=new Ht(r,false);return{powerA:t.getInt32(),iaRms:t.getInt32(),vavbRms:t.getInt32(),varA:t.getInt32(),pfA:t.getInt16()/1e3,ibRms:t.getInt32(),powerB:t.getInt32(),varB:t.getInt32(),pfB:t.getInt16()/1e3}};var Wv=U;var Vv=function(r){var t=new Ht(r,false);return uv(t)};var xv=19;var zv=y;var Kv=function(r){var t=new Ht(r,false);var e;if(r.length===xv){e={date:dv(t),energies:hv(t)}}else{e={date:dv(t),...Tv(t)}}return e};var Xv=19;var jv=Er;var kv=function(r){var t=new Ht(r,false);var e;if(r.length===Xv){e={date:dv(t),energies:hv(t)}}else{e={date:dv(t),...Tv(t)}}return e};var Qv=4;var Zv=["A+","A+R+","A+R-","A-","A-R+","A-R-"];var qv=4294967295;var $v={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var Jv=function(r){return r<Qv?1<<r:0};var ro=function(r){return r<Qv?1<<r<<4:0};var to=function(r){var t=r.getUint8();var e=r.getUint8();return{year:t>>1,month:t<<3&15|e>>5,date:e&31}};var eo=function(r){var t=r.getUint8();return jt($v,t)};var ao=function(r,t){var e=[];for(var a=0;a<t;a++){var n=r.getUint16();var i=n>>14&3;var v=n&16383;e.push(n===qv?undefined:{tariff:i,energy:v})}return e};var no=function(r,t,e){var a={};Zv.forEach(function(n){if(t[n]){a[n]=ao(r,e)}});return a};var io=function(r,t){var e={};if(t&$v["A+"]){e["A+"]=r.getUint32()}if(t&$v["A+R+"]){e["A+R+"]=r.getUint32()}if(t&$v["A+R-"]){e["A+R-"]=r.getUint32()}return e};var vo=function(r,t){var e={};if(t&$v["A-"]){e["A-"]=r.getUint32()}if(t&$v["A-R+"]){e["A-R+"]=r.getUint32()}if(t&$v["A-R-"]){e["A-R-"]=r.getUint32()}return e};var oo=function(r){var t=r.getUint8();var e=r.getUint8();var a=new Array(Qv).fill(null);for(var n=0;n<Qv;n++){if(e&Jv(n)){a[n]=io(r,t)}}for(var i=0;i<Qv;i++){if(e&ro(i)){a[i]={...a[i],...vo(r,t)}}}return a};var fo=function(r){return{hours:r.getUint8(),minutes:r.getUint8(),power:r.getUint32()}};var Eo=function(r,t){var e={};if(t&$v["A+"]){e["A+"]=fo(r)}if(t&$v["A+R+"]){e["A+R+"]=fo(r)}if(t&$v["A+R-"]){e["A+R-"]=fo(r)}return e};var so=function(r,t){var e={};if(t&$v["A-"]){e["A-"]=fo(r)}if(t&$v["A-R+"]){e["A-R+"]=fo(r)}if(t&$v["A-R-"]){e["A-R-"]=fo(r)}return e};var uo=function(r){var t=r.getUint8();var e=r.getUint8();var a=new Array(Qv).fill(null);for(var n=0;n<Qv;n++){if(e&Jv(n)){a[n]=Eo(r,t)}}for(var i=0;i<Qv;i++){if(e&ro(i)){a[i]={...a[i],...so(r,t)}}}return a};var _o=pr;var go=function(r){var t=new Ht(r,false);return{date:to(t),energies:oo(t)}};var Ao=j;var lo=function(r){var t=new Ht(r,false);return mv(t)};var co=gr;var Ro=function(r){var t=new Ht(r,false);return mv(t)};var To=or;var ho=function(r){var t=new Ht(r,false);return mv(t)};var Oo=Pr;var Uo=function(r){var t=new Ht(r,false);return{date:to(t),tariffs:uo(t)}};var No=255;var So=tr;var Io=function(r){var t=r.indexOf(No);var e=t===-1?r:r.slice(0,t);return{periods:E(e).map(Ev)}};var Do=7;var Lo=25;var mo=function(r,t,e){return Math.trunc((r*60+t)/e)};var Co=function(r){return mo(Lo,0,r)};var po=function(r,t,e){if(r===65535){return null}var a=Co(e);if(t===a){return{lastSummerHour:r>>8&255}}return e===60?{energy:r}:{tariff:r>>14&3,energy:r&16383}};var Po=function(r,t){var e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:30;return r.reduce(function(r,a,n){r.push(po(a,(t??0)+n,e));return r},[])};var Mo=function(r,t,e){if(r===65535){return 65535}var a=Co(e);return t===a?{lastSummerHour:r>>8&255}:{voltage:r}};var yo=function(r,t){var e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:30;return r.reduce(function(r,a,n){r.push(Mo(a,(t??0)+n,e));return r},[])};var Fo=Lr;var wo=function(r){if(!r||r.length<Do){throw new Error("Invalid uplink GetDemand byte length.")}var t=new Ht(r,false);var e=Dv(t);if(r.length!==Do+2*e.count){throw new Error("Invalid uplink GetDemand demands byte length.")}var a=new Array(e.count).fill(0).map(function(){return t.getUint16()});var n=e.demandType===Yi||e.demandType===Bi;e.demands=n?Po(a,e.firstIndex,e.period):yo(a,e.firstIndex,e.period);return e};var Yo=function(r,t,e){if(!r){throw new Error("Command name is required.")}if(t&&!Array.isArray(t)){throw new Error("Invalid payload for ".concat(r,". Expected array, got: ").concat(typeof t,"."))}if(t.length!==e){var a=_(t,{separator:""});throw new Error("Wrong buffer size for ".concat(r,": ").concat(t.length,". Expected: ").concat(e,". Payload: 0x").concat(a,"."))}};var Bo=Dr;var Go=Yr[Dr];var bo=4;var Ho=function(r){Yo(Go,r,bo);var t=new Ht(r,false);return Lv(t)};var Wo=O;var Vo=function(r){var t=new Ht(r,false);return sv(t)};var xo=d;var zo=function(r){var t=new Ht(r,false);return cv(t)};var Ko=Tr;var Xo=function(t){var e=f(t),a=e[0],n=r(e).slice(1);return{displayMode:a,order:n}};var jo=16;var ko=D;var Qo=function(r){var t=new Ht(r,false);var e;if(r.length===jo){e={energies:hv(t)}}else{e=Tv(t)}return e};var Zo=19;var qo=h;var $o=function(r){var t=new Ht(r,false);var e;if(r.length===Zo){e={date:dv(t),energies:hv(t)}}else{e={date:dv(t),...Tv(t)}}return e};var Jo=16;var rf=lr;var tf=function(r){var t=new Ht(r,false);var e;if(r.length===Jo){e={energies:hv(t)}}else{e=Tv(t)}return e};var ef=19;var af=sr;var nf=function(r){var t=new Ht(r,false);var e;if(r.length===ef){e={date:dv(t),energies:hv(t)}}else{e={date:dv(t),...Tv(t)}}return e};var vf=3+1;var of=4;var ff=Q;var Ef=vf+255*of;var sf=function(r){return function(t){if(t.length>Ef){throw new Error("Wrong buffer size: ".concat(t.length,"."))}var e=new r(t,false);var a=dv(e);var n=e.getUint8();var i=[];while(!e.isEmpty){i.push(Iv(e))}return{date:a,eventsNumber:n,events:i}}};var uf=sf(Ht);var _f=14;var gf=20;var Af=Z;var lf=function(r){if(r.length!==_f&&r.length!==gf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}var t=new Ht(r,false);var e=t.getUint16();var a=t.getUint16();var n=t.getUint16();var i=t.getUint16();var v=t.getUint16();var o=t.getUint16();var f=t.getUint16();return{accessClosed:o,accessError:v,localParametersChange:n,remoteParametersChange:i,powerOff:a,restart:e,setClock:f}};var cf=T;var Rf=function(r){var t=new Ht(r,true);return Nv(t)};var Tf=rr;var hf=function(r){var t=new Ht(r,false);return{temperature:t.getInt16(),frequency:t.getInt16()}};var df=z;var Of=function(r){var t=new Ht(r,false);return Sv(t)};var Uf=M;var Nf=function(r){var t=new Ht(r,false);var e=r.length>xi;var a=dv(t);var n=Uv(t,e?Vi:Wi);if(e){return{date:a,periods:n,dstHour:t.getUint8()}}return{date:a,periods:n}};var Sf=_r;var If=function(r){var t=new Ht(r,false);var e=r.length>xi;var a=dv(t);var n=Uv(t,e?Vi:Wi);if(e){return{date:a,periods:n,dstHour:t.getUint8()}}return{date:a,periods:n}};var Df=fr;var Lf=function(r){var t=new Ht(r,false);var e=r.length>xi;var a=dv(t);var n=Uv(t,e?Vi:Wi);if(e){return{date:a,periods:n,dstHour:t.getUint8()}}return{date:a,periods:n}};var mf=Or;var Cf=function(r){var t=new Ht(r,false);var e=to(t);var a=eo(t);var n=t.getUint8();var i=t.getUint8();return{date:e,firstHalfhour:n,halfhoursNumber:i,energies:no(t,a,i)}};var pf=dr;var Pf=function(r){var t=new Ht(r,false);return{induction:t.getUint16(),threshold:t.getUint16(),inductionCoefficient:t.getUint16()/100,reserved:t.getUint32()}};var Mf=mr;var yf=function(r){var t=o(r,1),e=t[0];return{ten:e}};var Ff=F;var wf=function(r){var t=new Ht(r,false);return{year:t.getUint8(),month:t.getUint8(),energies:hv(t)}};var Yf=ur;var Bf=function(r){var t=new Ht(r,false);return{year:t.getUint8(),month:t.getUint8(),energies:hv(t)}};var Gf=k;var bf=function(r){var t=new Ht(r,false);return{year:t.getUint8(),month:t.getUint8(),tariffs:pv(t)}};var Hf=Ar;var Wf=function(r){var t=new Ht(r,false);return{year:t.getUint8(),month:t.getUint8(),tariffs:pv(t)}};var Vf=G;var xf=function(r){var t=new Ht(r,false);return Rv(t)};var zf=Nr;var Kf=function(r){var t=new Ht(r,false);return Cv(t)};var Xf=x;var jf=1+Gi*2;var kf=function(r){if(r.length!==jf){throw new Error("Invalid getRatePlanInfo data size.")}var t=new Ht(r,false);return{tariffTable:t.getUint8(),activePlan:_v(t),passivePlan:_v(t)}};var Qf=W;var Zf=29;var qf=function(r){if(r.length!==Zf){throw new Error("Invalid getSaldo data size.")}var t=new Ht(r,false);return{currentSaldo:t.getInt32(),count:t.getUint8(),energy:new Array(4).fill(0).map(function(){return t.getInt32()}),beginSaldoOfPeriod:t.getInt32(),date:{month:t.getUint8(),date:t.getUint8(),hours:t.getUint8(),minutes:t.getUint8()}}};var $f=K;var Jf=37;var rE=function(r){if(r.length!==Jf){throw new Error("Invalid getSaldoParameters data size.")}var t=new Ht(r,false);return Ov(t)};var tE=er;var eE=function(r){var t=new Ht(r,false);return Av(t)};var aE=ar;var nE=function(r){var t=new Ht(r,false);return lv(t)};var iE=H;var vE=function(r){return{version:String.fromCharCode.apply(null,E(r))}};var oE=P;var fE=0;var EE=function(r){if(r.length!==fE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var sE=q;var uE=0;var _E=function(r){if(r.length!==uE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var gE=$;var AE=0;var lE=function(r){if(r.length!==AE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var cE=vr;var RE=0;var TE=function(r){if(r.length!==RE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var hE=S;var dE=0;var OE=function(r){if(r.length!==dE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var UE=cr;var NE=0;var SE=function(r){if(r.length!==NE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var IE=B;var DE=0;var LE=function(r){if(r.length!==DE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var mE=N;var CE=0;var pE=function(r){if(r.length!==CE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var PE=L;var ME=0;var yE=function(r){if(r.length!==ME){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var FE=Ir;var wE=Yr[Ir];var YE=0;var BE=function(r){Yo(wE,r,YE);return{}};var GE=Rr;var bE=0;var HE=function(r){if(r.length!==bE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var WE=b;var VE=0;var xE=function(r){if(r.length!==VE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var zE=Sr;var KE=0;var XE=function(r){if(r.length!==KE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var jE=V;var kE=0;var QE=function(r){if(r.length!==kE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var ZE=X;var qE=0;var $E=function(r){if(r.length!==qE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var JE=m;var rs=0;var ts=function(r){if(r.length!==rs){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var es=C;var as=0;var ns=function(r){if(r.length!==as){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var is=hr;var vs=function(r){var t=new Ht(r,false);var e=t.getUint8();var a=!!(e&1);var n=!!(e&2);return{electroMagneticIndication:a,magneticIndication:n}};var os=Y;var fs=0;var Es=function(r){if(r.length!==fs){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var ss=w;var us=0;var _s=function(r){if(r.length!==us){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var gs={encrypt:function(){},decrypt:function(){}};var As=function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var e=t;r.forEach(function(r){e^=r});return e};var ls=2;var cs=2;var Rs=function(r){var t=o(r,1),e=t[0];if(e===gt){try{var a=ct(r.slice(ls));return{id:e,name:At,headerSize:ls,bytes:r,parameters:a}}catch{return null}}return null};var Ts=function(r,t){var e=o(t,1),a=e[0];var n=Rs(t.slice(cs-1));var i=Rs(t.slice(cs));var v={messageId:a,bytes:t};if(n){return{...v,accessLevel:g,commands:[n]}}if(i){return{...v,accessLevel:r,commands:[i]}}return null};var hs=3;var ds=2;var Os=2;var Us=function(r,t){return function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=a?.aesKey;var i=[];var v=o(e,2),f=v[0],s=v[1];var u=s&hs;var _=Ts(u,e);var A={messageId:f,accessLevel:u,commands:i,bytes:e,lrc:{received:undefined,calculated:0}};var l=e.slice(ds);var c;if(_){return _}if(n&&u!==g){l=E(gs.decrypt(n,l))}var R=l[l.length-1];l=l.slice(0,-1);var T=As(l);if(u!==g||R!==0){if(R!==T){c="Mismatch LRC."}}var h=l[0]&hs;var d=l.slice(1);if(u!==h){c="Mismatch access levels."}var O=0;do{var U=d[O];var N=d[O+1];var S=Os+N;var I=d.slice(O+Os,O+S);var D={id:U,name:t[U],headerSize:Os,bytes:d.slice(O,O+S)};if(!U){break}try{if(!r[U]){throw new Error("Unsupported command id: ".concat(U,"!"))}D.parameters=r[U](I,a);i.push(D)}catch(r){i.push({command:D,error:r.message})}O+=S}while(O<=d.length);A.lrc.calculated=T;A.lrc.received=R;if(c){return{message:A,error:c}}return A}};var Ns={};var Ss=Yr;var Is=Us(Ns,Ss);Ns[Br]=br;Ns[gt]=ct;Ns[Wt]=xt;Ns[zt]=Xt;Ns[Pv]=Mv;Ns[yv]=wv;Ns[Yv]=Gv;Ns[bv]=Hv;Ns[Wv]=Vv;Ns[zv]=Kv;Ns[jv]=kv;Ns[_o]=go;Ns[Ao]=lo;Ns[co]=Ro;Ns[To]=ho;Ns[Oo]=Uo;Ns[So]=Io;Ns[Fo]=wo;Ns[Bo]=Ho;Ns[Wo]=Vo;Ns[xo]=zo;Ns[Ko]=Xo;Ns[ko]=Qo;Ns[qo]=$o;Ns[rf]=tf;Ns[af]=nf;Ns[ff]=uf;Ns[Af]=lf;Ns[cf]=Rf;Ns[Tf]=hf;Ns[df]=Of;Ns[Uf]=Nf;Ns[Sf]=If;Ns[Df]=Lf;Ns[mf]=Cf;Ns[pf]=Pf;Ns[Mf]=yf;Ns[Ff]=wf;Ns[Yf]=Bf;Ns[Gf]=bf;Ns[Hf]=Wf;Ns[Vf]=xf;Ns[zf]=Kf;Ns[Xf]=kf;Ns[Qf]=qf;Ns[$f]=rE;Ns[tE]=eE;Ns[aE]=nE;Ns[iE]=vE;Ns[oE]=EE;Ns[sE]=_E;Ns[gE]=lE;Ns[cE]=TE;Ns[hE]=OE;Ns[UE]=SE;Ns[IE]=LE;Ns[mE]=pE;Ns[PE]=yE;Ns[FE]=BE;Ns[GE]=HE;Ns[WE]=xE;Ns[zE]=XE;Ns[jE]=QE;Ns[ZE]=$E;Ns[JE]=ts;Ns[es]=ns;Ns[is]=vs;Ns[os]=Es;Ns[ss]=_s;var Ds=145;var Ls=30;var ms=function(r){if(r[0]!==Ls){return{}}var t=r[1];var e=r[3];var a=r.slice(4,t+2);if(e===Ds){return a}return null};fromBytes=Is;getDataSegment=ms})();
//#endregion


/*
  Incoming arguments:
    * payload - array of bytes
    * metadata - key/value object
*/

var segment = getDataSegment(payload);
var message = null;

// just a single data segment
if ( segment ) {
    message = fromBytes(segment);

    // there may be a message.error (e.g. mismatched LRC)
    // in that case message.message will contain everything parsed successfully
    // it should be used with caution
}

var result = {
    // required property, set to real device name from payload/metadata depending on integration
    // empty value throw an error in converter
    deviceName: '',

    deviceType: 'Water Meter',
    attributes: {
        model: 'Device Model',
        serialNumber: 'SN111',
        manufacturer: 'Device Manufacturer'
    },
    telemetry: {
        // telemetry display only primitive, i.e. string and numbers
        // for example only!
        message: JSON.stringify(message.message || message)
    },
    metadata: metadata
};

return result;
