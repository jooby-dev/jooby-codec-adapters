// IMPORTANT!!!
// This example only for default uplink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/


//#region [autogenerated jooby-codec bundle from index.js]
var fromBytes,getDataSegment;(function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(t){if(Array.isArray(t))return t}function r(e){if(Array.isArray(e))return t(e)}function n(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function i(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,s,o=[],v=true,f=false;try{if(a=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;v=!1}else for(;!(v=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);v=!0);}catch(t){f=true,i=t}finally{try{if(!v&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(f)throw i}}return o}}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,r){return e(t)||i(t,r)||u(t,r)||a()}function v(t){return e(t)||n(t)||u(t)||a()}function f(t){return r(t)||n(t)||u(t)||s()}function u(e,r){if(e){if("string"==typeof e)return t(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}var h=function(t){var e=t.trim();if(!e){return[]}e=e.replace(/0x/g,"").split(/\s+/).map((function(t){return t.padStart(2,"0")})).join("");if(e.length%2!==0){e="0".concat(e)}var r=e.length/2;var n=new Array(r);for(var i=0;i<r;i++){n[i]=parseInt(e.substring(i*2,i*2+2),16)}return n};var E={separator:" ",prefix:""};var g=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=Object.assign({},E,e),n=r.separator,i=r.prefix;return t.map((function(t){return"".concat(i).concat(t.toString(16).padStart(2,"0"))})).join(n)};var _=0;var l=1;var c=3;var d=4;var A=5;var T=7;var p=8;var R=9;var U=13;var y=15;var O=16;var m=17;var P=18;var S=19;var D=20;var M=21;var I=22;var N=23;var C=24;var L=25;var w=28;var F=30;var x=31;var Y=40;var B=41;var H=42;var W=44;var b=45;var G=46;var V=47;var z=49;var K=50;var X=51;var k=52;var j=53;var Q=54;var q=57;var Z=58;var $=59;var J=60;var tt=61;var et=62;var rt=65;var nt=70;var it=74;var at=75;var st=79;var ot=80;var vt=82;var ft=83;var ut=88;var ht=89;var Et=91;var gt=92;var _t=93;var lt=94;var ct=100;var dt=109;var At=111;var Tt=112;var pt=113;var Rt=114;var Ut=118;var yt=122;var Ot=Object.freeze({__proto__:null,activateRatePlan:S,getBuildVersion:Tt,getCorrectTime:et,getCriticalEvent:rt,getCurrentStatusMeter:q,getCurrentValues:U,getDateTime:T,getDayDemand:I,getDayDemandExport:st,getDayMaxDemand:z,getDayMaxDemandExport:ut,getDayMaxDemandPrevious:it,getDayProfile:$,getDemand:Ut,getDeviceId:A,getDeviceType:d,getDisplayParam:lt,getEnergy:y,getEnergyDayPrevious:c,getEnergyExport:Et,getEnergyExportDayPrevious:ot,getEventStatus:l,getEvents:X,getEventsCounters:k,getExtendedCurrentValues:Z,getExtendedCurrentValues2:b,getHalfHourDemand:M,getHalfHourDemandExport:ft,getHalfHourDemandPrevious:at,getHalfhoursEnergies:At,getMagneticFieldThreshold:dt,getMeterInfo:yt,getMonthDemand:N,getMonthDemandExport:vt,getMonthMaxDemand:K,getMonthMaxDemandExport:ht,getOperatorParameters:F,getOperatorParametersExtended3:pt,getRatePlanInfo:W,getSaldo:B,getSaldoParameters:G,getSeasonProfile:J,getSpecialDay:tt,getVersion:Y,prepareRatePlan:D,resetPowerMaxDay:j,resetPowerMaxMonth:Q,runTariffPlan:nt,setAccessKey:R,setCorrectDateTime:gt,setCorrectTime:w,setDateTime:p,setDayProfile:O,setDisplayParam:_t,setOperatorParameters:x,setOperatorParametersExtended3:Rt,setSaldo:H,setSaldoParameters:V,setSeasonProfile:m,setSpecialDay:P,setSpecialOperation:ct,turnRelayOff:L,turnRelayOn:C});var mt=120;var Pt=121;var St=254;var Dt=Object.freeze({__proto__:null,activateRatePlan:S,errorResponse:St,getBuildVersion:Tt,getCorrectTime:et,getCriticalEvent:rt,getCurrentStatusMeter:q,getCurrentValues:U,getDateTime:T,getDayDemand:I,getDayDemandExport:st,getDayEnergies:mt,getDayMaxDemand:z,getDayMaxDemandExport:ut,getDayMaxDemandPrevious:it,getDayMaxPower:Pt,getDayProfile:$,getDemand:Ut,getDeviceId:A,getDeviceType:d,getDisplayParam:lt,getEnergy:y,getEnergyDayPrevious:c,getEnergyExport:Et,getEnergyExportDayPrevious:ot,getEventStatus:l,getEvents:X,getEventsCounters:k,getExtendedCurrentValues:Z,getExtendedCurrentValues2:b,getHalfHourDemand:M,getHalfHourDemandExport:ft,getHalfHourDemandPrevious:at,getHalfhoursEnergies:At,getMagneticFieldThreshold:dt,getMeterInfo:yt,getMonthDemand:N,getMonthDemandExport:vt,getMonthMaxDemand:K,getMonthMaxDemandExport:ht,getOperatorParameters:F,getOperatorParametersExtended3:pt,getRatePlanInfo:W,getSaldo:B,getSaldoParameters:G,getSeasonProfile:J,getSpecialDay:tt,getVersion:Y,prepareRatePlan:D,resetPowerMaxDay:j,resetPowerMaxMonth:Q,runTariffPlan:nt,setAccessKey:R,setCorrectDateTime:gt,setCorrectTime:w,setDateTime:p,setDayProfile:O,setDisplayParam:_t,setOperatorParameters:x,setOperatorParametersExtended3:Rt,setSaldo:H,setSaldoParameters:V,setSeasonProfile:m,setSpecialDay:P,setSpecialOperation:ct,turnRelayOff:L,turnRelayOn:C});var Mt=function(t){var e={};for(var r in t){var n=t[r];e[n]=r}return e};var It=Mt(Dt);var Nt=S;var Ct=0;var Lt=function(t){if(t.length!==Ct){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var wt=1;var Ft=2;var xt=3;var Yt=4;var Bt=Math.log,Ht=Math.pow,Wt=Math.LN2;var bt=function(t,e,r,n,i){var a,s,o=i*8-n-1,v=(1<<o)-1,f=v>>1,u=-7,h=r?i-1:0,E=r?-1:1,g=t[e+h];h+=E;a=g&(1<<-u)-1;g>>=-u;u+=o;for(;u>0;a=a*256+t[e+h],h+=E,u-=8);s=a&(1<<-u)-1;a>>=-u;u+=n;for(;u>0;s=s*256+t[e+h],h+=E,u-=8);if(a===0){a=1-f}else if(a===v){return s?NaN:g?-Infinity:Infinity}else{s=s+Ht(2,n);a=a-f}return(g?-1:1)*s*Ht(2,a-n)};var Gt=function(t,e,r,n,i,a){var s,o,v,f=a*8-i-1,u=(1<<f)-1,h=u>>1,E=i===23?Ht(2,-24)-Ht(2,-77):0,g=n?0:a-1,_=n?1:-1,l=r<0||r===0&&1/r<0?1:0;r<0&&(r=-r);if(r!==r||r===Infinity){o=r!==r?1:0;s=u}else{s=Bt(r)/Wt|0;if(r*(v=Ht(2,-s))<1){s--;v*=2}if(s+h>=1){r+=E/v}else{r+=E*Ht(2,1-h)}if(r*v>=2){s++;v/=2}if(s+h>=u){o=0;s=u}else if(s+h>=1){o=(r*v-1)*Ht(2,i);s=s+h}else{o=r*Ht(2,h-1)*Ht(2,i);s=0}}for(;i>=8;t[e+g]=o&255,g+=_,o/=256,i-=8);s=s<<i|o;f+=i;for(;f>0;t[e+g]=s&255,g+=_,s/=256,f-=8);t[e+g-_]|=l*128};var Vt=[1,0];var zt=[2,1,0];var Kt=[3,2,1,0];var Xt=[0,1];var kt=[0,1,2];var jt=[0,1,2,3];var Qt=function(t,e){return t[e]};var qt=function(t,e,r){var n=r?Xt:Vt;var i=t[e+n[0]];var a=t[e+n[1]]<<8;return i|a};var Zt=function(t,e,r){var n=r?kt:zt;var i=t[e+n[0]];var a=t[e+n[1]]<<8;var s=t[e+n[2]]<<16;return i|a|s};var $t=function(t,e,r){var n=r?jt:Kt;var i=t[e+n[3]]*16777216;var a=t[e+n[2]]*65536;var s=t[e+n[1]]*256;var o=t[e+n[0]];return i+a+s+o};var Jt=function(t,e,r){t[e]=r&255};var te=function(t,e,r,n){var i=n?Xt:Vt;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255};var ee=function(t,e,r,n){var i=n?kt:zt;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255;t[e+i[2]]=r>>>16&255};var re=function(t,e,r,n){var i=n?jt:Kt;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255;t[e+i[2]]=r>>>16&255;t[e+i[3]]=r>>>24&255};function ne(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof t==="number"){var r=new Array(t).fill(0);this.data=r}else{this.data=t}this.offset=0;this.isLittleEndian=e}ne.prototype={toUint8Array:function(){return this.data},seek:function(t){if(t<0||t>=this.data.length){throw new Error("Invalid position.")}this.offset=t},setInt8:function(t){Jt(this.data,this.offset,t<0?t|256:t);this.offset+=wt},getInt8:function(){var t=Qt(this.data,this.offset);this.offset+=wt;return t&128?t^-256:t},setUint8:function(t){Jt(this.data,this.offset,t);this.offset+=wt},getUint8:function(){var t=Qt(this.data,this.offset);this.offset+=wt;return t},setInt16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;te(this.data,this.offset,t<0?t|65536:t,e);this.offset+=Ft},getInt16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=qt(this.data,this.offset,t);this.offset+=Ft;return e&32768?e^-65536:e},setUint16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;te(this.data,this.offset,t,e);this.offset+=Ft},getUint16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=qt(this.data,this.offset,t);this.offset+=Ft;return e},setInt24:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;ee(this.data,this.offset,t<0?t|16777216:t,e);this.offset+=xt},getInt24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=Zt(this.data,this.offset,t);this.offset+=xt;return e&8388608?e^-16777216:e},setUint24:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;ee(this.data,this.offset,t,e);this.offset+=xt},getUint24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=Zt(this.data,this.offset,t);this.offset+=xt;return e},setInt32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;re(this.data,this.offset,t<0?t|4294967296:t,e);this.offset+=Yt},getInt32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=$t(this.data,this.offset,t);this.offset+=Yt;return e&2147483648?e^-4294967296:e},setUint32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;re(this.data,this.offset,t,e);this.offset+=Yt},getUint32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=$t(this.data,this.offset,t);this.offset+=Yt;return e},setFloat32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Gt(this.data,this.offset,t,e,23,4);this.offset+=Yt},getFloat32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=bt(this.data,this.offset,t,23,4);this.offset+=Yt;return e},setString:function(t){this.setUint8(t.length);for(var e=0;e<t.length;++e){this.setUint8(t.charCodeAt(e))}},getString:function(){var t=this.getUint8();var e=this.offset+t;var r=[];while(this.offset<e){r.push(String.fromCharCode(this.getUint8()))}return r.join("")},getBytesToOffset:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,t)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=e+t;return this.data.slice(e,this.offset)},setBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var r=this.data;r.splice.apply(r,[e,t.length].concat(f(t)));this.data=r;this.offset=e+t.length}};Object.defineProperties(ne.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var ie=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=0;for(var n in e){if(n in t&&e[n]){r|=t[n]}}return r};var ae=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r={};for(var n in t){r[n]=(e&t[n])!==0}return r};var se=function(t,e,r){return(1<<e)-1&t>>r-1};var oe=function(t,e,r,n){var i=(1<<e)-1<<r-1;var a=n;var s=t;s&=~i;a<<=r-1;s|=a;return s};var ve="x";var fe=[".","1","3","R","M"];var ue=[".","A","G","R","T","D"];var he=[".","0","1","2","3","4","5"];var Ee=[".","A","B","C","D","E","F"];var ge=[".","A","B","C","D","E","F","H","K","G"];var _e=[".","1","2","3","4"];var le=[".","L","M","Z","K"];var ce=[".","0","1","2","3","4","5","6","7","8","9"];var de=[".","D","B","C","E","P","R","O","L","F","S","M","Y","G","N","U"];var Ae=[".","0","1","2","3","4","5","6","P","R","L","E","G","-","/"];var Te=[".","H","A","T","0","0","0","0","0","1","2","3","4","0","0","0"];var pe=[".","0","1","2","3","4","5","6","7","8","I","X","G","W","M","-"];var Re={typeMeterG:1<<0,downgradedToA:1<<4,supportMeterInfo:1<<6};var Ue={typeMeterTransformer:1<<0,downgradedToR:1<<3,typeMeterG:1<<4,supportMeterInfo:1<<6,reactiveRPlusRMinus:1<<7};var ye=function(t){return[t>>4,t&15]};var Oe=function(t){var e=new Array(t.length*2).fill(0);t.forEach((function(t,r){var n=ye(t),i=o(n,2),a=i[0],s=i[1];e[r*2]=a;e[r*2+1]=s}));return e};var me=function(t){var e=[];t.forEach((function(t){return e.push(t.toString(16))}));if(t.length&1){e.push("0")}return h(e.join(""))};var Pe=function(t){if(t.length!==14&&t.length!==16){throw new Error("Device type bytes wrong size")}var e=["MTX "];e.push(fe[t[0]]??ve);e.push(ue[t[1]]??ve);e.push(he[t[2]]??ve);e.push(he[t[3]]??ve);e.push(".");e.push(Ee[t[4]]??ve);e.push(ge[t[5]]??ve);e.push(".");e.push(_e[t[6]]??ve);e.push(le[t[7]]??ve);var r=t[8];e.push(ce[t[9]]??ve);e.push("-");var n;if(t.length<14||t[12]===0&&t[13]===0){e.push(de[t[10]]??ve);n=11}else if(t[13]===0){e.push(de[t[10]]??ve);e.push(de[t[11]]??ve);n=12}else{e.push(de[t[10]]??ve);e.push(de[t[11]]??ve);e.push(de[t[12]]??ve);n=13}var i=t[n];if(i&&i!==0){e.push(Te[i]??ve)}return{type:e.join(""),revision:r}};var Se=function(t,e,r){var n=[];if(t.length<11){throw new Error("Wrong format")}n.push(fe.indexOf(t[0]));n.push(ue.indexOf(t[1]));n.push(he.indexOf(t[2]));n.push(he.indexOf(t[3]));if(t[4]!=="."){throw new Error("Wrong format")}n.push(Ee.indexOf(t[5]));n.push(ge.indexOf(t[6]));if(t[7]!=="."){throw new Error("Wrong format")}n.push(_e.indexOf(t[8]));n.push(le.indexOf(t[9]));n.push(r??0);n.push(ce.indexOf(t[10]));if(t[11]!=="-"){throw new Error("Wrong format")}var i=t.length>13?t.length-1:t.length;for(var a=12;a<i;a++){n.push(de.indexOf(t[a]))}if(i<t.length){n.push(Te.indexOf(t[i]))}var s=me(n);var o=new Array(9).fill(0);o[0]=0;for(var v=0;v<s.length;v++){o[v+(s.length<8?1:0)]=s[v]}return o};var De=function(t){if(t.length<14){throw new Error("The buffer is too small")}var e=["MTX "];var r=t[1]===5?"-":" ";e.push(fe[t[0]]??ve);e.push(ue[t[1]]??ve);e.push(r);for(var n=2;n<t.length;n++){if(t[n]!==0){e.push(Ae[t[n]]??ve)}}return{type:e.join("")}};var Me=function(t){if(t.length<3){throw new Error("Wrong format")}var e=[];e.push(fe.indexOf(t[0]));e.push(ue.indexOf(t[1]));for(var r=3;r<t.length;r++){e.push(Ae.indexOf(t[r]))}var n=me(e);if(n.length===8){return n}if(n.length>8){throw new Error("Wrong format")}var i=new Array(8).fill(0);for(var a=0;a<n.length;a++){i[a]=n[a]}return i};var Ie=function(t){if(t.length<14){throw new Error("The buffer is too small")}var e=[];e.push(fe[t[0]]??ve);for(var r=1;r<t.length;r++){if(t[r]!==0){e.push(pe[t[r]]??ve)}}return{type:e.join("")}};var Ne=function(t){if(t.length<1){throw new Error("Wrong format")}var e=[];e.push(fe.indexOf(t[0]));for(var r=1;r<t.length;r++){e.push(pe.indexOf(t[r]))}var n=me(e);var i=new Array(8).fill(0);for(var a=0;a<n.length&&a<8;a++){i[a]=n[a]}return i};var Ce=function(t){if(t.length!==9){throw new Error("The buffer is too small")}var e;var r=[0,5,6,7,9,127,239];var n=r.indexOf(t[0])!==-1?2:0;var i=Oe(t.slice(0,8));var a=i[n];var s=fe[a];if(s==="1"||s==="3"){e={...Pe(i.slice(n)),descriptor:s==="1"?{meterType:"mtx1",...ae(Re,t[8])}:{meterType:"mtx3",...ae(Ue,t[8])}}}else{e=s==="M"?Ie(i):De(i)}return e};var Le=function(t,e){var r=t.type,n=t.revision,i=t.descriptor;if(!r.startsWith("MTX ")){throw new Error("Wrong format")}var a;var s=r.substring(4);var o=r[4];if(o==="1"||o==="3"){a=Se(s,e,n)}else{a=o==="M"?Ne(s):Me(s)}if(i?.meterType){a[8]=i.meterType==="mtx1"?ie(Re,i):ie(Ue,i)}else{a[8]=0}return a};var we=80;var Fe=81;var xe=82;var Ye=83;var Be=84;var He=85;var We=86;var be=87;var Ge=88;var Ve=89;var ze=90;var Ke=91;var Xe=255;var ke=Object.freeze({__proto__:null,DATA_REQUEST:we,DATA_RESPONSE:Fe,FRAGMENT_REQUEST:ze,FRAGMENT_RESPONSE:Ke,IDENT_REQUEST:xe,IDENT_RESPONSE:Ye,INVALID:Xe,L2_CHECK_ADDRESS_REQUEST:We,L2_CHECK_ADDRESS_RESPONSE:be,L2_RM_ADDRESS_REQUEST:Ge,L2_RM_ADDRESS_RESPONSE:Ve,L2_SET_ADDRESS_REQUEST:Be,L2_SET_ADDRESS_RESPONSE:He});var je=Mt(ke);var Qe=1;var qe=2;var Ze=3;var $e=16;var Je=17;var tr=18;var er=19;var rr=20;var nr=21;var ir=32;var ar=33;var sr=34;var or=35;var vr=36;var fr=37;var ur=38;var hr=39;var Er=40;var gr=41;var _r=49;var lr=50;var cr=51;var dr=52;var Ar=53;var Tr=54;var pr=55;var Rr=56;var Ur=57;var yr=64;var Or=65;var mr=66;var Pr=67;var Sr=68;var Dr=69;var Mr=70;var Ir=71;var Nr=72;var Cr=73;var Lr=74;var wr=75;var Fr=76;var xr=77;var Yr=78;var Br=79;var Hr=80;var Wr=81;var br=82;var Gr=83;var Vr=84;var zr=85;var Kr=86;var Xr=87;var kr=88;var jr=89;var Qr=96;var qr=97;var Zr=98;var $r=99;var Jr=100;var tn=101;var en=102;var rn=103;var nn=104;var an=105;var sn=112;var on=113;var vn=114;var fn=115;var un=116;var hn=117;var En=118;var gn=119;var _n=120;var ln=121;var cn=122;var dn=123;var An=124;var Tn=125;var pn=144;var Rn=145;var Un=147;var yn=148;var On=156;var mn=157;var Pn=158;var Sn=159;var Dn=160;var Mn=161;var In=162;var Nn=176;var Cn=177;var Ln=178;var wn=179;var Fn=180;var xn=181;var Yn=182;var Bn=183;var Hn=208;var Wn=224;var bn=225;var Gn=226;var Vn=227;var zn=228;var Kn=229;var Xn=230;var kn=Object.freeze({__proto__:null,ACCESS_CLOSED:$e,ACCPARAM_BAD:vn,ACCPARAM_EXT_BAD:fn,BAD_TEST_EEPROM:nn,BAD_TEST_FRAM:an,BAT_FAULT:Gr,BAT_OK:br,BIPOLAR_POWER_FAULT:Fn,BIPOLAR_POWER_OK:xn,BLOCK_TARIFF_BAD:hn,CALC_PERIOD_BAD:un,CALFLAG_RESET:rn,CALFLAG_SET:en,CALIBR_PARAM_BAD:En,CAL_FAULT:zr,CAL_OK:Vr,CASE_CLOSE:er,CASE_MODULE_CLOSE:Tn,CASE_MODULE_OPEN:An,CASE_OPEN:tr,CASE_TERMINAL_CLOSE:dn,CASE_TERMINAL_OPEN:cn,CHANGE_ACCESS_KEY0:ir,CHANGE_ACCESS_KEY1:ar,CHANGE_ACCESS_KEY2:sr,CHANGE_ACCESS_KEY3:or,CHANGE_COR_TIME:gr,CHANGE_PAR_LOCAL:vr,CHANGE_PAR_REMOTE:fr,CHANGE_TARIFF_TBL:lr,CLOCK_FAULT:Xr,CLOCK_OK:Kr,CMD_CHANGE_TIME:ur,CMD_RELAY_2_OFF:qr,CMD_RELAY_2_ON:Qr,CMD_RELAY_OFF:Er,CMD_RELAY_ON:hr,CROSSZERO_ENT1:Zr,CROSSZERO_ENT2:$r,CROSSZERO_ENT3:Jr,CROSSZERO_ENT4:tn,CROSSZERO_EXP_ENT1:Pn,CROSSZERO_EXP_ENT2:Sn,CROSSZERO_EXP_ENT3:Dn,CROSSZERO_EXP_ENT4:Mn,CURRENT_UNEQUIL_FAULT:Ln,CURRENT_UNEQUIL_OK:wn,EM_MAGNETIC_OFF:Cn,EM_MAGNETIC_ON:Nn,ENERGY_REG_FAULT:Qe,ENERGY_REG_OVERFLOW:_r,ERR_ACCESS:Je,F_MAX_OK:Nr,F_MAX_OVER:Cr,F_MIN_OK:Lr,F_MIN_OVER:wr,I_MAX_OK:Fr,I_MAX_OVER:xr,MAGNETIC_OFF:nr,MAGNETIC_ON:rr,NVRAM_FAULT:Hn,OP_PAR_FAULT:Ze,POWERSALDO_OK:Hr,POWERSALDO_OVER:Wr,POWER_A_OFF:kr,POWER_A_ON:jr,POWER_OVER_RELAY_OFF:mn,P_MAX_OK:Yr,P_MAX_OVER:Br,RELAY_HARD_BAD_OFF:pn,RELAY_HARD_BAD_ON:Un,RELAY_HARD_OFF:yn,RELAY_HARD_ON:Rn,RELAY_OFF:pr,RELAY_ON:Tr,RESET_EM_FLAG:Yn,RESET_MAGN_FLAG:Bn,RESTART:Rr,SALDO_EN_BAD:_n,SALDO_PARAM_BAD:on,SET_DEMAND_EN_10MIN:Vn,SET_DEMAND_EN_15MIN:zn,SET_DEMAND_EN_1MIN:Wn,SET_DEMAND_EN_30MIN:Kn,SET_DEMAND_EN_3MIN:bn,SET_DEMAND_EN_5MIN:Gn,SET_DEMAND_EN_60MIN:Xn,SET_NEW_SALDO:sn,SET_SALDO_PARAM:On,SET_TARIFF_TBL:cr,SUMMER_TIME:dr,TIME_CORRECT:ln,TIME_CORRECT_NEW:In,T_MAX_OK:Sr,T_MAX_OVER:Dr,T_MIN_OK:Mr,T_MIN_OVER:Ir,VENDOR_PAR_FAULT:qe,V_MAX_OK:yr,V_MAX_OVER:Or,V_MIN_OK:mr,V_MIN_OVER:Pr,WD_RESTART:Ur,WINTER_SUMMER_BAD:gn,WINTER_TIME:Ar});var jn=Mt(kn);var Qn={type:we,destination:65535,source:65534};var qn=11;var Zn=7;var $n=4;var Jn=48;var ti=50;var ei=3+Jn*2;var ri={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_COEFFICIENT_PHASE_A:524288,POWER_COEFFICIENT_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var ni={...ri,AUTO_SCREEN_SCROLLING:2147483648};var ii={...ri,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var ai={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_1:8,RELAY_ON_TARIFF_2:16,RELAY_ON_TARIFF_3:32,RELAY_ON_TARIFF_4:64,RELAY_ON_V_GOOD:128};var si={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_1:4,RELAY_OFF_TARIFF_2:8,RELAY_OFF_TARIFF_3:16,RELAY_OFF_TARIFF_4:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var oi={RELAY_OFF_LIM_TARIFF_1:2,RELAY_OFF_LIM_TARIFF_2:4,RELAY_OFF_LIM_TARIFF_3:8,RELAY_OFF_LIM_TARIFF_4:16,RELAY_OFF_PF_MIN:32};var vi={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var fi={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var ui={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var hi={CASE_OPEN:2**0,MAGNETIC_ON:2**1,PARAMETERS_UPDATE_REMOTE:2**2,PARAMETERS_UPDATE_LOCAL:2**3,RESTART:2**4,ERROR_ACCESS:2**5,TIME_SET:2**6,TIME_CORRECT:2**7,DEVICE_FAILURE:2**8,CASE_TERMINAL_OPEN:2**9,CASE_MODULE_OPEN:2**10,TARIFF_TABLE_SET:2**11,TARIFF_TABLE_GET:2**12,PROTECTION_RESET_EM:2**13,PROTECTION_RESET_MAGNETIC:2**14};var Ei={RELAY_STATE:2**0,RELAY_UBAD:2**1,RELAY_UNEQ_CURRENT:2**4,RELAY_OFF_CENTER:2**5,RELAY_IMAX:2**6,RELAY_PMAX:2**7};var gi={RELAY_COSFI:2**0,RELAY_SALDO_OFF_FLAG:2**1,RELAY_UNEQUIL_CURRENT_OFF:2**2,RELAY_BIPOLAR_POWER_OFF:2**3,RELAY_SALDO_OFF_ON_MAX_POWER:2**4,RELAY_HARD_ST1:2**5};var _i={MAXVA:2**0,MINVA:2**1,MAXT:2**2,MINT:2**3,MAXF:2**4,MINF:2**5,MAXIA:2**6,MAXP:2**7};var li={MAX_POWER_SALDO:2**0,BATTERY_VBAT_BAD:2**1,CLOCK_UNSET:2**3,MIN_COS_FI:2**5};var ci={UNEQUIL_CURRENT:2**0,BIPOLAR_POWER:2**1,POWER_A_NEGATIVE:2**6,POWER_B_NEGATIVE:2**7};var di={RELAY_OFF_LIMIT_P_MINUS_T1:8,RELAY_OFF_LIMIT_P_MINUS_T2:16,RELAY_OFF_LIMIT_P_MINUS_T3:32,RELAY_OFF_LIMIT_P_MINUS_T4:64};function Ai(t,e,r){var n=r>>$n;var i=new Array($n).fill(0);i.forEach((function(e,r){var a=!!se(n,1,r+1);if(a){i[r]=t.getUint32()}else{i[r]=null}}));return i}function Ti(t,e,r){var n=1+$n;var i=e;r.forEach((function(t,e){i=oe(i,1,e+n,Number(!!t))}));t.setUint8(i)}function pi(t){if(t===65535){return{tariff:undefined,energy:undefined}}return{tariff:t>>14&3,energy:t&16383}}function Ri(t,e){var r=e.tariff,n=e.energy;if(r!==undefined&&n!==undefined){t.setUint16(r<<14|n&16383)}else{t.setUint16(65535)}}function Ui(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;ne.call(this,t,e)}Ui.prototype=Object.create(ne.prototype);Ui.prototype.constructor=Ui;Ui.getDayProfileFromByte=function(t){return{tariff:se(t,2,1),isFirstHalfHour:!se(t,1,3),hour:se(t,5,4)}};Ui.getByteFromDayProfile=function(t){var e=0;e=oe(e,2,1,t.tariff);e=oe(e,1,3,+!t.isFirstHalfHour);e=oe(e,5,4,t.hour);return e};Ui.getDefaultSeasonProfile=function(){return{month:1,date:1,dayIndexes:[0,0,0,0,0,0,0]}};Ui.getDefaultOperatorParameters=function(){return{vpThreshold:265e3,vThreshold:156e3,ipThreshold:12e4,pmaxThreshold0:31800,pmaxThreshold1:31800,pmaxThreshold2:31800,pmaxThreshold3:31800,speedOptoPort:0,tint:30,calcPeriodDate:1,timeoutDisplay:127,timeoutScreen:7,displaySet:ae(ni,2147496324),relaySet4:ae(vi,0),relaySet3:ae(oi,0),relaySet2:ae(si,3),relaySet1:ae(ai,3),displayType:0,ten:0,timeoutRefresh:240,deltaCorMin:15,timeoutMagnetOff:5,timeoutMagnetOn:5,define1:ae(ui,0),timeoutRelayOn:1,timeoutRelayKey:0,timeoutRelayAuto:5,timeoutBadVAVB:5,freqMax:55,freqMin:45,phMin:0,year:0,month:0,date:0,energyDecimalPoint:2,typeMeter:0,timeoutIMax:5,timeoutPMax:5,timeoutCos:5,pMaxDef:1,displaySetExt:ae(ii,137904127),timeoutUneqCurrent:5,timeoutBipolarPower:5,relaySet5:ae(fi,0),timeCorrectPeriod:24,timeCorrectPassHalfhour:false}};Ui.getDefaultOperatorParametersExtended3=function(){return{pmaxMinusThreshold0:0,pmaxMinusThreshold1:0,pmaxMinusThreshold2:0,pmaxMinusThreshold3:0,relaySet:ae(di,0)}};Ui.prototype.getFrameHeader=function(){var t=this.getUint8();var e=je[t];var r=this.getUint16();var n=this.getUint16();return{type:t,typeName:e,destination:r,source:n}};Ui.prototype.setFrameHeader=function(t){var e=t.type,r=e===void 0?Qn.type:e,n=t.destination,i=n===void 0?Qn.destination:n,a=t.source,s=a===void 0?Qn.source:a;this.setUint8(r);this.setUint16(i);this.setUint16(s)};Ui.prototype.getDeviceId=function(){var t=g(this.getBytes(3),{separator:""});var e=this.getUint8();var r=this.getUint8();var n=g(this.getBytes(3),{separator:""});return{manufacturer:t,type:e,year:r,serial:n}};Ui.prototype.setDeviceId=function(t){var e=t.manufacturer,r=t.type,n=t.year,i=t.serial;this.setBytes(h(e));this.setUint8(r);this.setUint8(n);this.setBytes(h(i))};Ui.prototype.getDateTime=function(){return{isSummerTime:!!this.getUint8(),seconds:this.getUint8(),minutes:this.getUint8(),hours:this.getUint8(),day:this.getUint8(),date:this.getUint8(),month:this.getUint8(),year:this.getUint8()}};Ui.prototype.setDateTime=function(t){this.setUint8(t.isSummerTime?1:0);this.setUint8(t.seconds);this.setUint8(t.minutes);this.setUint8(t.hours);this.setUint8(t.day||0);this.setUint8(t.date);this.setUint8(t.month);this.setUint8(t.year)};Ui.prototype.getTariffPlan=function(){return{id:this.getUint32(),tariffSet:this.getUint8(),activateYear:this.getUint8(),activateMonth:this.getUint8(),activateDay:this.getUint8(),specialProfilesArraySize:this.getUint8(),seasonProfilesArraySize:this.getUint8(),dayProfilesArraySize:this.getUint8()}};Ui.prototype.setTariffPlan=function(t){this.setUint32(t.id);this.setUint8(t.tariffSet);this.setUint8(t.activateYear);this.setUint8(t.activateMonth);this.setUint8(t.activateDay);this.setUint8(t.specialProfilesArraySize);this.setUint8(t.seasonProfilesArraySize);this.setUint8(t.dayProfilesArraySize)};Ui.prototype.getTimeCorrectionParameters=function(){return{monthTransitionSummer:this.getUint8(),dateTransitionSummer:this.getUint8(),hoursTransitionSummer:this.getUint8(),hoursCorrectSummer:this.getUint8(),monthTransitionWinter:this.getUint8(),dateTransitionWinter:this.getUint8(),hoursTransitionWinter:this.getUint8(),hoursCorrectWinter:this.getUint8(),isCorrectionNeeded:this.getUint8()===1}};Ui.prototype.setTimeCorrectionParameters=function(t){this.setUint8(t.monthTransitionSummer);this.setUint8(t.dateTransitionSummer);this.setUint8(t.hoursTransitionSummer);this.setUint8(t.hoursCorrectSummer);this.setUint8(t.monthTransitionWinter);this.setUint8(t.dateTransitionWinter);this.setUint8(t.hoursTransitionWinter);this.setUint8(t.hoursCorrectWinter);this.setUint8(+t.isCorrectionNeeded)};Ui.prototype.getDayProfile=function(){return Ui.getDayProfileFromByte(this.getUint8())};Ui.prototype.setDayProfile=function(t){this.setUint8(Ui.getByteFromDayProfile(t))};Ui.prototype.getSeasonProfile=function(){var t=this;return{month:this.getUint8(),date:this.getUint8(),dayIndexes:new Array(Zn).fill(0).map((function(){return t.getUint8()}))}};Ui.prototype.setSeasonProfile=function(t){var e=this;this.setUint8(t.month);this.setUint8(t.date);t.dayIndexes.forEach((function(t){return e.setUint8(t)}))};Ui.prototype.getSpecialDay=function(){return{month:this.getUint8(),date:this.getUint8(),dayIndex:this.getUint8(),isPeriodic:this.getUint8()===0}};Ui.prototype.setSpecialDay=function(t){this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.dayIndex);this.setUint8(+!t.isPeriodic)};Ui.prototype.getDeviceType=function(){return Ce(this.getBytes(9))};Ui.prototype.setDeviceType=function(t){this.setBytes(Le(t))};Ui.prototype.getOperatorParameters=function(){var t={vpThreshold:this.getUint32(),vThreshold:this.getUint32(),ipThreshold:this.getUint32(),pmaxThreshold0:this.getUint32(),pmaxThreshold1:this.getUint32(),pmaxThreshold2:this.getUint32(),pmaxThreshold3:this.getUint32(),speedOptoPort:this.getUint8(),tint:this.getUint8(),calcPeriodDate:this.getUint8(),timeoutDisplay:this.getUint8(),timeoutScreen:this.getUint8(),displaySet:ae(ni,this.getUint32()),relaySet4:ae(vi,this.getUint8()),relaySet3:ae(oi,this.getUint8()),relaySet2:ae(si,this.getUint8()),relaySet1:ae(ai,this.getUint8()),displayType:this.getUint8(),ten:this.getUint8(),timeoutRefresh:this.getUint16(),deltaCorMin:this.getUint8(),timeoutMagnetOff:this.getUint8(),timeoutMagnetOn:this.getUint8(),define1:ae(ui,this.getUint8()),timeoutRelayOn:this.getUint8(),timeoutRelayKey:this.getUint8(),timeoutRelayAuto:this.getUint8(),timeoutBadVAVB:this.getUint8(),freqMax:this.getUint8(),freqMin:this.getUint8(),phMin:this.getUint16(),year:this.getUint8(),month:this.getUint8(),date:this.getUint8(),energyDecimalPoint:this.getUint8(),typeMeter:this.getUint8(),timeoutIMax:this.getUint8(),timeoutPMax:this.getUint8(),timeoutCos:this.getUint8(),pMaxDef:this.getUint8(),displaySetExt:ae(ii,this.getUint32()),timeoutUneqCurrent:this.getUint8(),timeoutBipolarPower:this.getUint8(),relaySet5:ae(fi,this.getUint8()),timeCorrectPeriod:0,timeCorrectPassHalfhour:false};var e=this.getUint8();t.timeCorrectPeriod=e&127;t.timeCorrectPassHalfhour=!!(e&128);return t};Ui.prototype.setOperatorParameters=function(t){var e=t.timeCorrectPeriod|(t.timeCorrectPassHalfhour?128:0);this.setUint32(t.vpThreshold);this.setUint32(t.vThreshold);this.setUint32(t.ipThreshold);this.setUint32(t.pmaxThreshold0);this.setUint32(t.pmaxThreshold1);this.setUint32(t.pmaxThreshold2);this.setUint32(t.pmaxThreshold3);this.setUint8(t.speedOptoPort);this.setUint8(t.tint);this.setUint8(t.calcPeriodDate);this.setUint8(t.timeoutDisplay);this.setUint8(t.timeoutScreen);this.setUint32(ie(ni,t.displaySet));this.setUint8(ie(vi,t.relaySet4));this.setUint8(ie(oi,t.relaySet3));this.setUint8(ie(si,t.relaySet2));this.setUint8(ie(ai,t.relaySet1));this.setUint8(t.displayType);this.setUint8(t.ten);this.setUint16(t.timeoutRefresh);this.setUint8(t.deltaCorMin);this.setUint8(t.timeoutMagnetOff);this.setUint8(t.timeoutMagnetOn);this.setUint8(ie(ui,t.define1));this.setUint8(t.timeoutRelayOn);this.setUint8(t.timeoutRelayKey);this.setUint8(t.timeoutRelayAuto);this.setUint8(t.timeoutBadVAVB);this.setUint8(t.freqMax);this.setUint8(t.freqMin);this.setUint16(t.phMin);this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.energyDecimalPoint);this.setUint8(t.typeMeter);this.setUint8(t.timeoutIMax);this.setUint8(t.timeoutPMax);this.setUint8(t.timeoutCos);this.setUint8(t.pMaxDef);this.setUint32(ie(ii,t.displaySetExt));this.setUint8(t.timeoutUneqCurrent);this.setUint8(t.timeoutBipolarPower);this.setUint8(ie(fi,t.relaySet5));this.setUint8(e)};Ui.prototype.getPackedEnergyWithType=function(){var t=this.getUint8();var e=se(t,$n,1);var r=Ai(this,e,t);return{energyType:e,energies:r}};Ui.prototype.setPackedEnergyWithType=function(t){var e=this;var r=t.energyType,n=t.energies;if(r){Ti(this,r,n)}n.forEach((function(t){if(t!==null){e.setUint32(t)}}))};Ui.prototype.getEnergies=function(){var t=this;return new Array($n).fill(0).map((function(){return t.getInt32()}))};Ui.prototype.setEnergies=function(t){var e=this;t.forEach((function(t){return e.setUint32(t)}))};Ui.prototype.getDate=function(){return{year:this.getUint8(),month:this.getUint8(),date:this.getUint8()}};Ui.prototype.setDate=function(t){this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date)};Ui.prototype.getSaldoParameters=function(){var t=this;return{coefficients:new Array(4).fill(0).map((function(){return t.getUint32()})),decimalPointTariff:this.getUint8(),indicationThreshold:this.getInt32(),relayThreshold:this.getInt32(),mode:this.getUint8(),saldoOffTimeBegin:this.getUint8(),saldoOffTimeEnd:this.getUint8(),decimalPointIndication:this.getUint8(),powerThreshold:this.getUint32(),creditThreshold:this.getInt32()}};Ui.prototype.setSaldoParameters=function(t){var e=this;t.coefficients.forEach((function(t){return e.setUint32(t)}));this.setUint8(t.decimalPointTariff);this.setInt32(t.indicationThreshold);this.setInt32(t.relayThreshold);this.setUint8(t.mode);this.setUint8(t.saldoOffTimeBegin);this.setUint8(t.saldoOffTimeEnd);this.setUint8(t.decimalPointIndication);this.setUint32(t.powerThreshold);this.setInt32(t.creditThreshold)};Ui.prototype.getEnergyPeriods=function(t){var e=this;var r=new Array(t).fill(0).map((function(){return e.getUint16()}));return r.map((function(t){return pi(t)}))};Ui.prototype.setEnergyPeriods=function(t){var e=this;t.forEach((function(t){return Ri(e,t)}))};Ui.prototype.getEventStatus=function(){var t=this.getUint16();return ae(hi,t)};Ui.prototype.setEventStatus=function(t){this.setUint16(ie(hi,t))};Ui.prototype.getExtendedCurrentValues2=function(){var t=this.getUint16();var e=ae(Ei,this.getUint8());var r=ae(gi,this.getUint8());var n=ae(_i,this.getUint8());var i=ae(li,this.getUint8());var a=ae(ci,this.getUint8());return{uBattery:t,relayStatus:e,relayStatus2:r,status1:n,status2:i,status3:a}};Ui.prototype.setExtendedCurrentValues2=function(t){var e=t.uBattery,r=t.relayStatus,n=t.relayStatus2,i=t.status1,a=t.status2,s=t.status3;this.setUint16(e);this.setUint8(ie(Ei,r));this.setUint8(ie(gi,n));this.setUint8(ie(_i,i));this.setUint8(ie(li,a));this.setUint8(ie(ci,s))};Ui.prototype.getEvent=function(){var t={hours:this.getUint8(),minutes:this.getUint8(),seconds:this.getUint8(),event:this.getUint8()};var e=t.event;var r=this.bytesLeft;t.eventName=jn[e];switch(e){case mn:if(r<4){return t}t.power=[this.getUint8(),this.getUint8(),this.getUint8(),this.getUint8()];break;case ur:case ln:if(r<8){return t}t.newDate=this.getDateTime();break}return t};Ui.prototype.setEvent=function(t){this.setUint8(t.hours);this.setUint8(t.minutes);this.setUint8(t.seconds);this.setUint8(t.event);switch(t.event){case mn:for(var e of t.power){this.setUint8(e)}break;case ur:case ln:this.setDateTime(t.newDate);break}};Ui.prototype.getDemand=function(){var t=this.getUint8();var e=this.getUint8();return{date:{year:t>>1,month:t<<3&15|e>>5,date:e&31},energyType:this.getUint8(),firstIndex:this.getUint16(),count:this.getUint8(),period:this.getUint8()}};Ui.prototype.setDemand=function(t){var e=t.date.year<<1|t.date.month>>3&1;var r=t.date.month<<5&224|t.date.date&31;this.setUint8(e);this.setUint8(r);this.setUint8(t.energyType);this.setUint16(t.firstIndex);this.setUint8(t.count);this.setUint8(t.period)};Ui.prototype.getDayMaxDemandResponse=function(){var t=this;var e=this.getDate();var r=new Array($n).fill(0).map((function(){return{hours:t.getUint8(),minutes:t.getUint8(),power:t.getUint32()}}));return{date:e,power:r}};Ui.prototype.setDayMaxDemandResponse=function(t){var e=this;this.setDate(t.date);t.power.forEach((function(t){e.setUint8(t.hours);e.setUint8(t.minutes);e.setUint32(t.power)}))};Ui.prototype.getOperatorParametersExtended3=function(){return{pmaxMinusThreshold0:this.getUint32(),pmaxMinusThreshold1:this.getUint32(),pmaxMinusThreshold2:this.getUint32(),pmaxMinusThreshold3:this.getUint32(),relaySet:ae(di,this.getUint8())}};Ui.prototype.setOperatorParametersExtended3=function(t){var e=t.pmaxMinusThreshold0,r=t.pmaxMinusThreshold1,n=t.pmaxMinusThreshold2,i=t.pmaxMinusThreshold3,a=t.relaySet;this.setUint32(e);this.setUint32(r);this.setUint32(n);this.setUint32(i);this.setUint8(ie(di,a))};Ui.prototype.getMonthMaxPowerByTariffs=function(){var t=this;return new Array($n).fill(0).map((function(){return{date:t.getUint8(),hours:t.getUint8(),minutes:t.getUint8(),power:t.getUint32()}}))};Ui.prototype.setMonthMaxPowerByTariffs=function(t){var e=this;t.forEach((function(t){e.setUint8(t.date);e.setUint8(t.hours);e.setUint8(t.minutes);e.setUint32(t.power)}))};var yi=0;var Oi=128;var mi=129;var Pi=130;var Si=131;var Di=132;var Mi=133;var Ii=134;var Ni=135;var Ci=136;var Li=137;var wi=144;var Fi=145;var xi=146;var Yi=147;var Bi=149;var Hi=151;var Wi=152;var bi=153;var Gi=154;var Vi=155;var zi=156;var Ki=159;var Xi=160;var ki=240;var ji=Object.freeze({__proto__:null,ACCESS_DENIED:Yi,BAD_ARRAY_INDEX:Ii,BAD_BLOCK_NUMBER:zi,BAD_DATA_LENGTH:Mi,BAD_MESSAGE:Di,BAD_RATE_PLAN_ID:Ci,BAD_RATE_PLAN_SIZE:Li,BAD_RESPONSE_LENGTH:wi,BAD_SALDO_WRITE:Bi,BLOCKED_METER:Hi,CALIBRATION_DISABLED:xi,DECRYPTION_FAILURE:Pi,INTERNAL:ki,INVALID_CORRECTION_INTERVAL:Gi,NOT_ALIGNED_DATA:mi,NOT_PREPARED_RATE_PLAN:Ni,NO_DATA_FOR_DATE:Fi,OK:yi,OUT_OFF_RANGE:Ki,SET_METER_TYPE_FAILURE:Xi,TIME_CORRECTION_FAILURE:bi,TIME_CORRECTION_OUT_HALF_HOUR_DISABLED:Vi,UNENCRYPTED_COMMAND_DISABLED:Wi,UNKNOWN_COMMAND:Oi,UNKNOWN_PROTOCOL:Si});var Qi=Mt(ji);var qi=St;var Zi=function(t){return function(e){var r=new Ui(e);var n=r.getUint8();var i=r.getUint8();return{commandId:n,commandName:t[n],errorCode:i,errorName:Qi[i]}}};var $i=Zi(It);var Ji=Tt;var ta=6;var ea=function(t){if(t.length!==ta){throw new Error("Wrong buffer size: ".concat(t.length,"."))}var e=o(t,6),r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],v=e[5];return{date:{date:r,month:n,year:i},version:"".concat(a,".").concat(s,".").concat(v)}};var ra=et;var na=function(t){var e=new Ui(t);return e.getTimeCorrectionParameters()};var ia=0;var aa=1;var sa=2;var oa=3;var va=4;var fa=5;var ua=6;var ha=7;var Ea=8;var ga=9;var _a=10;var la=11;var ca=12;var da=13;var Aa=14;var Ta=Object.freeze({__proto__:null,CASE_MODULE_OPEN:_a,CASE_OPEN:ia,CASE_TERMINAL_OPEN:ga,DEVICE_FAILURE:Ea,ERROR_ACCESS:fa,MAGNETIC_ON:aa,PARAMETERS_UPDATE_LOCAL:oa,PARAMETERS_UPDATE_REMOTE:sa,PROTECTION_RESET_EM:da,PROTECTION_RESET_MAGNETIC:Aa,RESTART:va,TARIFF_TABLE_GET:ca,TARIFF_TABLE_SET:la,TIME_CORRECT:ha,TIME_SET:ua});var pa=Mt(Ta);var Ra=rt;var Ua=9;var ya=function(t){if(t.length!==Ua){throw new Error("Wrong buffer size: ".concat(t.length,"."))}var e=o(t,9),r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],v=e[5],f=e[6],u=e[7],h=e[8];return{event:r,name:pa[r],index:n,date:{year:i,month:a,date:s,hours:v,minutes:f,seconds:u},count:h}};var Oa=q;var ma={calibrationEnable:1,hardkey:2,keyPressTest:4,keyOpenkeyTest:8,keyGerkonTest:16,keyOpenKlemaTest:32,keyOpenModuleTest:64,keyPress2Test:128};var Pa=function(t){var e=new Ui(t);var r=e.getUint32();var n=e.getUint32();var i=e.getUint32();var a=e.getUint32();e.getUint32();var s=e.getUint32();var o=ae(Ei,e.getUint8());var v=e.getUint8();var f=e.getUint8();var u=ae(ma,e.getUint8());var h={"A+":e.getUint8(),"A-":e.getUint8()};var E=!!(e.getUint8()&1);var g=v|f<<8;return{operatingSeconds:r,tbadVAVB:n,tbadImaxAll:i,tbadPmaxAll:a,tbadFREQ:s,relayStatus:o,statusEvent:ae(hi,g),calibrationFlags:u,currentTariffs:h,isSummerTime:E}};var Sa=U;var Da=function(t){var e=new Ui(t);return{powerA:e.getInt32(),iaRms:e.getInt32(),vavbRms:e.getInt32(),varA:e.getInt32(),pfA:e.getInt16()/1e3,ibRms:e.getInt32(),powerB:e.getInt32(),varB:e.getInt32(),pfB:e.getInt16()/1e3}};var Ma=T;var Ia=function(t){var e=new Ui(t);return e.getDateTime()};var Na=19;var Ca=I;var La=function(t){var e=new Ui(t);var r;if(t.length===Na){r={date:e.getDate(),energies:e.getEnergies()}}else{r={date:e.getDate(),...e.getPackedEnergyWithType()}}return r};var wa=19;var Fa=st;var xa=function(t){var e=new Ui(t);var r;if(t.length===wa){r={date:e.getDate(),energies:e.getEnergies()}}else{r={date:e.getDate(),...e.getPackedEnergyWithType()}}return r};var Ya=4;var Ba=["A+","A+R+","A+R-","A-","A-R+","A-R-"];var Ha=4294967295;var Wa={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var ba=function(t){var e={};Object.keys(t).forEach((function(r){e[r]=!!t[r]}));return ie(Wa,e)};var Ga=function(t){return t<Ya?1<<t:0};var Va=function(t){return t<Ya?1<<t<<4:0};var za=function(t,e){var r=0;if(t<Ya){if(e["A+"]||e["A+R+"]||e["A+R-"]){r|=Ga(t)}if(e["A-"]||e["A-R+"]||e["A-R-"]){r|=Va(t)}}return r};function Ka(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;ne.call(this,t,e)}Ka.prototype=Object.create(ne.prototype);Ka.prototype.constructor=Ka;Ka.prototype.getDate=function(){var t=this.getUint8();var e=this.getUint8();return{year:t>>1,month:t<<3&15|e>>5,date:e&31}};Ka.prototype.setDate=function(t){var e=t.year,r=t.month,n=t.date;var i=e<<1|r>>3&1;var a=r<<5&224|n&31;this.setUint8(i);this.setUint8(a)};Ka.prototype.getEnergiesFlags=function(){var t=this.getUint8();return ae(Wa,t)};Ka.prototype.setEnergiesFlags=function(t){this.setUint8(ba(t))};Ka.prototype.getHalfhoursEnergy1=function(t){var e=[];for(var r=0;r<t;r++){var n=this.getUint16();var i=n>>14&3;var a=n&16383;e.push(n===Ha?undefined:{tariff:i,energy:a})}return e};Ka.prototype.setHalfhoursEnergy1=function(t){if(t){for(var e=0;e<t.length;e++){var r=t[e],n=r.tariff,i=r.energy;var a=n<<14|i;this.setUint16(a===undefined?Ha:a)}}};Ka.prototype.getHalfhoursEnergy3=function(t){var e=[];for(var r=0;r<t;r++){var n=this.getUint16();e.push(n===Ha?undefined:n)}return e};Ka.prototype.setHalfhoursEnergy3=function(t){if(t){for(var e=0;e<t.length;e++){var r=t[e];this.setUint16(r===undefined?Ha:r)}}};Ka.prototype.getHalfhoursEnergies1=function(t,e){var r=this;var n={};Ba.forEach((function(i){if(t[i]){n[i]=r.getHalfhoursEnergy1(e)}}));return n};Ka.prototype.getHalfhoursEnergies3=function(t,e){var r=this;var n={};Ba.forEach((function(i){if(t[i]){n[i]=r.getHalfhoursEnergy3(e)}}));return n};Ka.prototype.setHalfhoursEnergies1=function(t){var e=this;Ba.forEach((function(r){e.setHalfhoursEnergy1(t[r])}))};Ka.prototype.setHalfhoursEnergies3=function(t){var e=this;Ba.forEach((function(r){e.setHalfhoursEnergy3(t[r])}))};Ka.prototype.getAPlusTariffEnergies=function(t){var e={};if(t&Wa["A+"]){e["A+"]=this.getUint32()}if(t&Wa["A+R+"]){e["A+R+"]=this.getUint32()}if(t&Wa["A+R-"]){e["A+R-"]=this.getUint32()}return e};Ka.prototype.setAPlusTariffEnergies=function(t){if(t){if(t["A+"]){this.setUint32(t["A+"])}if(t["A+R+"]){this.setUint32(t["A+R+"])}if(t["A+R-"]){this.setUint32(t["A+R-"])}}};Ka.prototype.getAMinusTariffEnergies=function(t){var e={};if(t&Wa["A-"]){e["A-"]=this.getUint32()}if(t&Wa["A-R+"]){e["A-R+"]=this.getUint32()}if(t&Wa["A-R-"]){e["A-R-"]=this.getUint32()}return e};Ka.prototype.setAMinusTariffEnergies=function(t){if(t){if(t["A-"]){this.setUint32(t["A-"])}if(t["A-R+"]){this.setUint32(t["A-R+"])}if(t["A-R-"]){this.setUint32(t["A-R-"])}}};Ka.prototype.getTariffsEnergies=function(){var t=this.getUint8();var e=this.getUint8();var r=new Array(Ya).fill(null);for(var n=0;n<Ya;n++){if(e&Ga(n)){r[n]=this.getAPlusTariffEnergies(t)}}for(var i=0;i<Ya;i++){if(e&Va(i)){r[i]={...r[i],...this.getAMinusTariffEnergies(t)}}}return r};Ka.prototype.setTariffsEnergies=function(t){var e=this;var r=0;var n=0;t.forEach((function(t,e){if(t){r|=ba(t);n|=za(e,t)}}));this.setUint8(r);this.setUint8(n);t.forEach((function(t){return e.setAPlusTariffEnergies(t)}));t.forEach((function(t){return e.setAMinusTariffEnergies(t)}))};Ka.prototype.getPowerMax=function(){return{hours:this.getUint8(),minutes:this.getUint8(),power:this.getUint32()}};Ka.prototype.setPowerMax=function(t){if(t){var e=t.hours,r=t.minutes,n=t.power;this.setUint8(e);this.setUint8(r);this.setUint32(n)}};Ka.prototype.getAPlusTariffPowerMax=function(t){var e={};if(t&Wa["A+"]){e["A+"]=this.getPowerMax()}if(t&Wa["A+R+"]){e["A+R+"]=this.getPowerMax()}if(t&Wa["A+R-"]){e["A+R-"]=this.getPowerMax()}return e};Ka.prototype.setAPlusTariffPowerMax=function(t){if(t){this.setPowerMax(t["A+"]);this.setPowerMax(t["A+R+"]);this.setPowerMax(t["A+R+"])}};Ka.prototype.getAMinusTariffPowerMax=function(t){var e={};if(t&Wa["A-"]){e["A-"]=this.getPowerMax()}if(t&Wa["A-R+"]){e["A-R+"]=this.getPowerMax()}if(t&Wa["A-R-"]){e["A-R-"]=this.getPowerMax()}return e};Ka.prototype.setAMinusTariffPowerMax=function(t){if(t){this.setPowerMax(t["A-"]);this.setPowerMax(t["A-R+"]);this.setPowerMax(t["A-R-"])}};Ka.prototype.getTariffsPowerMax=function(){var t=this.getUint8();var e=this.getUint8();var r=new Array(Ya).fill(null);for(var n=0;n<Ya;n++){if(e&Ga(n)){r[n]=this.getAPlusTariffPowerMax(t)}}for(var i=0;i<Ya;i++){if(e&Va(i)){r[i]={...r[i],...this.getAMinusTariffPowerMax(t)}}}return r};Ka.prototype.setTariffsPowerMax=function(t){var e=this;var r=0;var n=0;t.forEach((function(t,e){if(t){r|=ba(t);n|=za(e,t)}}));this.setUint8(r);this.setUint8(n);t.forEach((function(t){return e.setAPlusTariffPowerMax(t)}));t.forEach((function(t){return e.setAMinusTariffPowerMax(t)}))};var Xa=mt;var ka=function(t){var e=new Ka(t);return{date:e.getDate(),energies:e.getTariffsEnergies()}};var ja=z;var Qa=function(t){var e=new Ui(t);return e.getDayMaxDemandResponse()};var qa=ut;var Za=function(t){var e=new Ui(t);return e.getDayMaxDemandResponse()};var $a=it;var Ja=function(t){var e=new Ui(t);return e.getDayMaxDemandResponse()};var ts=Pt;var es=function(t){var e=new Ka(t);return{date:e.getDate(),tariffs:e.getTariffsPowerMax()}};var rs=255;var ns=$;var is=function(t){var e=t.indexOf(rs);var r=e===-1?t:t.slice(0,e);return{periods:f(r).map(Ui.getDayProfileFromByte)}};var as=1;var ss=2;Mt(Ot);var os=7;var vs=25;var fs=function(t,e,r){return Math.trunc((t*60+e)/r)};var us=function(t){return fs(vs,0,t)};var hs=function(t,e,r){if(t===65535){return null}var n=us(r);if(e===n){return{lastSummerHour:t>>8&255}}return r===60?{energy:t}:{tariff:t>>14&3,energy:t&16383}};var Es=function(t,e){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:30;return t.reduce((function(t,n,i){t.push(hs(n,(e??0)+i,r));return t}),[])};var gs=function(t,e,r){if(t===65535){return 65535}var n=us(r);return e===n?{lastSummerHour:t>>8&255}:{voltage:t}};var _s=function(t,e){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:30;return t.reduce((function(t,n,i){t.push(gs(n,(e??0)+i,r));return t}),[])};var ls=Ut;var cs=function(t){if(!t||t.length<os){throw new Error("Invalid uplink GetDemand byte length.")}var e=new Ui(t);var r=e.getDemand();if(t.length!==os+2*r.count){throw new Error("Invalid uplink GetDemand demands byte length.")}var n=new Array(r.count).fill(0).map((function(){return e.getUint16()}));var i=r.energyType===as||r.energyType===ss;r.demands=i?Es(n,r.firstIndex,r.period):_s(n,r.firstIndex,r.period);return r};var ds=A;var As=function(t){var e=new Ui(t);return e.getDeviceId()};var Ts=d;var ps=function(t){var e=new Ui(t);return e.getDeviceType()};var Rs=1;var Us=2;var ys=3;var Os=4;var ms=5;var Ps=6;var Ss=7;var Ds=8;var Ms=9;var Is=10;var Ns=11;var Cs=12;var Ls=13;var ws=14;var Fs=15;var xs=16;var Ys=17;var Bs=18;var Hs=19;var Ws=20;var bs=21;var Gs=22;var Vs=23;var zs=24;var Ks=25;var Xs=26;var ks=28;var js=30;var Qs=31;var qs=Object.freeze({__proto__:null,ACTIVE_ENERGY_T1:Os,ACTIVE_ENERGY_T2:ms,ACTIVE_ENERGY_T3:Ps,ACTIVE_ENERGY_T4:Ss,ACTIVE_POWER_IN_NEUTRAL:Ms,ACTIVE_POWER_PER_PHASE:Ds,BATTERY_VOLTAGE:Gs,CURRENT_BALANCE:js,CURRENT_IN_NEUTRAL:Ns,CURRENT_IN_PHASE:Is,DATE_MONTH_YEAR:ws,EXPORTED_ACTIVE_ENERGY_T1:xs,EXPORTED_ACTIVE_ENERGY_T2:Ys,EXPORTED_ACTIVE_ENERGY_T3:Bs,EXPORTED_ACTIVE_ENERGY_T4:Hs,HOUR_MINUTE_SECOND:Ls,MAGNET_INDUCTION:ks,OPTOPORT_SPEED:Qs,POWER_COEFFICIENT_PHASE_A:Ws,POWER_COEFFICIENT_PHASE_B:bs,POWER_THRESHOLD_T1:Vs,POWER_THRESHOLD_T2:zs,POWER_THRESHOLD_T3:Ks,POWER_THRESHOLD_T4:Xs,SET_ALL_SEGMENT_DISPLAY:Rs,SOFTWARE_VERSION:Us,TOTAL_ACTIVE_ENERGY:ys,TOTAL_EXPORTED_ACTIVE_ENERGY:Fs,VOLTAGE:Cs});Mt(qs);var Zs=lt;var $s=function(t){var e=v(t),r=e[0],n=e.slice(1);return{displayMode:r,order:n}};var Js=16;var to=y;var eo=function(t){var e=new Ui(t);var r;if(t.length===Js){r={energies:e.getEnergies()}}else{r=e.getPackedEnergyWithType()}return r};var ro=19;var no=c;var io=function(t){var e=new Ui(t);var r;if(t.length===ro){r={date:e.getDate(),energies:e.getEnergies()}}else{r={date:e.getDate(),...e.getPackedEnergyWithType()}}return r};var ao=16;var so=Et;var oo=function(t){var e=new Ui(t);var r;if(t.length===ao){r={energies:e.getEnergies()}}else{r=e.getPackedEnergyWithType()}return r};var vo=19;var fo=ot;var uo=function(t){var e=new Ui(t);var r;if(t.length===vo){r={date:e.getDate(),energies:e.getEnergies()}}else{r={date:e.getDate(),...e.getPackedEnergyWithType()}}return r};var ho=3+1;var Eo=4;var go=X;var _o=ho+255*Eo;var lo=function(t){return function(e){if(e.length>_o){throw new Error("Wrong buffer size: ".concat(e.length,"."))}var r=new t(e);var n=r.getDate();var i=r.getUint8();var a=[];while(!r.isEmpty){a.push(r.getEvent())}return{date:n,eventsNumber:i,events:a}}};var co=lo(Ui);var Ao=14;var To=20;var po=k;var Ro=function(t){if(t.length!==Ao&&t.length!==To){throw new Error("Wrong buffer size: ".concat(t.length,"."))}var e=new Ui(t);var r=e.getUint16();var n=e.getUint16();var i=e.getUint16();var a=e.getUint16();var s=e.getUint16();var o=e.getUint16();var v=e.getUint16();return{accessClosed:o,accessError:s,localParametersChange:i,remoteParametersChange:a,powerOff:n,restart:r,setClock:v}};var Uo=l;var yo=function(t){var e=new Ui(t,true);return e.getEventStatus()};var Oo=Z;var mo=function(t){var e=new Ui(t);return{temperature:e.getInt16(),frequency:e.getInt16()}};var Po=b;var So=function(t){var e=new Ui(t);return e.getExtendedCurrentValues2()};var Do=M;var Mo=function(t){var e=new Ui(t);var r=t.length>ei;var n=e.getDate();var i=e.getEnergyPeriods(r?ti:Jn);if(r){return{date:n,periods:i,dstHour:e.getUint8()}}return{date:n,periods:i}};var Io=ft;var No=function(t){var e=new Ui(t);var r=t.length>ei;var n=e.getDate();var i=e.getEnergyPeriods(r?ti:Jn);if(r){return{date:n,periods:i,dstHour:e.getUint8()}}return{date:n,periods:i}};var Co=at;var Lo=function(t){var e=new Ui(t);var r=t.length>ei;var n=e.getDate();var i=e.getEnergyPeriods(r?ti:Jn);if(r){return{date:n,periods:i,dstHour:e.getUint8()}}return{date:n,periods:i}};var wo=At;var Fo=function(t){var e=new Ka(t);var r=e.getDate();var n=e.getEnergiesFlags();var i=e.getUint8();var a=e.getUint8();return{date:r,firstHalfhour:i,halfhoursNumber:a,energies:e.getHalfhoursEnergies1(n,a)}};var xo=dt;var Yo=function(t){var e=new Ui(t);return{induction:e.getUint16(),threshold:e.getUint16(),inductionCoefficient:e.getUint16()/100,reserved:e.getUint32()}};var Bo=yt;var Ho=function(t){var e=o(t,1),r=e[0];return{ten:r}};var Wo=N;var bo=function(t){var e=new Ui(t);return{year:e.getUint8(),month:e.getUint8(),energies:e.getEnergies()}};var Go=vt;var Vo=function(t){var e=new Ui(t);return{year:e.getUint8(),month:e.getUint8(),energies:e.getEnergies()}};var zo=K;var Ko=function(t){var e=new Ui(t);return{year:e.getUint8(),month:e.getUint8(),tariffs:e.getMonthMaxPowerByTariffs()}};var Xo=ht;var ko=function(t){var e=new Ui(t);return{year:e.getUint8(),month:e.getUint8(),tariffs:e.getMonthMaxPowerByTariffs()}};var jo=pt;var Qo=function(t){var e=new Ui(t);return e.getOperatorParametersExtended3()};var qo=F;var Zo=function(t){var e=new Ui(t);return e.getOperatorParameters()};var $o=W;var Jo=1+qn*2;var tv=function(t){if(t.length!==Jo){throw new Error("Invalid getRatePlanInfo data size.")}var e=new Ui(t);return{tariffTable:e.getUint8(),activePlan:e.getTariffPlan(),passivePlan:e.getTariffPlan()}};var ev=B;var rv=29;var nv=function(t){if(t.length!==rv){throw new Error("Invalid getSaldo data size.")}var e=new Ui(t);return{currentSaldo:e.getInt32(),count:e.getUint8(),energy:new Array(4).fill(0).map((function(){return e.getInt32()})),beginSaldoOfPeriod:e.getInt32(),date:{month:e.getUint8(),date:e.getUint8(),hours:e.getUint8(),minutes:e.getUint8()}}};var iv=G;var av=37;var sv=function(t){if(t.length!==av){throw new Error("Invalid getSaldoParameters data size.")}var e=new Ui(t);return e.getSaldoParameters()};var ov=J;var vv=function(t){var e=new Ui(t);return e.getSeasonProfile()};var fv=tt;var uv=function(t){var e=new Ui(t);return e.getSpecialDay()};var hv=Y;var Ev=function(t){return{version:String.fromCharCode.apply(null,f(t))}};var gv=D;var _v=0;var lv=function(t){if(t.length!==_v){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var cv=j;var dv=0;var Av=function(t){if(t.length!==dv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Tv=Q;var pv=0;var Rv=function(t){if(t.length!==pv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Uv=nt;var yv=0;var Ov=function(t){if(t.length!==yv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var mv=R;var Pv=0;var Sv=function(t){if(t.length!==Pv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Dv=gt;var Mv=0;var Iv=function(t){if(t.length!==Mv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Nv=w;var Cv=0;var Lv=function(t){if(t.length!==Cv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var wv=p;var Fv=0;var xv=function(t){if(t.length!==Fv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Yv=O;var Bv=0;var Hv=function(t){if(t.length!==Bv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Wv=_t;var bv=0;var Gv=function(t){if(t.length!==bv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Vv=Rt;var zv=0;var Kv=function(t){if(t.length!==zv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Xv=x;var kv=0;var jv=function(t){if(t.length!==kv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var Qv=H;var qv=0;var Zv=function(t){if(t.length!==qv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var $v=V;var Jv=0;var tf=function(t){if(t.length!==Jv){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var ef=m;var rf=0;var nf=function(t){if(t.length!==rf){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var af=P;var sf=0;var of=function(t){if(t.length!==sf){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var vf=ct;var ff=function(t){var e=new Ui(t);var r=e.getUint8();var n=!!(r&1);var i=!!(r&2);return{electroMagneticIndication:n,magneticIndication:i}};var uf=L;var hf=0;var Ef=function(t){if(t.length!==hf){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var gf=C;var _f=0;var lf=function(t){if(t.length!==_f){throw new Error("Wrong buffer size: ".concat(t.length,"."))}return{}};var cf={encrypt:function(){},decrypt:function(){}};var df=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var r=e;t.forEach((function(t){r^=t}));return r};var Af=3;var Tf=2;var pf=2;var Rf=function(t,e){return function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var i=n?.aesKey;var a=[];var s=o(r,2),v=s[0],u=s[1];var h=u&Af;var E={messageId:v,accessLevel:h,commands:a,bytes:r,lrc:{received:undefined,calculated:0}};var g=r.slice(Tf);var l;if(i&&h!==_){g=f(cf.decrypt(i,g))}var c=g[g.length-1];g=g.slice(0,-1);var d=df(g);if(h!==_||c!==0){if(c!==d){l="Mismatch LRC."}}var A=g[0]&Af;var T=g.slice(1);if(h!==A){l="Mismatch access levels."}var p=0;do{var R=T[p];var U=T[p+1];var y=pf+U;var O=T.slice(p+pf,p+y);var m={id:R,name:e[R],headerSize:pf,bytes:T.slice(p,p+y)};if(!R){break}try{if(!t[R]){throw new Error("Unsupported command id: ".concat(R,"!"))}m.parameters=t[R](O,n);a.push(m)}catch(t){a.push({command:m,error:t.message})}p+=y}while(p<=T.length);E.lrc.calculated=d;E.lrc.received=c;if(l){return{message:E,error:l}}return E}};var Uf={};var yf=It;var Of=Rf(Uf,yf);Uf[Nt]=Lt;Uf[qi]=$i;Uf[Ji]=ea;Uf[ra]=na;Uf[Ra]=ya;Uf[Oa]=Pa;Uf[Sa]=Da;Uf[Ma]=Ia;Uf[Ca]=La;Uf[Fa]=xa;Uf[Xa]=ka;Uf[ja]=Qa;Uf[qa]=Za;Uf[$a]=Ja;Uf[ts]=es;Uf[ns]=is;Uf[ls]=cs;Uf[ds]=As;Uf[Ts]=ps;Uf[Zs]=$s;Uf[to]=eo;Uf[no]=io;Uf[so]=oo;Uf[fo]=uo;Uf[go]=co;Uf[po]=Ro;Uf[Uo]=yo;Uf[Oo]=mo;Uf[Po]=So;Uf[Do]=Mo;Uf[Io]=No;Uf[Co]=Lo;Uf[wo]=Fo;Uf[xo]=Yo;Uf[Bo]=Ho;Uf[Wo]=bo;Uf[Go]=Vo;Uf[zo]=Ko;Uf[Xo]=ko;Uf[jo]=Qo;Uf[qo]=Zo;Uf[$o]=tv;Uf[ev]=nv;Uf[iv]=sv;Uf[ov]=vv;Uf[fv]=uv;Uf[hv]=Ev;Uf[gv]=lv;Uf[cv]=Av;Uf[Tv]=Rv;Uf[Uv]=Ov;Uf[mv]=Sv;Uf[Dv]=Iv;Uf[Nv]=Lv;Uf[wv]=xv;Uf[Yv]=Hv;Uf[Wv]=Gv;Uf[Vv]=Kv;Uf[Xv]=jv;Uf[Qv]=Zv;Uf[$v]=tf;Uf[ef]=nf;Uf[af]=of;Uf[vf]=ff;Uf[uf]=Ef;Uf[gf]=lf;var mf=145;var Pf=30;var Sf=function(t){if(t[0]!==Pf){return{}}var e=t[1];var r=t[3];var n=t.slice(4,e+2);if(r===mf){return n}return null};fromBytes=Of;getDataSegment=Sf})();
//#endregion


/*
  Incoming arguments:
    * payload - array of bytes
    * metadata - key/value object
*/

var segment = getDataSegment(payload);
var message = null;

// just a single data segment
if ( segment ) {
    message = fromBytes(segment);

    // there may be a message.error (e.g. mismatched LRC)
    // in that case message.message will contain everything parsed successfully
    // it should be used with caution
}

var result = {
    // required property, set to real device name from payload/metadata depending on integration
    // empty value throw an error in converter
    deviceName: '',

    deviceType: 'Water Meter',
    attributes: {
        model: 'Device Model',
        serialNumber: 'SN111',
        manufacturer: 'Device Manufacturer'
    },
    telemetry: {
        // telemetry display only primitive, i.e. string and numbers
        // for example only!
        message: JSON.stringify(message.message || message)
    },
    metadata: metadata
};

return result;
