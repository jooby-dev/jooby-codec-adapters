// IMPORTANT!!!
// This example only for default uplink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/


//#region [autogenerated jooby-codec bundle from index.js]
var fromBytes,getDataSegment;(function(){"use strict";function r(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,a=Array(t);e<t;e++)a[e]=r[e];return a}function t(r){if(Array.isArray(r))return r}function e(t){if(Array.isArray(t))return r(t)}function a(r,t,e){return(t=s(t))in r?Object.defineProperty(r,t,{value:e,enumerable:true,configurable:true,writable:true}):r[t]=e,r}function n(r){if("undefined"!=typeof Symbol&&null!=r[Symbol.iterator]||null!=r["@@iterator"])return Array.from(r)}function i(r,t){var e=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=e){var a,n,i,v,o=[],E=true,f=false;try{if(i=(e=e.call(r)).next,0===t){if(Object(e)!==e)return;E=!1}else for(;!(E=(a=i.call(e)).done)&&(o.push(a.value),o.length!==t);E=!0);}catch(r){f=true,n=r}finally{try{if(!E&&null!=e.return&&(v=e.return(),Object(v)!==v))return}finally{if(f)throw n}}return o}}function v(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(r,e){return t(r)||i(r,e)||g(r,e)||v()}function f(r){return t(r)||n(r)||g(r)||v()}function u(r){return e(r)||n(r)||g(r)||o()}function _(r,t){if("object"!=typeof r||!r)return r;var e=r[Symbol.toPrimitive];if(void 0!==e){var a=e.call(r,t);if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(r)}function s(r){var t=_(r,"string");return"symbol"==typeof t?t:t+""}function g(t,e){if(t){if("string"==typeof t)return r(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(t,e):void 0}}var A={separator:" ",prefix:""};var l=function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var e=Object.assign({},A,t),a=e.separator,n=e.prefix;return r.map(function(r){return"".concat(n).concat(r.toString(16).padStart(2,"0"))}).join(a)};var c=0;var R=1;var T=2;var h=3;var d=Object.freeze({__proto__:null,READ_ONLY:h,READ_WRITE:T,ROOT:R,UNENCRYPTED:c});var O=1;var U=3;var N=4;var S=5;var I=7;var L=8;var m=9;var D=13;var C=15;var p=16;var P=17;var M=18;var y=19;var F=20;var w=21;var Y=22;var b=23;var G=24;var B=25;var H=28;var W=30;var V=31;var x=40;var z=41;var X=42;var K=44;var j=45;var k=46;var Q=47;var Z=49;var q=50;var $=51;var J=52;var rr=53;var tr=54;var er=57;var ar=58;var nr=59;var ir=60;var vr=61;var or=62;var Er=65;var fr=70;var ur=74;var _r=75;var sr=79;var gr=80;var Ar=82;var lr=83;var cr=88;var Rr=89;var Tr=91;var hr=92;var dr=93;var Or=94;var Ur=100;var Nr=109;var Sr=111;var Ir=112;var Lr=113;var mr=114;var Dr=116;var Cr=117;var pr=118;var Pr=122;var Mr=Object.freeze({__proto__:null,activateRatePlan:y,getBv:Ir,getCorrectTime:or,getCriticalEvent:Er,getCurrentStatusMeter:er,getCurrentValues:D,getDateTime:I,getDayDemand:Y,getDayDemandExport:sr,getDayMaxDemand:Z,getDayMaxDemandExport:cr,getDayMaxDemandPrevious:ur,getDayProfile:nr,getDemand:pr,getDemandParameters:Cr,getDeviceId:S,getDeviceType:N,getDisplayParam:Or,getEnergy:C,getEnergyDayPrevious:U,getEnergyExport:Tr,getEnergyExportDayPrevious:gr,getEventStatus:O,getEvents:$,getEventsCounters:J,getExtendedCurrentValues:ar,getExtendedCurrentValues2:j,getHalfHourDemand:w,getHalfHourDemandExport:lr,getHalfHourDemandPrevious:_r,getHalfHourEnergies:Sr,getMagneticFieldThreshold:Nr,getMeterInfo:Pr,getMonthDemand:b,getMonthDemandExport:Ar,getMonthMaxDemand:q,getMonthMaxDemandExport:Rr,getOperatorParameters:W,getOperatorParametersExtended3:Lr,getRatePlanInfo:K,getSaldo:z,getSaldoParameters:k,getSeasonProfile:ir,getSpecialDay:vr,getVersion:x,prepareRatePlan:F,resetPowerMaxDay:rr,resetPowerMaxMonth:tr,runTariffPlan:fr,setAccessKey:m,setCorrectDateTime:hr,setCorrectTime:H,setDateTime:L,setDayProfile:p,setDemandParameters:Dr,setDisplayParam:dr,setOperatorParameters:V,setOperatorParametersExtended3:mr,setSaldo:X,setSaldoParameters:Q,setSeasonProfile:P,setSpecialDay:M,setSpecialOperation:Ur,turnRelayOff:B,turnRelayOn:G});var yr=120;var Fr=121;var wr=254;var Yr=255;var br=Object.freeze({__proto__:null,activateRatePlan:y,errorDataFrameResponse:Yr,errorResponse:wr,getBv:Ir,getCorrectTime:or,getCriticalEvent:Er,getCurrentStatusMeter:er,getCurrentValues:D,getDateTime:I,getDayDemand:Y,getDayDemandExport:sr,getDayEnergies:yr,getDayMaxDemand:Z,getDayMaxDemandExport:cr,getDayMaxDemandPrevious:ur,getDayMaxPower:Fr,getDayProfile:nr,getDemand:pr,getDemandParameters:Cr,getDeviceId:S,getDeviceType:N,getDisplayParam:Or,getEnergy:C,getEnergyDayPrevious:U,getEnergyExport:Tr,getEnergyExportDayPrevious:gr,getEventStatus:O,getEvents:$,getEventsCounters:J,getExtendedCurrentValues:ar,getExtendedCurrentValues2:j,getHalfHourDemand:w,getHalfHourDemandExport:lr,getHalfHourDemandPrevious:_r,getHalfHourEnergies:Sr,getMagneticFieldThreshold:Nr,getMeterInfo:Pr,getMonthDemand:b,getMonthDemandExport:Ar,getMonthMaxDemand:q,getMonthMaxDemandExport:Rr,getOperatorParameters:W,getOperatorParametersExtended3:Lr,getRatePlanInfo:K,getSaldo:z,getSaldoParameters:k,getSeasonProfile:ir,getSpecialDay:vr,getVersion:x,prepareRatePlan:F,resetPowerMaxDay:rr,resetPowerMaxMonth:tr,runTariffPlan:fr,setAccessKey:m,setCorrectDateTime:hr,setCorrectTime:H,setDateTime:L,setDayProfile:p,setDemandParameters:Dr,setDisplayParam:dr,setOperatorParameters:V,setOperatorParametersExtended3:mr,setSaldo:X,setSaldoParameters:Q,setSeasonProfile:P,setSpecialDay:M,setSpecialOperation:Ur,turnRelayOff:B,turnRelayOn:G});var Gr=function(r){var t={};for(var e in r){var a=r[e];t[a]=e}return t};var Br=Gr(br);var Hr=y;var Wr=0;var Vr=function(r){if(r.length!==Wr){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var xr=0;var zr=128;var Xr=129;var Kr=130;var jr=131;var kr=132;var Qr=133;var Zr=134;var qr=135;var $r=136;var Jr=137;var rt=144;var tt=145;var et=146;var at=147;var nt=149;var it=151;var vt=152;var ot=153;var Et=154;var ft=155;var ut=156;var _t=159;var st=160;var gt=240;var At=Object.freeze({__proto__:null,ACCESS_DENIED:at,BAD_ARRAY_INDEX:Zr,BAD_BLOCK_NUMBER:ut,BAD_DATA_LENGTH:Qr,BAD_MESSAGE:kr,BAD_RATE_PLAN_ID:$r,BAD_RATE_PLAN_SIZE:Jr,BAD_RESPONSE_LENGTH:rt,BAD_SALDO_WRITE:nt,BLOCKED_METER:it,CALIBRATION_DISABLED:et,DECRYPTION_FAILURE:Kr,INTERNAL:gt,INVALID_CORRECTION_INTERVAL:Et,NOT_ALIGNED_DATA:Xr,NOT_PREPARED_RATE_PLAN:qr,NO_DATA_FOR_DATE:tt,OK:xr,OUT_OFF_RANGE:_t,SET_METER_TYPE_FAILURE:st,TIME_CORRECTION_FAILURE:ot,TIME_CORRECTION_OUT_HALF_HOUR_DISABLED:ft,UNENCRYPTED_COMMAND_DISABLED:vt,UNKNOWN_COMMAND:zr,UNKNOWN_PROTOCOL:jr});var lt=Gr(At);var ct=Yr;var Rt=Br[Yr];var Tt=1;var ht=function(r){if(r.length!==Tt){throw new Error("Wrong buffer size: ".concat(r.length,"."))}var t=E(r,1),e=t[0];return{errorCode:e,errorName:lt[e]}};var dt=1;var Ot=2;var Ut=3;var Nt=4;var St=Math.log,It=Math.pow,Lt=Math.LN2;var mt=function(r,t,e,a,n){var i,v,o=n*8-a-1,E=(1<<o)-1,f=E>>1,u=-7,_=e?n-1:0,s=e?-1:1,g=r[t+_];_+=s;i=g&(1<<-u)-1;g>>=-u;u+=o;for(;u>0;i=i*256+r[t+_],_+=s,u-=8);v=i&(1<<-u)-1;i>>=-u;u+=a;for(;u>0;v=v*256+r[t+_],_+=s,u-=8);if(i===0){i=1-f}else if(i===E){return v?NaN:g?-Infinity:Infinity}else{v=v+It(2,a);i=i-f}return(g?-1:1)*v*It(2,i-a)};var Dt=function(r,t,e,a,n,i){var v,o,E,f=i*8-n-1,u=(1<<f)-1,_=u>>1,s=n===23?It(2,-24)-It(2,-77):0,g=a?0:i-1,A=a?1:-1,l=e<0||e===0&&1/e<0?1:0;e<0&&(e=-e);if(e!==e||e===Infinity){o=e!==e?1:0;v=u}else{v=St(e)/Lt|0;if(e*(E=It(2,-v))<1){v--;E*=2}if(v+_>=1){e+=s/E}else{e+=s*It(2,1-_)}if(e*E>=2){v++;E/=2}if(v+_>=u){o=0;v=u}else if(v+_>=1){o=(e*E-1)*It(2,n);v=v+_}else{o=e*It(2,_-1)*It(2,n);v=0}}for(;n>=8;r[t+g]=o&255,g+=A,o/=256,n-=8);v=v<<n|o;f+=n;for(;f>0;r[t+g]=v&255,g+=A,v/=256,f-=8);r[t+g-A]|=l*128};var Ct=[1,0];var pt=[2,1,0];var Pt=[3,2,1,0];var Mt=[0,1];var yt=[0,1,2];var Ft=[0,1,2,3];var wt=function(r,t){return r[t]};var Yt=function(r,t,e){var a=e?Mt:Ct;var n=r[t+a[0]];var i=r[t+a[1]]<<8;return n|i};var bt=function(r,t,e){var a=e?yt:pt;var n=r[t+a[0]];var i=r[t+a[1]]<<8;var v=r[t+a[2]]<<16;return n|i|v};var Gt=function(r,t,e){var a=e?Ft:Pt;var n=r[t+a[3]]*16777216;var i=r[t+a[2]]*65536;var v=r[t+a[1]]*256;var o=r[t+a[0]];return n+i+v+o};var Bt=function(r,t,e){r[t]=e&255};var Ht=function(r,t,e,a){var n=a?Mt:Ct;r[t+n[0]]=e&255;r[t+n[1]]=e>>>8&255};var Wt=function(r,t,e,a){var n=a?yt:pt;r[t+n[0]]=e&255;r[t+n[1]]=e>>>8&255;r[t+n[2]]=e>>>16&255};var Vt=function(r,t,e,a){var n=a?Ft:Pt;r[t+n[0]]=e&255;r[t+n[1]]=e>>>8&255;r[t+n[2]]=e>>>16&255;r[t+n[3]]=e>>>24&255};function xt(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof r==="number"){var e=new Array(r).fill(0);this.data=e}else{this.data=r}this.offset=0;this.isLittleEndian=t}xt.prototype={toUint8Array:function(){return this.data},seek:function(r){if(r<0||r>=this.data.length){throw new Error("Invalid position.")}this.offset=r},setInt8:function(r){Bt(this.data,this.offset,r<0?r|256:r);this.offset+=dt},getInt8:function(){var r=wt(this.data,this.offset);this.offset+=dt;return r&128?r^-256:r},setUint8:function(r){Bt(this.data,this.offset,r);this.offset+=dt},getUint8:function(){var r=wt(this.data,this.offset);this.offset+=dt;return r},setInt16:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Ht(this.data,this.offset,r<0?r|65536:r,t);this.offset+=Ot},getInt16:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=Yt(this.data,this.offset,r);this.offset+=Ot;return t&32768?t^-65536:t},setUint16:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Ht(this.data,this.offset,r,t);this.offset+=Ot},getUint16:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=Yt(this.data,this.offset,r);this.offset+=Ot;return t},setInt24:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Wt(this.data,this.offset,r<0?r|16777216:r,t);this.offset+=Ut},getInt24:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=bt(this.data,this.offset,r);this.offset+=Ut;return t&8388608?t^-16777216:t},setUint24:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Wt(this.data,this.offset,r,t);this.offset+=Ut},getUint24:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=bt(this.data,this.offset,r);this.offset+=Ut;return t},setInt32:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Vt(this.data,this.offset,r<0?r|4294967296:r,t);this.offset+=Nt},getInt32:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=Gt(this.data,this.offset,r);this.offset+=Nt;return t&2147483648?t^-4294967296:t},setUint32:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Vt(this.data,this.offset,r,t);this.offset+=Nt},getUint32:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=Gt(this.data,this.offset,r);this.offset+=Nt;return t},setFloat32:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;Dt(this.data,this.offset,r,t,23,4);this.offset+=Nt},getFloat32:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var t=mt(this.data,this.offset,r,23,4);this.offset+=Nt;return t},setString:function(r){this.setUint8(r.length);for(var t=0;t<r.length;++t){this.setUint8(r.charCodeAt(t))}},getString:function(){var r=this.getUint8();var t=this.offset+r;var e=[];while(this.offset<t){e.push(String.fromCharCode(this.getUint8()))}return e.join("")},getBytesToOffset:function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,r)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=t+r;return this.data.slice(t,this.offset)},setBytes:function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var e=this.data;e.splice.apply(e,[t,r.length].concat(u(r)));this.data=e;this.offset=t+r.length}};Object.defineProperties(xt.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var zt=wr;var Xt=function(r){return function(t){var e=new xt(t,false);var a=e.getUint8();var n=e.getUint8();return{commandId:a,commandName:r[a],errorCode:n,errorName:lt[n]}}};var Kt=Xt(Br);var jt=Ir;var kt=6;var Qt=function(r){if(r.length!==kt){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{vector:r}};var Zt=function(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var e={};for(var a in r){e[a]=(t&r[a])!==0}return e};var qt=function(r,t,e){return(1<<t)-1&r>>e-1};var $t="x";var Jt=[".","1","3","R","M"];var re=[".","A","G","R","T","D"];var te=[".","0","1","2","3","4","5"];var ee=[".","A","B","C","D","E","F"];var ae=[".","A","B","C","D","E","F","H","K","G"];var ne=[".","1","2","3","4"];var ie=[".","L","M","Z","K"];var ve=[".","0","1","2","3","4","5","6","7","8","9"];var oe=[".","D","B","C","E","P","R","O","L","F","S","M","Y","G","N","U"];var Ee=[".","0","1","2","3","4","5","6","P","R","L","E","G","-","/"];var fe=[".","H","A","T","0","0","0","0","0","1","2","3","4","0","0","0"];var ue=[".","0","1","2","3","4","5","6","7","8","I","X","G","W","M","-"];var _e={typeMeterG:1<<0,downgradedToA:1<<4,supportMeterInfo:1<<6};var se={typeMeterTransformer:1<<0,downgradedToR:1<<3,typeMeterG:1<<4,supportMeterInfo:1<<6,reactiveByQuadrants:1<<7};var ge=function(r){var t=Zt(se,r);return{meterType:"mtx3",...t,typeMeterG:!t.typeMeterG}};var Ae=function(r){return[r>>4,r&15]};var le=function(r){var t=new Array(r.length*2).fill(0);r.forEach(function(r,e){var a=Ae(r),n=E(a,2),i=n[0],v=n[1];t[e*2]=i;t[e*2+1]=v});return t};var ce=function(r){if(r.length!==14&&r.length!==16){throw new Error("Device type bytes wrong size")}var t=["MTX "];t.push(Jt[r[0]]??$t);t.push(re[r[1]]??$t);t.push(te[r[2]]??$t);t.push(te[r[3]]??$t);t.push(".");t.push(ee[r[4]]??$t);t.push(ae[r[5]]??$t);t.push(".");t.push(ne[r[6]]??$t);t.push(ie[r[7]]??$t);var e=r[8];t.push(ve[r[9]]??$t);t.push("-");var a;if(r.length<14||r[12]===0&&r[13]===0){t.push(oe[r[10]]??$t);a=11}else if(r[13]===0){t.push(oe[r[10]]??$t);t.push(oe[r[11]]??$t);a=12}else{t.push(oe[r[10]]??$t);t.push(oe[r[11]]??$t);t.push(oe[r[12]]??$t);a=13}var n=r[a];if(n&&n!==0){t.push(fe[n]??$t)}return{type:t.join(""),revision:e}};var Re=function(r){if(r.length<14){throw new Error("The buffer is too small")}var t=["MTX "];var e=r[1]===5?"-":" ";t.push(Jt[r[0]]??$t);t.push(re[r[1]]??$t);t.push(e);for(var a=2;a<r.length;a++){if(r[a]!==0){t.push(Ee[r[a]]??$t)}}return{type:t.join("")}};var Te=function(r){if(r.length<14){throw new Error("The buffer is too small")}var t=[];t.push(Jt[r[0]]??$t);for(var e=1;e<r.length;e++){if(r[e]!==0){t.push(ue[r[e]]??$t)}}return{type:t.join("")}};var he=function(r){if(r.length!==9){throw new Error("The buffer is too small")}var t;var e=[0,5,6,7,9,127,239];var a=e.indexOf(r[0])!==-1?2:0;var n=le(r.slice(0,8));var i=n[a];var v=Jt[i];if(v==="1"||v==="3"){t={...ce(n.slice(a)),descriptor:v==="3"?ge(r[8]):{meterType:"mtx1",...Zt(_e,r[8])}}}else{t=v==="M"?Te(n):Re(n)}return t};var de=80;var Oe=81;var Ue=82;var Ne=83;var Se=84;var Ie=85;var Le=86;var me=87;var De=88;var Ce=89;var pe=90;var Pe=91;var Me=255;var ye=Object.freeze({__proto__:null,DATA_REQUEST:de,DATA_RESPONSE:Oe,FRAGMENT_REQUEST:pe,FRAGMENT_RESPONSE:Pe,IDENT_REQUEST:Ue,IDENT_RESPONSE:Ne,INVALID:Me,L2_CHECK_ADDRESS_REQUEST:Le,L2_CHECK_ADDRESS_RESPONSE:me,L2_RM_ADDRESS_REQUEST:De,L2_RM_ADDRESS_RESPONSE:Ce,L2_SET_ADDRESS_REQUEST:Se,L2_SET_ADDRESS_RESPONSE:Ie});Gr(ye);Gr(d);var Fe=0;var we=1;var Ye=2;var be=3;var Ge=4;var Be=5;var He=6;var We=7;var Ve=8;var xe=9;var ze=10;var Xe=11;var Ke=12;var je=13;var ke=14;var Qe=Object.freeze({__proto__:null,CASE_MODULE_OPEN:ze,CASE_OPEN:Fe,CASE_TERMINAL_OPEN:xe,DEVICE_FAILURE:Ve,ERROR_ACCESS:Be,MAGNETIC_ON:we,PARAMETERS_UPDATE_LOCAL:be,PARAMETERS_UPDATE_REMOTE:Ye,PROTECTION_RESET_EM:je,PROTECTION_RESET_MAGNETIC:ke,RESTART:Ge,TARIFF_TABLE_GET:Ke,TARIFF_TABLE_SET:Xe,TIME_CORRECT:We,TIME_SET:He});var Ze=Gr(Qe);Gr(Mr);var qe=1;var $e=2;var Je=3;var ra=16;var ta=17;var ea=18;var aa=19;var na=20;var ia=21;var va=32;var oa=33;var Ea=34;var fa=35;var ua=36;var _a=37;var sa=38;var ga=39;var Aa=40;var la=41;var ca=49;var Ra=50;var Ta=51;var ha=52;var da=53;var Oa=54;var Ua=55;var Na=56;var Sa=57;var Ia=60;var La=61;var ma=62;var Da=63;var Ca=64;var pa=65;var Pa=66;var Ma=67;var ya=68;var Fa=69;var wa=70;var Ya=71;var ba=72;var Ga=73;var Ba=74;var Ha=75;var Wa=76;var Va=77;var xa=78;var za=79;var Xa=80;var Ka=81;var ja=82;var ka=83;var Qa=84;var Za=85;var qa=86;var $a=87;var Ja=88;var rn=89;var tn=96;var en=97;var an=98;var nn=99;var vn=100;var on=101;var En=102;var fn=103;var un=104;var _n=105;var sn=112;var gn=113;var An=114;var ln=115;var cn=116;var Rn=117;var Tn=118;var hn=119;var dn=120;var On=121;var Un=122;var Nn=123;var Sn=124;var In=125;var Ln=126;var mn=144;var Dn=145;var Cn=147;var pn=148;var Pn=152;var Mn=156;var yn=157;var Fn=158;var wn=159;var Yn=160;var bn=161;var Gn=162;var Bn=176;var Hn=177;var Wn=178;var Vn=179;var xn=180;var zn=181;var Xn=182;var Kn=183;var jn=185;var kn=186;var Qn=224;var Zn=225;var qn=226;var $n=227;var Jn=228;var ri=229;var ti=230;var ei=231;var ai=232;var ni=Object.freeze({__proto__:null,ACCESS_ERROR:ta,ACCESS_LOCKED:ra,ACC_PARAMETERS_EXT_FAULT:ln,ACC_PARAMETERS_FAULT:An,BAD_TEST_EEPROM:un,BAD_TEST_FRAM:_n,BATTERY_FAULT:ka,BATTERY_OK:ja,BIPOLAR_POWER_FAULT:xn,BIPOLAR_POWER_OK:zn,BLOCK_TARIFF_FAULT:Rn,CALC_PERIOD_FAULT:cn,CALIBRATION_FAULT:Za,CALIBRATION_FLAG_RESET:fn,CALIBRATION_FLAG_SET:En,CALIBRATION_OK:Qa,CALIBRATION_PARAMETERS_FAULT:Tn,CASE_CLOSED:aa,CASE_MODULE_CLOSED:In,CASE_MODULE_OPENED:Sn,CASE_OPENED:ea,CASE_TERMINAL_BOX_CLOSED:Nn,CASE_TERMINAL_BOX_OPENED:Un,CHANGE_ACCESS_KEY0:va,CHANGE_ACCESS_KEY1:oa,CHANGE_ACCESS_KEY2:Ea,CHANGE_ACCESS_KEY3:fa,CHANGE_COR_TIME:la,CHANGE_PARAMETERS_CHANNEL:jn,CHANGE_PARAMETERS_LOCAL:ua,CHANGE_PARAMETERS_REMOTE:_a,CHANGE_TARIFF_TABLE:Ra,CHANGE_TARIFF_TABLE_2:Pn,CLOCK_FAULT:$a,CLOCK_OK:qa,CMD_RELAY_2_OFF:en,CMD_RELAY_2_ON:tn,CMD_RELAY_OFF:Aa,CMD_RELAY_ON:ga,CMD_SET_DATETIME:sa,CROSS_ZERO_EN_T1:an,CROSS_ZERO_EN_T2:nn,CROSS_ZERO_EN_T3:vn,CROSS_ZERO_EN_T4:on,CROSS_ZERO_EXPORT_EN_T1:Fn,CROSS_ZERO_EXPORT_EN_T2:wn,CROSS_ZERO_EXPORT_EN_T3:Yn,CROSS_ZERO_EXPORT_EN_T4:bn,CURRENT_UNEQUAL_FAULT:Wn,CURRENT_UNEQUAL_OK:Vn,EM_MAGNETIC_INFLUENCE_OFF:Hn,EM_MAGNETIC_INFLUENCE_ON:Bn,ENERGY_REGISTER_FAULT:qe,ENERGY_REGISTER_OVERFLOW:ca,F_MAX_OK:ba,F_MAX_OVER:Ga,F_MIN_OK:Ba,F_MIN_OVER:Ha,I_MAX_OK:Wa,I_MAX_OVER:Va,MAGNETIC_INFLUENCE_OFF:ia,MAGNETIC_INFLUENCE_ON:na,OPERATOR_PARAMETERS_VALUES_FAULT:Je,POWER_A_OFF:Ja,POWER_A_ON:rn,POWER_B_OFF:La,POWER_B_ON:Ia,POWER_C_OFF:Da,POWER_C_ON:ma,POWER_GOOD_DIO:Ln,POWER_OVER_RELAY_OFF:yn,POWER_SALDO_OK:Xa,POWER_SALDO_OVER:Ka,P_MAX_A_MINUS_OK:ei,P_MAX_A_MINUS_OVER:ai,P_MAX_OK:xa,P_MAX_OVER:za,RELAY_HARD_BAD_OFF:mn,RELAY_HARD_BAD_ON:Cn,RELAY_HARD_OFF:pn,RELAY_HARD_ON:Dn,RELAY_OFF:Ua,RELAY_OFF_BAD_SALDO:kn,RELAY_ON:Oa,RESET_EM_FLAG:Xn,RESET_MAGNET_FLAG:Kn,RESTART:Na,SALDO_EN_FAULT:dn,SALDO_PARAMETERS_FAULT:gn,SET_DEMAND_EN_10MIN:$n,SET_DEMAND_EN_15MIN:Jn,SET_DEMAND_EN_1MIN:Qn,SET_DEMAND_EN_30MIN:ri,SET_DEMAND_EN_3MIN:Zn,SET_DEMAND_EN_5MIN:qn,SET_DEMAND_EN_60MIN:ti,SET_NEW_SALDO:sn,SET_SALDO_PARAM:Mn,SET_TARIFF_TABLE:Ta,SUMMER_TIME:ha,TIME_CORRECT:On,TIME_CORRECT_NEW:Gn,T_MAX_OK:ya,T_MAX_OVER:Fa,T_MIN_OK:wa,T_MIN_OVER:Ya,VENDOR_PAR_FAULT:$e,V_MAX_OK:Ca,V_MAX_OVER:pa,V_MIN_OK:Pa,V_MIN_OVER:Ma,WATCHDOG_RESTART:Sa,WINTER_SUMMER_FAULT:hn,WINTER_TIME:da});var ii=Gr(ni);var vi=1;var oi=2;var Ei=3;var fi=4;var ui=5;var _i=6;var si=7;var gi=8;var Ai=9;var li=10;var ci=11;var Ri=12;var Ti=13;var hi=14;var di=15;var Oi=16;var Ui=17;var Ni=18;var Si=19;var Ii=20;var Li=21;var mi=22;var Di=23;var Ci=24;var pi=25;var Pi=26;var Mi=28;var yi=30;var Fi=31;var wi=Object.freeze({__proto__:null,ACTIVE_ENERGY_T1:fi,ACTIVE_ENERGY_T2:ui,ACTIVE_ENERGY_T3:_i,ACTIVE_ENERGY_T4:si,ACTIVE_POWER_IN_NEUTRAL:Ai,ACTIVE_POWER_PER_PHASE:gi,BATTERY_VOLTAGE:mi,CURRENT_BALANCE:yi,CURRENT_IN_NEUTRAL:ci,CURRENT_IN_PHASE:li,DATE_MONTH_YEAR:hi,EXPORTED_ACTIVE_ENERGY_T1:Oi,EXPORTED_ACTIVE_ENERGY_T2:Ui,EXPORTED_ACTIVE_ENERGY_T3:Ni,EXPORTED_ACTIVE_ENERGY_T4:Si,HOUR_MINUTE_SECOND:Ti,MAGNET_INDUCTION:Mi,OPTOPORT_SPEED:Fi,POWER_FACTOR_PHASE_A:Ii,POWER_FACTOR_PHASE_B:Li,POWER_THRESHOLD_T1:Di,POWER_THRESHOLD_T2:Ci,POWER_THRESHOLD_T3:pi,POWER_THRESHOLD_T4:Pi,SET_ALL_SEGMENT_DISPLAY:vi,SOFTWARE_VERSION:oi,TOTAL_ACTIVE_ENERGY:Ei,TOTAL_EXPORTED_ACTIVE_ENERGY:di,VOLTAGE:Ri});Gr(wi);var Yi=2400;var bi=9600;var Gi={rs485orTwi:{0:bi,2:Yi,4:bi},optoport:{0:Yi,2:Yi,4:bi}};({rs485orTwi:Gr(Gi.rs485orTwi),optoport:Gr(Gi.optoport)});var Bi=1;var Hi=2;var Wi=11;var Vi=7;var xi=4;var zi=48;var Xi=50;var Ki=3+zi*2;var ji={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_FACTOR_PHASE_A:524288,POWER_FACTOR_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var ki={...ji,AUTO_SCREEN_SCROLLING:2147483648};var Qi={...ji,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var Zi={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_1:8,RELAY_ON_TARIFF_2:16,RELAY_ON_TARIFF_3:32,RELAY_ON_TARIFF_4:64,RELAY_ON_V_GOOD:128};var qi={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_1:4,RELAY_OFF_TARIFF_2:8,RELAY_OFF_TARIFF_3:16,RELAY_OFF_TARIFF_4:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var $i={RELAY_OFF_LIM_TARIFF_1:2,RELAY_OFF_LIM_TARIFF_2:4,RELAY_OFF_LIM_TARIFF_3:8,RELAY_OFF_LIM_TARIFF_4:16,RELAY_OFF_PF_MIN:32};var Ji={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var rv={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var tv={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var ev={CASE_OPEN:2**0,MAGNETIC_ON:2**1,PARAMETERS_UPDATE_REMOTE:2**2,PARAMETERS_UPDATE_LOCAL:2**3,RESTART:2**4,ERROR_ACCESS:2**5,TIME_SET:2**6,TIME_CORRECT:2**7,DEVICE_FAILURE:2**8,CASE_TERMINAL_OPEN:2**9,CASE_MODULE_OPEN:2**10,TARIFF_TABLE_SET:2**11,TARIFF_TABLE_GET:2**12,PROTECTION_RESET_EM:2**13,PROTECTION_RESET_MAGNETIC:2**14};var av={RELAY_STATE:2**0,RELAY_UBAD:2**1,RELAY_UNEQ_CURRENT:2**4,RELAY_OFF_CENTER:2**5,RELAY_IMAX:2**6,RELAY_PMAX:2**7};var nv={RELAY_COSFI:2**0,RELAY_SALDO_OFF_FLAG:2**1,RELAY_UNEQUAL_CURRENT_OFF:2**2,RELAY_BIPOLAR_POWER_OFF:2**3,RELAY_SALDO_OFF_ON_MAX_POWER:2**4,RELAY_HARD_ST1:2**5,RELAY_MAGNET_OFF:2**6,RELAY_P_MINUS_MAX_OFF:2**7};var iv={MAXVA:2**0,MINVA:2**1,MAXT:2**2,MINT:2**3,MAXF:2**4,MINF:2**5,MAXIA:2**6,MAXP:2**7};var vv={MAX_POWER_SALDO:2**0,BATTERY_VBAT_BAD:2**1,CLOCK_UNSET:2**3,MIN_COS_FI:2**5};var ov={UNEQUAL_CURRENT:2**0,BIPOLAR_POWER:2**1,POWER_A_NEGATIVE:2**6,POWER_B_NEGATIVE:2**7};var Ev={RELAY_OFF_LIMIT_P_MINUS_T1:8,RELAY_OFF_LIMIT_P_MINUS_T2:16,RELAY_OFF_LIMIT_P_MINUS_T3:32,RELAY_OFF_LIMIT_P_MINUS_T4:64};var fv=function(r){return{rs485orTwi:Gi.rs485orTwi[qt(r,4,1)],optoport:Gi.optoport[qt(r,4,5)]}};function uv(r,t,e){var a=e>>xi;var n=new Array(xi).fill(0);n.forEach(function(t,e){var i=!!qt(a,1,e+1);if(i){n[e]=r.getInt32()}else{n[e]=null}});return n}function _v(r){if(r===65535){return{tariff:undefined,energy:undefined}}return{tariff:r>>14&3,energy:r&16383}}var sv=function(r){return{tariff:qt(r,2,1),isFirstHalfHour:!qt(r,1,3),hour:qt(r,5,4)}};var gv=function(r){var t=l(r.getBytes(3),{separator:""});var e=r.getUint8();var a=r.getUint8();var n=l(r.getBytes(3),{separator:""});return{manufacturer:t,type:e,year:a,serial:n}};var Av=function(r){return{isSummerTime:!!r.getUint8(),seconds:r.getUint8(),minutes:r.getUint8(),hours:r.getUint8(),day:r.getUint8(),date:r.getUint8(),month:r.getUint8(),year:r.getUint8()}};var lv=function(r){return{id:r.getUint32(),tariffSet:r.getUint8(),activateYear:r.getUint8(),activateMonth:r.getUint8(),activateDay:r.getUint8(),specialProfilesArraySize:r.getUint8(),seasonProfilesArraySize:r.getUint8(),dayProfilesArraySize:r.getUint8()}};var cv=function(r){return{monthTransitionSummer:r.getUint8(),dateTransitionSummer:r.getUint8(),hoursTransitionSummer:r.getUint8(),hoursCorrectSummer:r.getUint8(),monthTransitionWinter:r.getUint8(),dateTransitionWinter:r.getUint8(),hoursTransitionWinter:r.getUint8(),hoursCorrectWinter:r.getUint8(),isCorrectionNeeded:r.getUint8()===1}};var Rv=function(r){return{month:r.getUint8(),date:r.getUint8(),dayIndexes:new Array(Vi).fill(0).map(function(){return r.getUint8()})}};var Tv=function(r){return{month:r.getUint8(),date:r.getUint8(),dayIndex:r.getUint8(),year:r.getUint8()}};var hv=function(r){return he(r.getBytes(9))};var dv=function(r){var t={vpThreshold:r.getUint32(),vThreshold:r.getUint32(),ipThreshold:r.getUint32(),pmaxThreshold0:r.getUint32(),pmaxThreshold1:r.getUint32(),pmaxThreshold2:r.getUint32(),pmaxThreshold3:r.getUint32(),serialPortsSpeed:fv(r.getUint8()),tint:r.getUint8(),calcPeriodDate:r.getUint8(),timeoutDisplay:r.getUint8(),timeoutScreen:r.getUint8(),displaySet:Zt(ki,r.getUint32()),relaySet4:Zt(Ji,r.getUint8()),relaySet3:Zt($i,r.getUint8()),relaySet2:Zt(qi,r.getUint8()),relaySet1:Zt(Zi,r.getUint8()),displayType:r.getUint8(),ten:r.getUint8(),timeoutRefresh:r.getUint16(),deltaCorMin:r.getUint8(),timeoutMagnetOff:r.getUint8(),timeoutMagnetOn:r.getUint8(),define1:Zt(tv,r.getUint8()),timeoutRelayOn:r.getUint8(),timeoutRelayKey:r.getUint8(),timeoutRelayAuto:r.getUint8(),timeoutBadVAVB:r.getUint8(),freqMax:r.getUint8(),freqMin:r.getUint8(),phMin:r.getUint16(),year:r.getUint8(),month:r.getUint8(),date:r.getUint8(),energyDecimalPoint:r.getUint8(),typeMeter:r.getUint8(),timeoutIMax:r.getUint8(),timeoutPMax:r.getUint8(),timeoutCos:r.getUint8(),pMaxDef:r.getUint8(),displaySetExt:Zt(Qi,r.getUint32()),timeoutUneqCurrent:r.getUint8(),timeoutBipolarPower:r.getUint8(),relaySet5:Zt(rv,r.getUint8()),timeCorrectPeriod:0,timeCorrectPassHalfhour:false};var e=r.getUint8();t.timeCorrectPeriod=e&127;t.timeCorrectPassHalfhour=!!(e&128);return t};var Ov=function(r){var t=r.getUint8();var e=qt(t,xi,1);var a=uv(r,e,t);return{energyType:e,energies:a}};var Uv=function(r){return new Array(xi).fill(0).map(function(){return r.getInt32()})};var Nv=function(r){return{year:r.getUint8(),month:r.getUint8(),date:r.getUint8()}};var Sv=function(r){return{coefficients:new Array(4).fill(0).map(function(){return r.getUint32()}),decimalPointTariff:r.getUint8(),indicationThreshold:r.getInt32(),relayThreshold:r.getInt32(),mode:r.getUint8(),saldoOffTimeBegin:r.getUint8(),saldoOffTimeEnd:r.getUint8(),decimalPointIndication:r.getUint8(),powerThreshold:r.getUint32(),creditThreshold:r.getInt32()}};var Iv=function(r,t){var e=new Array(t).fill(0).map(function(){return r.getUint16()});return e.map(function(r){return _v(r)})};var Lv=function(r){var t=r.getUint16();return Zt(ev,t)};var mv=function(r){var t=r.getUint16();var e=Zt(av,r.getUint8());var a=Zt(nv,r.getUint8());var n=Zt(iv,r.getUint8());var i=Zt(vv,r.getUint8());var v=Zt(ov,r.getUint8());return{uBattery:t,relayStatus:e,relayStatus2:a,status1:n,status2:i,status3:v}};var Dv=function(r){var t={hours:r.getUint8(),minutes:r.getUint8(),seconds:r.getUint8(),event:r.getUint8()};var e=t.event;var a=r.bytesLeft;t.eventName=ii[e];switch(e){case yn:if(a<4){return t}t.power=[r.getUint8(),r.getUint8(),r.getUint8(),r.getUint8()];break;case sa:case On:if(a<8){return t}t.newDate=Av(r);break}return t};var Cv=function(r){var t=r.getUint8();var e=r.getUint8();return{date:{year:t>>1,month:t<<3&15|e>>5,date:e&31},demandType:r.getUint8(),firstIndex:r.getUint16(),count:r.getUint8(),period:r.getUint8()}};var pv=function(r){var t=r.getUint8();var e=r.getUint8();var a=r.getUint8();return{channelParam1:t,counterInterval:e,channelParam2:a}};var Pv=function(r){var t=Nv(r);var e=new Array(xi).fill(0).map(function(){return{hours:r.getUint8(),minutes:r.getUint8(),power:r.getUint32()}});return{date:t,power:e}};var Mv=function(r){return{pmaxMinusThreshold0:r.getUint32(),pmaxMinusThreshold1:r.getUint32(),pmaxMinusThreshold2:r.getUint32(),pmaxMinusThreshold3:r.getUint32(),relaySet:Zt(Ev,r.getUint8())}};var yv=function(r){return new Array(xi).fill(0).map(function(){return{date:r.getUint8(),hours:r.getUint8(),minutes:r.getUint8(),power:r.getUint32()}})};var Fv=or;var wv=function(r){var t=new xt(r,false);return cv(t)};var Yv=Er;var bv=9;var Gv=function(r){if(r.length!==bv){throw new Error("Wrong buffer size: ".concat(r.length,"."))}var t=E(r,9),e=t[0],a=t[1],n=t[2],i=t[3],v=t[4],o=t[5],f=t[6],u=t[7],_=t[8];return{event:e,name:Ze[e],index:a,date:{year:n,month:i,date:v,hours:o,minutes:f,seconds:u},count:_}};var Bv=er;var Hv={calibrationEnable:1,hardkey:2,keyPressTest:4,keyOpenkeyTest:8,keyGerkonTest:16,keyOpenKlemaTest:32,keyOpenModuleTest:64,keyPress2Test:128};var Wv=function(r){var t=new xt(r,false);var e=t.getUint32();var a=t.getUint32();var n=t.getUint32();var i=t.getUint32();t.getUint32();var v=t.getUint32();var o=Zt(av,t.getUint8());var E=t.getUint8();var f=t.getUint8();var u=Zt(Hv,t.getUint8());var _={"A+":t.getUint8(),"A-":t.getUint8()};var s=!!(t.getUint8()&1);var g=E|f<<8;return{operatingSeconds:e,tbadVAVB:a,tbadImaxAll:n,tbadPmaxAll:i,tbadFREQ:v,relayStatus:o,statusEvent:Zt(ev,g),calibrationFlags:u,currentTariffs:_,isSummerTime:s}};var Vv=D;var xv=function(r){var t=new xt(r,false);return{powerA:t.getInt32(),iaRms:t.getInt32(),vavbRms:t.getInt32(),varA:t.getInt32(),pfA:t.getInt16()/1e3,ibRms:t.getInt32(),powerB:t.getInt32(),varB:t.getInt32(),pfB:t.getInt16()/1e3}};var zv=I;var Xv=function(r){var t=new xt(r,false);return Av(t)};var Kv=19;var jv=Y;var kv=function(r){var t=new xt(r,false);var e;if(r.length===Kv){e={date:Nv(t),energies:Uv(t)}}else{e={date:Nv(t),...Ov(t)}}return e};var Qv=19;var Zv=sr;var qv=function(r){var t=new xt(r,false);var e;if(r.length===Qv){e={date:Nv(t),energies:Uv(t)}}else{e={date:Nv(t),...Ov(t)}}return e};var $v=4;var Jv=["A+","A+R+","A+R-","A-","A-R+","A-R-"];var ro=4294967295;var to={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var eo=function(r){return r<$v?1<<r:0};var ao=function(r){return r<$v?1<<r<<4:0};var no=function(r){var t=r.getUint8();var e=r.getUint8();return{year:t>>1,month:t<<3&15|e>>5,date:e&31}};var io=function(r){var t=r.getUint8();return Zt(to,t)};var vo=function(r,t){var e=[];for(var a=0;a<t;a++){var n=r.getUint16();var i=n>>14&3;var v=n&16383;e.push(n===ro?undefined:{tariff:i,energy:v})}return e};var oo=function(r,t,e){var a={};Jv.forEach(function(n){if(t[n]){a[n]=vo(r,e)}});return a};var Eo=function(r,t){var e={};if(t&to["A+"]){e["A+"]=r.getUint32()}if(t&to["A+R+"]){e["A+R+"]=r.getUint32()}if(t&to["A+R-"]){e["A+R-"]=r.getUint32()}return e};var fo=function(r,t){var e={};if(t&to["A-"]){e["A-"]=r.getUint32()}if(t&to["A-R+"]){e["A-R+"]=r.getUint32()}if(t&to["A-R-"]){e["A-R-"]=r.getUint32()}return e};var uo=function(r){var t=r.getUint8();var e=r.getUint8();var a=new Array($v).fill(null);for(var n=0;n<$v;n++){if(e&eo(n)){a[n]=Eo(r,t)}}for(var i=0;i<$v;i++){if(e&ao(i)){a[i]={...a[i],...fo(r,t)}}}return a};var _o=function(r){return{hours:r.getUint8(),minutes:r.getUint8(),power:r.getUint32()}};var so=function(r,t){var e={};if(t&to["A+"]){e["A+"]=_o(r)}if(t&to["A+R+"]){e["A+R+"]=_o(r)}if(t&to["A+R-"]){e["A+R-"]=_o(r)}return e};var go=function(r,t){var e={};if(t&to["A-"]){e["A-"]=_o(r)}if(t&to["A-R+"]){e["A-R+"]=_o(r)}if(t&to["A-R-"]){e["A-R-"]=_o(r)}return e};var Ao=function(r){var t=r.getUint8();var e=r.getUint8();var a=new Array($v).fill(null);for(var n=0;n<$v;n++){if(e&eo(n)){a[n]=so(r,t)}}for(var i=0;i<$v;i++){if(e&ao(i)){a[i]={...a[i],...go(r,t)}}}return a};var lo=yr;var co=function(r){var t=new xt(r,false);return{date:no(t),energies:uo(t)}};var Ro=Z;var To=function(r){var t=new xt(r,false);return Pv(t)};var ho=cr;var Oo=function(r){var t=new xt(r,false);return Pv(t)};var Uo=ur;var No=function(r){var t=new xt(r,false);return Pv(t)};var So=Fr;var Io=function(r){var t=new xt(r,false);return{date:no(t),tariffs:Ao(t)}};var Lo=255;var mo=nr;var Do=function(r){var t=r.indexOf(Lo);var e=t===-1?r:r.slice(0,t);return{periods:u(e).map(sv)}};var Co=7;var po=25;var Po=function(r,t,e){return Math.trunc((r*60+t)/e)};var Mo=function(r){return Po(po,0,r)};var yo=function(r,t,e){if(r===65535){return null}var a=Mo(e);if(t===a){return{lastSummerHour:r>>8&255}}return e===60?{energy:r}:{tariff:r>>14&3,energy:r&16383}};var Fo=function(r,t){var e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:30;return r.reduce(function(r,a,n){r.push(yo(a,(t??0)+n,e));return r},[])};var wo=function(r,t,e){if(r===65535){return 65535}var a=Mo(e);return t===a?{lastSummerHour:r>>8&255}:{voltage:r}};var Yo=function(r,t){var e=arguments.length>2&&arguments[2]!==undefined?arguments[2]:30;return r.reduce(function(r,a,n){r.push(wo(a,(t??0)+n,e));return r},[])};var bo=pr;var Go=function(r){if(!r||r.length<Co){throw new Error("Invalid uplink GetDemand byte length.")}var t=new xt(r,false);var e=Cv(t);if(r.length!==Co+2*e.count){throw new Error("Invalid uplink GetDemand demands byte length.")}var a=new Array(e.count).fill(0).map(function(){return t.getUint16()});var n=e.demandType===Bi||e.demandType===Hi;e.demands=n?Fo(a,e.firstIndex,e.period):Yo(a,e.firstIndex,e.period);return e};var Bo=function(r,t,e){if(!r){throw new Error("Command name is required.")}if(t&&!Array.isArray(t)){throw new Error("Invalid payload for ".concat(r,". Expected array, got: ").concat(typeof t,"."))}if(t.length!==e){var a=l(t,{separator:""});throw new Error("Wrong buffer size for ".concat(r,": ").concat(t.length,". Expected: ").concat(e,". Payload: 0x").concat(a,"."))}};var Ho=Cr;var Wo=Br[Cr];var Vo=4;var xo=function(r){Bo(Wo,r,Vo);var t=new xt(r,false);return pv(t)};var zo=S;var Xo=function(r){var t=new xt(r,false);return gv(t)};var Ko=N;var jo=function(r){var t=new xt(r,false);return hv(t)};var ko=Or;var Qo=function(t){var e=f(t),a=e[0],n=r(e).slice(1);return{displayMode:a,order:n}};var Zo=16;var qo=C;var $o=function(r){var t=new xt(r,false);var e;if(r.length===Zo){e={energies:Uv(t)}}else{e=Ov(t)}return e};var Jo=19;var rE=U;var tE=function(r){var t=new xt(r,false);var e;if(r.length===Jo){e={date:Nv(t),energies:Uv(t)}}else{e={date:Nv(t),...Ov(t)}}return e};var eE=16;var aE=Tr;var nE=function(r){var t=new xt(r,false);var e;if(r.length===eE){e={energies:Uv(t)}}else{e=Ov(t)}return e};var iE=19;var vE=gr;var oE=function(r){var t=new xt(r,false);var e;if(r.length===iE){e={date:Nv(t),energies:Uv(t)}}else{e={date:Nv(t),...Ov(t)}}return e};var EE=3+1;var fE=4;var uE=$;var _E=EE+255*fE;var sE=function(r){return function(t){if(t.length>_E){throw new Error("Wrong buffer size: ".concat(t.length,"."))}var e=new r(t,false);var a=Nv(e);var n=e.getUint8();var i=[];while(!e.isEmpty){i.push(Dv(e))}return{date:a,eventsNumber:n,events:i}}};var gE=sE(xt);var AE=14;var lE=20;var cE=J;var RE=function(r){if(r.length!==AE&&r.length!==lE){throw new Error("Wrong buffer size: ".concat(r.length,"."))}var t=new xt(r,false);var e=t.getUint16();var a=t.getUint16();var n=t.getUint16();var i=t.getUint16();var v=t.getUint16();var o=t.getUint16();var E=t.getUint16();return{accessClosed:o,accessError:v,localParametersChange:n,remoteParametersChange:i,powerOff:a,restart:e,setClock:E}};var TE=O;var hE=function(r){var t=new xt(r,true);return Lv(t)};var dE=ar;var OE=function(r){var t=new xt(r,false);return{temperature:t.getInt16(),frequency:t.getInt16()}};var UE=j;var NE=function(r){var t=new xt(r,false);return mv(t)};var SE=w;var IE=function(r){var t=new xt(r,false);var e=r.length>Ki;var a=Nv(t);var n=Iv(t,e?Xi:zi);if(e){return{date:a,periods:n,dstHour:t.getUint8()}}return{date:a,periods:n}};var LE=lr;var mE=function(r){var t=new xt(r,false);var e=r.length>Ki;var a=Nv(t);var n=Iv(t,e?Xi:zi);if(e){return{date:a,periods:n,dstHour:t.getUint8()}}return{date:a,periods:n}};var DE=_r;var CE=function(r){var t=new xt(r,false);var e=r.length>Ki;var a=Nv(t);var n=Iv(t,e?Xi:zi);if(e){return{date:a,periods:n,dstHour:t.getUint8()}}return{date:a,periods:n}};var pE=Sr;var PE=function(r){var t=new xt(r,false);var e=no(t);var a=io(t);var n=t.getUint8();var i=t.getUint8();return{date:e,firstHalfhour:n,halfhoursNumber:i,energies:oo(t,a,i)}};var ME=Nr;var yE=function(r){var t=new xt(r,false);return{induction:t.getUint16(),threshold:t.getUint16(),inductionCoefficient:t.getUint16()/100,reserved:t.getUint32()}};var FE=Pr;var wE=function(r){var t=E(r,1),e=t[0];return{ten:e}};var YE=b;var bE=function(r){var t=new xt(r,false);return{year:t.getUint8(),month:t.getUint8(),energies:Uv(t)}};var GE=Ar;var BE=function(r){var t=new xt(r,false);return{year:t.getUint8(),month:t.getUint8(),energies:Uv(t)}};var HE=q;var WE=function(r){var t=new xt(r,false);return{year:t.getUint8(),month:t.getUint8(),tariffs:yv(t)}};var VE=Rr;var xE=function(r){var t=new xt(r,false);return{year:t.getUint8(),month:t.getUint8(),tariffs:yv(t)}};var zE=W;var XE=function(r){var t=new xt(r,false);return dv(t)};var KE=Lr;var jE=function(r){var t=new xt(r,false);return Mv(t)};var kE=K;var QE=1+Wi*2;var ZE=function(r){if(r.length!==QE){throw new Error("Invalid getRatePlanInfo data size.")}var t=new xt(r,false);return{tariffTable:t.getUint8(),activePlan:lv(t),passivePlan:lv(t)}};var qE=z;var $E=29;var JE=function(r){if(r.length!==$E){throw new Error("Invalid getSaldo data size.")}var t=new xt(r,false);return{currentSaldo:t.getInt32(),count:t.getUint8(),energy:new Array(4).fill(0).map(function(){return t.getInt32()}),beginSaldoOfPeriod:t.getInt32(),date:{month:t.getUint8(),date:t.getUint8(),hours:t.getUint8(),minutes:t.getUint8()}}};var rf=k;var tf=37;var ef=function(r){if(r.length!==tf){throw new Error("Invalid getSaldoParameters data size.")}var t=new xt(r,false);return Sv(t)};var af=ir;var nf=function(r){var t=new xt(r,false);return Rv(t)};var vf=vr;var of=function(r){var t=new xt(r,false);return Tv(t)};var Ef=x;var ff=function(r){return{version:String.fromCharCode.apply(null,u(r))}};var uf=F;var _f=0;var sf=function(r){if(r.length!==_f){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var gf=rr;var Af=0;var lf=function(r){if(r.length!==Af){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var cf=tr;var Rf=0;var Tf=function(r){if(r.length!==Rf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var hf=fr;var df=0;var Of=function(r){if(r.length!==df){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var Uf=m;var Nf=0;var Sf=function(r){if(r.length!==Nf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var If=hr;var Lf=0;var mf=function(r){if(r.length!==Lf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var Df=H;var Cf=0;var pf=function(r){if(r.length!==Cf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var Pf=L;var Mf=0;var yf=function(r){if(r.length!==Mf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var Ff=p;var wf=0;var Yf=function(r){if(r.length!==wf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var bf=Dr;var Gf=Br[Dr];var Bf=0;var Hf=function(r){Bo(Gf,r,Bf);return{}};var Wf=dr;var Vf=0;var xf=function(r){if(r.length!==Vf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var zf=V;var Xf=0;var Kf=function(r){if(r.length!==Xf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var jf=mr;var kf=0;var Qf=function(r){if(r.length!==kf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var Zf=X;var qf=0;var $f=function(r){if(r.length!==qf){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var Jf=Q;var ru=0;var tu=function(r){if(r.length!==ru){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var eu=P;var au=0;var nu=function(r){if(r.length!==au){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var iu=M;var vu=0;var ou=function(r){if(r.length!==vu){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var Eu=Ur;var fu=function(r){var t=new xt(r,false);var e=t.getUint8();var a=!!(e&1);var n=!!(e&2);return{electroMagneticIndication:a,magneticIndication:n}};var uu=B;var _u=0;var su=function(r){if(r.length!==_u){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var gu=G;var Au=0;var lu=function(r){if(r.length!==Au){throw new Error("Wrong buffer size: ".concat(r.length,"."))}return{}};var cu={encrypt:function(){},decrypt:function(){}};var Ru=function(r){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var e=t;r.forEach(function(r){e^=r});return e};var Tu=2;var hu=2;var du=function(r){var t=E(r,1),e=t[0];if(e===ct){try{var a=ht(r.slice(Tu));return{id:e,name:Rt,headerSize:Tu,bytes:r,parameters:a}}catch{return null}}return null};var Ou=function(r,t){var e=E(t,1),a=e[0];var n=du(t.slice(hu-1));var i=du(t.slice(hu));var v={messageId:a,bytes:t};if(n){return{...v,accessLevel:c,commands:[n]}}if(i){return{...v,accessLevel:r,commands:[i]}}return null};var Uu=3;a(a(a(a({},c,0),h,1),T,2),R,3);var Nu=2;var Su=2;var Iu=function(r,t){return function(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var a=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var n=a?.aesKey;var i=[];var v=E(e,2),o=v[0],f=v[1];var _=f&Uu;var s=Ou(_,e);var g={messageId:o,accessLevel:_,commands:i,bytes:e,lrc:{received:undefined,calculated:0}};var A=e.slice(Nu);var l;if(s){return s}if(n&&_!==c){A=u(cu.decrypt(n,A))}var R=A[A.length-1];A=A.slice(0,-1);var T=Ru(A);if(_!==c||R!==0){if(R!==T){l="Mismatch LRC."}}var h=A[0]&Uu;var d=A.slice(1);if(_!==h){l="Mismatch access levels."}var O=0;do{var U=d[O];var N=d[O+1];var S=Su+N;var I=d.slice(O+Su,O+S);var L={id:U,name:t[U],headerSize:Su,bytes:d.slice(O,O+S)};if(!U){break}try{if(!r[U]){throw new Error("Unsupported command id: ".concat(U,"!"))}L.parameters=r[U](I,a);i.push(L)}catch(r){i.push({command:L,error:r.message})}O+=S}while(O<=d.length);g.lrc.calculated=T;g.lrc.received=R;if(l){return{message:g,error:l}}return g}};var Lu={};var mu=Br;var Du=Iu(Lu,mu);Lu[Hr]=Vr;Lu[ct]=ht;Lu[zt]=Kt;Lu[jt]=Qt;Lu[Fv]=wv;Lu[Yv]=Gv;Lu[Bv]=Wv;Lu[Vv]=xv;Lu[zv]=Xv;Lu[jv]=kv;Lu[Zv]=qv;Lu[lo]=co;Lu[Ro]=To;Lu[ho]=Oo;Lu[Uo]=No;Lu[So]=Io;Lu[mo]=Do;Lu[bo]=Go;Lu[Ho]=xo;Lu[zo]=Xo;Lu[Ko]=jo;Lu[ko]=Qo;Lu[qo]=$o;Lu[rE]=tE;Lu[aE]=nE;Lu[vE]=oE;Lu[uE]=gE;Lu[cE]=RE;Lu[TE]=hE;Lu[dE]=OE;Lu[UE]=NE;Lu[SE]=IE;Lu[LE]=mE;Lu[DE]=CE;Lu[pE]=PE;Lu[ME]=yE;Lu[FE]=wE;Lu[YE]=bE;Lu[GE]=BE;Lu[HE]=WE;Lu[VE]=xE;Lu[zE]=XE;Lu[KE]=jE;Lu[kE]=ZE;Lu[qE]=JE;Lu[rf]=ef;Lu[af]=nf;Lu[vf]=of;Lu[Ef]=ff;Lu[uf]=sf;Lu[gf]=lf;Lu[cf]=Tf;Lu[hf]=Of;Lu[Uf]=Sf;Lu[If]=mf;Lu[Df]=pf;Lu[Pf]=yf;Lu[Ff]=Yf;Lu[bf]=Hf;Lu[Wf]=xf;Lu[zf]=Kf;Lu[jf]=Qf;Lu[Zf]=$f;Lu[Jf]=tu;Lu[eu]=nu;Lu[iu]=ou;Lu[Eu]=fu;Lu[uu]=su;Lu[gu]=lu;var Cu=145;var pu=30;var Pu=function(r){if(r[0]!==pu){return{}}var t=r[1];var e=r[3];var a=r.slice(4,t+2);if(e===Cu){return a}return null};fromBytes=Du;getDataSegment=Pu})();
//#endregion


/*
  Incoming arguments:
    * payload - array of bytes
    * metadata - key/value object
*/

var segment = getDataSegment(payload);
var message = null;

// just a single data segment
if ( segment ) {
    message = fromBytes(segment);

    // there may be a message.error (e.g. mismatched LRC)
    // in that case message.message will contain everything parsed successfully
    // it should be used with caution
}

var result = {
    // required property, set to real device name from payload/metadata depending on integration
    // empty value throw an error in converter
    deviceName: '',

    deviceType: 'Water Meter',
    attributes: {
        model: 'Device Model',
        serialNumber: 'SN111',
        manufacturer: 'Device Manufacturer'
    },
    telemetry: {
        // telemetry display only primitive, i.e. string and numbers
        // for example only!
        message: JSON.stringify(message.message || message)
    },
    metadata: metadata
};

return result;
