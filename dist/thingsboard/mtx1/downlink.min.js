// IMPORTANT!!!
// This example only for default downlink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/

// encoded message should be less than this size
// to be able to send to a device
var MAX_DATA_SEGMENT_SIZE = 50;


//#region [autogenerated jooby-codec bundle from index.js]
var toBytes,setDataSegment,getBase64FromBytes;(function(){"use strict";function t(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,a=Array(r);e<r;e++)a[e]=t[e];return a}function r(r){if(Array.isArray(r))return t(r)}function e(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(t){return r(t)||e(t)||i(t)||a()}function i(r,e){if(r){if("string"==typeof r)return t(r,e);var a={}.toString.call(r).slice(8,-1);return"Object"===a&&r.constructor&&(a=r.constructor.name),"Map"===a||"Set"===a?Array.from(r):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(r,e):void 0}}var v=1;var s=2;var _=3;var E=4;var o=Math.log,f=Math.pow,u=Math.LN2;var T=function(t,r,e,a,n){var i,v,s=n*8-a-1,_=(1<<s)-1,E=_>>1,o=-7,u=e?n-1:0,T=e?-1:1,A=t[r+u];u+=T;i=A&(1<<-o)-1;A>>=-o;o+=s;for(;o>0;i=i*256+t[r+u],u+=T,o-=8);v=i&(1<<-o)-1;i>>=-o;o+=a;for(;o>0;v=v*256+t[r+u],u+=T,o-=8);if(i===0){i=1-E}else if(i===_){return v?NaN:A?-Infinity:Infinity}else{v=v+f(2,a);i=i-E}return(A?-1:1)*v*f(2,i-a)};var A=function(t,r,e,a,n,i){var v,s,_,E=i*8-n-1,T=(1<<E)-1,A=T>>1,R=n===23?f(2,-24)-f(2,-77):0,O=a?0:i-1,d=a?1:-1,c=e<0||e===0&&1/e<0?1:0;e<0&&(e=-e);if(e!==e||e===Infinity){s=e!==e?1:0;v=T}else{v=o(e)/u|0;if(e*(_=f(2,-v))<1){v--;_*=2}if(v+A>=1){e+=R/_}else{e+=R*f(2,1-A)}if(e*_>=2){v++;_/=2}if(v+A>=T){s=0;v=T}else if(v+A>=1){s=(e*_-1)*f(2,n);v=v+A}else{s=e*f(2,A-1)*f(2,n);v=0}}for(;n>=8;t[r+O]=s&255,O+=d,s/=256,n-=8);v=v<<n|s;E+=n;for(;E>0;t[r+O]=v&255,O+=d,v/=256,E-=8);t[r+O-d]|=c*128};var R=[1,0];var O=[2,1,0];var d=[3,2,1,0];var c=[0,1];var l=[0,1,2];var h=[0,1,2,3];var N=function(t,r){return t[r]};var U=function(t,r,e){var a=e?c:R;var n=t[r+a[0]];var i=t[r+a[1]]<<8;return n|i};var S=function(t,r,e){var a=e?l:O;var n=t[r+a[0]];var i=t[r+a[1]]<<8;var v=t[r+a[2]]<<16;return n|i|v};var D=function(t,r,e){var a=e?h:d;var n=t[r+a[3]]*16777216;var i=t[r+a[2]]*65536;var v=t[r+a[1]]*256;var s=t[r+a[0]];return n+i+v+s};var I=function(t,r,e){t[r]=e&255};var g=function(t,r,e,a){var n=a?c:R;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255};var L=function(t,r,e,a){var n=a?l:O;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255;t[r+n[2]]=e>>>16&255};var C=function(t,r,e,a){var n=a?h:d;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255;t[r+n[2]]=e>>>16&255;t[r+n[3]]=e>>>24&255};function P(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof t==="number"){var e=new Array(t).fill(0);this.data=e}else{this.data=t}this.offset=0;this.isLittleEndian=r}P.prototype={toUint8Array:function(){return this.data},seek:function(t){if(t<0||t>=this.data.length){throw new Error("Invalid position.")}this.offset=t},setInt8:function(t){I(this.data,this.offset,t<0?t|256:t);this.offset+=v},getInt8:function(){var t=N(this.data,this.offset);this.offset+=v;return t&128?t^-256:t},setUint8:function(t){I(this.data,this.offset,t);this.offset+=v},getUint8:function(){var t=N(this.data,this.offset);this.offset+=v;return t},setInt16:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;g(this.data,this.offset,t<0?t|65536:t,r);this.offset+=s},getInt16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=U(this.data,this.offset,t);this.offset+=s;return r&32768?r^-65536:r},setUint16:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;g(this.data,this.offset,t,r);this.offset+=s},getUint16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=U(this.data,this.offset,t);this.offset+=s;return r},setInt24:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;L(this.data,this.offset,t<0?t|16777216:t,r);this.offset+=_},getInt24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=S(this.data,this.offset,t);this.offset+=_;return r&8388608?r^-16777216:r},setUint24:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;L(this.data,this.offset,t,r);this.offset+=_},getUint24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=S(this.data,this.offset,t);this.offset+=_;return r},setInt32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;C(this.data,this.offset,t<0?t|4294967296:t,r);this.offset+=E},getInt32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=D(this.data,this.offset,t);this.offset+=E;return r&2147483648?r^-4294967296:r},setUint32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;C(this.data,this.offset,t,r);this.offset+=E},getUint32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=D(this.data,this.offset,t);this.offset+=E;return r},setFloat32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;A(this.data,this.offset,t,r,23,4);this.offset+=E},getFloat32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=T(this.data,this.offset,t,23,4);this.offset+=E;return r},setString:function(t){this.setUint8(t.length);for(var r=0;r<t.length;++r){this.setUint8(t.charCodeAt(r))}},getString:function(){var t=this.getUint8();var r=this.offset+t;var e=[];while(this.offset<r){e.push(String.fromCharCode(this.getUint8()))}return e.join("")},getBytesToOffset:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,t)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=r+t;return this.data.slice(r,this.offset)},setBytes:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var e=this.data;e.splice.apply(e,[r,t.length].concat(n(t)));this.data=e;this.offset=r+t.length}};Object.defineProperties(P.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var M=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var e=0;for(var a in r){if(a in t&&r[a]){e|=t[a]}}return e};var y=function(t,r,e,a){var n=(1<<r)-1<<e-1;var i=a;var v=t;v&=~n;i<<=e-1;v|=i;return v};var m=80;var F=81;var p=82;var Y=83;var B=84;var G=85;var H=86;var V=87;var x=88;var w=89;var W=90;var b=91;var K=255;var X=Object.freeze({__proto__:null,DATA_REQUEST:m,DATA_RESPONSE:F,FRAGMENT_REQUEST:W,FRAGMENT_RESPONSE:b,IDENT_REQUEST:p,IDENT_RESPONSE:Y,INVALID:K,L2_CHECK_ADDRESS_REQUEST:H,L2_CHECK_ADDRESS_RESPONSE:V,L2_RM_ADDRESS_REQUEST:x,L2_RM_ADDRESS_RESPONSE:w,L2_SET_ADDRESS_REQUEST:B,L2_SET_ADDRESS_RESPONSE:G});var j=function(t){var r={};for(var e in t){var a=t[e];r[a]=e}return r};j(X);var z=0;var Q=1;var Z=2;var k=3;var q=Object.freeze({__proto__:null,READ_ONLY:k,READ_WRITE:Z,ROOT:Q,UNENCRYPTED:z});j(q);var $=0;var J=1;var tt=2;var rt=3;var et=4;var at=5;var nt=6;var it=7;var vt=8;var st=9;var _t=10;var Et=11;var ot=12;var ft=13;var ut=14;var Tt=Object.freeze({__proto__:null,CASE_MODULE_OPEN:_t,CASE_OPEN:$,CASE_TERMINAL_OPEN:st,DEVICE_FAILURE:vt,ERROR_ACCESS:at,MAGNETIC_ON:J,PARAMETERS_UPDATE_LOCAL:rt,PARAMETERS_UPDATE_REMOTE:tt,PROTECTION_RESET_EM:ft,PROTECTION_RESET_MAGNETIC:ut,RESTART:et,TARIFF_TABLE_GET:ot,TARIFF_TABLE_SET:Et,TIME_CORRECT:it,TIME_SET:nt});j(Tt);var At=1;var Rt=3;var Ot=4;var dt=5;var ct=7;var lt=8;var ht=9;var Nt=13;var Ut=15;var St=16;var Dt=17;var It=18;var gt=19;var Lt=20;var Ct=21;var Pt=22;var Mt=23;var yt=24;var mt=25;var Ft=28;var pt=30;var Yt=31;var Bt=40;var Gt=41;var Ht=42;var Vt=44;var xt=45;var wt=46;var Wt=47;var bt=49;var Kt=50;var Xt=51;var jt=52;var zt=53;var Qt=54;var Zt=57;var kt=58;var qt=59;var $t=60;var Jt=61;var tr=62;var rr=65;var er=70;var ar=74;var nr=75;var ir=79;var vr=80;var sr=82;var _r=83;var Er=88;var or=89;var fr=91;var ur=92;var Tr=93;var Ar=94;var Rr=100;var Or=109;var dr=111;var cr=112;var lr=113;var hr=114;var Nr=116;var Ur=117;var Sr=118;var Dr=122;var Ir=Object.freeze({__proto__:null,activateRatePlan:gt,getBv:cr,getCorrectTime:tr,getCriticalEvent:rr,getCurrentStatusMeter:Zt,getCurrentValues:Nt,getDateTime:ct,getDayDemand:Pt,getDayDemandExport:ir,getDayMaxDemand:bt,getDayMaxDemandExport:Er,getDayMaxDemandPrevious:ar,getDayProfile:qt,getDemand:Sr,getDemandParameters:Ur,getDeviceId:dt,getDeviceType:Ot,getDisplayParam:Ar,getEnergy:Ut,getEnergyDayPrevious:Rt,getEnergyExport:fr,getEnergyExportDayPrevious:vr,getEventStatus:At,getEvents:Xt,getEventsCounters:jt,getExtendedCurrentValues:kt,getExtendedCurrentValues2:xt,getHalfHourDemand:Ct,getHalfHourDemandExport:_r,getHalfHourDemandPrevious:nr,getHalfHourEnergies:dr,getMagneticFieldThreshold:Or,getMeterInfo:Dr,getMonthDemand:Mt,getMonthDemandExport:sr,getMonthMaxDemand:Kt,getMonthMaxDemandExport:or,getOperatorParameters:pt,getOperatorParametersExtended3:lr,getRatePlanInfo:Vt,getSaldo:Gt,getSaldoParameters:wt,getSeasonProfile:$t,getSpecialDay:Jt,getVersion:Bt,prepareRatePlan:Lt,resetPowerMaxDay:zt,resetPowerMaxMonth:Qt,runTariffPlan:er,setAccessKey:ht,setCorrectDateTime:ur,setCorrectTime:Ft,setDateTime:lt,setDayProfile:St,setDemandParameters:Nr,setDisplayParam:Tr,setOperatorParameters:Yt,setOperatorParametersExtended3:hr,setSaldo:Ht,setSaldoParameters:Wt,setSeasonProfile:Dt,setSpecialDay:It,setSpecialOperation:Rr,turnRelayOff:mt,turnRelayOn:yt});j(Ir);var gr=1;var Lr=2;var Cr=3;var Pr=16;var Mr=17;var yr=18;var mr=19;var Fr=20;var pr=21;var Yr=32;var Br=33;var Gr=34;var Hr=35;var Vr=36;var xr=37;var wr=38;var Wr=39;var br=40;var Kr=41;var Xr=49;var jr=50;var zr=51;var Qr=52;var Zr=53;var kr=54;var qr=55;var $r=56;var Jr=57;var te=60;var re=61;var ee=62;var ae=63;var ne=64;var ie=65;var ve=66;var se=67;var _e=68;var Ee=69;var oe=70;var fe=71;var ue=72;var Te=73;var Ae=74;var Re=75;var Oe=76;var de=77;var ce=78;var le=79;var he=80;var Ne=81;var Ue=82;var Se=83;var De=84;var Ie=85;var ge=86;var Le=87;var Ce=88;var Pe=89;var Me=96;var ye=97;var me=98;var Fe=99;var pe=100;var Ye=101;var Be=102;var Ge=103;var He=104;var Ve=105;var xe=112;var we=113;var We=114;var be=115;var Ke=116;var Xe=117;var je=118;var ze=119;var Qe=120;var Ze=121;var ke=122;var qe=123;var $e=124;var Je=125;var ta=126;var ra=144;var ea=145;var aa=147;var na=148;var ia=152;var va=156;var sa=157;var _a=158;var Ea=159;var oa=160;var fa=161;var ua=162;var Ta=176;var Aa=177;var Ra=178;var Oa=179;var da=180;var ca=181;var la=182;var ha=183;var Na=185;var Ua=186;var Sa=224;var Da=225;var Ia=226;var ga=227;var La=228;var Ca=229;var Pa=230;var Ma=231;var ya=232;var ma=Object.freeze({__proto__:null,ACCESS_LOCKED:Pr,ACC_PARAM_BAD:We,ACC_PARAM_EXT_BAD:be,BAD_TEST_EEPROM:He,BAD_TEST_FRAM:Ve,BATTERY_FAULT:Se,BATTERY_OK:Ue,BIPOLAR_POWER_FAULT:da,BIPOLAR_POWER_OK:ca,BLOCK_TARIFF_BAD:Xe,CALC_PERIOD_BAD:Ke,CALIBRATION_FAULT:Ie,CALIBRATION_FLAG_RESET:Ge,CALIBRATION_FLAG_SET:Be,CALIBRATION_OK:De,CALIBRATION_PARAM_BAD:je,CASE_CLOSE:mr,CASE_KLEMA_CLOSE:qe,CASE_KLEMA_OPEN:ke,CASE_MODULE_CLOSE:Je,CASE_MODULE_OPEN:$e,CASE_OPEN:yr,CHANGE_ACCESS_KEY0:Yr,CHANGE_ACCESS_KEY1:Br,CHANGE_ACCESS_KEY2:Gr,CHANGE_ACCESS_KEY3:Hr,CHANGE_COR_TIME:Kr,CHANGE_PARAM_CANAL:Na,CHANGE_PAR_LOCAL:Vr,CHANGE_PAR_REMOTE:xr,CHANGE_TARIFF_TABLE:jr,CHANGE_TARIFF_TBL_2:ia,CLOCK_FAULT:Le,CLOCK_OK:ge,CMD_CHANGE_TIME:wr,CMD_RELAY_2_OFF:ye,CMD_RELAY_2_ON:Me,CMD_RELAY_OFF:br,CMD_RELAY_ON:Wr,CROSS_ZERO_ENT0:me,CROSS_ZERO_ENT1:Fe,CROSS_ZERO_ENT2:pe,CROSS_ZERO_ENT3:Ye,CROSS_ZERO_EXPORT_ENT0:_a,CROSS_ZERO_EXPORT_ENT1:Ea,CROSS_ZERO_EXPORT_ENT2:oa,CROSS_ZERO_EXPORT_ENT3:fa,CURRENT_UNEQUAL_FAULT:Ra,CURRENT_UNEQUAL_OK:Oa,EM_MAGNETIC_OFF:Aa,EM_MAGNETIC_ON:Ta,ENERGY_REGISTER_FAULT:gr,ENERGY_REGISTER_OVERFLOW:Xr,ERR_ACCESS:Mr,F_MAX_OK:ue,F_MAX_OVER:Te,F_MIN_OK:Ae,F_MIN_OVER:Re,I_MAX_OK:Oe,I_MAX_OVER:de,MAGNETIC_OFF:pr,MAGNETIC_ON:Fr,OP_PAR_FAULT:Cr,POWER_A_OFF:Ce,POWER_A_ON:Pe,POWER_B_OFF:re,POWER_B_ON:te,POWER_C_OFF:ae,POWER_C_ON:ee,POWER_GOOD_DIO:ta,POWER_OVER_RELAY_OFF:sa,POWER_SALDO_OK:he,POWER_SALDO_OVER:Ne,P_MAX_A_MINUS_OK:Ma,P_MAX_A_MINUS_OVER:ya,P_MAX_OK:ce,P_MAX_OVER:le,RELAY_HARD_BAD_OFF:ra,RELAY_HARD_BAD_ON:aa,RELAY_HARD_OFF:na,RELAY_HARD_ON:ea,RELAY_OFF:qr,RELAY_OFF_BAD_SALDO:Ua,RELAY_ON:kr,RESET_EM_FLAG:la,RESET_MAGNET_FLAG:ha,RESTART:$r,SALDO_EN_BAD:Qe,SALDO_PARAM_BAD:we,SET_DEMAND_EN_10MIN:ga,SET_DEMAND_EN_15MIN:La,SET_DEMAND_EN_1MIN:Sa,SET_DEMAND_EN_30MIN:Ca,SET_DEMAND_EN_3MIN:Da,SET_DEMAND_EN_5MIN:Ia,SET_DEMAND_EN_60MIN:Pa,SET_NEW_SALDO:xe,SET_SALDO_PARAM:va,SET_TARIFF_TABLE:zr,SUMMER_TIME:Qr,TIME_CORRECT:Ze,TIME_CORRECT_NEW:ua,T_MAX_OK:_e,T_MAX_OVER:Ee,T_MIN_OK:oe,T_MIN_OVER:fe,VENDOR_PAR_FAULT:Lr,V_MAX_OK:ne,V_MAX_OVER:ie,V_MIN_OK:ve,V_MIN_OVER:se,WD_RESTART:Jr,WINTER_SUMMER_BAD:ze,WINTER_TIME:Zr});j(ma);var Fa=0;var pa=128;var Ya=129;var Ba=130;var Ga=131;var Ha=132;var Va=133;var xa=134;var wa=135;var Wa=136;var ba=137;var Ka=144;var Xa=145;var ja=146;var za=147;var Qa=149;var Za=151;var ka=152;var qa=153;var $a=154;var Ja=155;var tn=156;var rn=159;var en=160;var an=240;var nn=Object.freeze({__proto__:null,ACCESS_DENIED:za,BAD_ARRAY_INDEX:xa,BAD_BLOCK_NUMBER:tn,BAD_DATA_LENGTH:Va,BAD_MESSAGE:Ha,BAD_RATE_PLAN_ID:Wa,BAD_RATE_PLAN_SIZE:ba,BAD_RESPONSE_LENGTH:Ka,BAD_SALDO_WRITE:Qa,BLOCKED_METER:Za,CALIBRATION_DISABLED:ja,DECRYPTION_FAILURE:Ba,INTERNAL:an,INVALID_CORRECTION_INTERVAL:$a,NOT_ALIGNED_DATA:Ya,NOT_PREPARED_RATE_PLAN:wa,NO_DATA_FOR_DATE:Xa,OK:Fa,OUT_OFF_RANGE:rn,SET_METER_TYPE_FAILURE:en,TIME_CORRECTION_FAILURE:qa,TIME_CORRECTION_OUT_HALF_HOUR_DISABLED:Ja,UNENCRYPTED_COMMAND_DISABLED:ka,UNKNOWN_COMMAND:pa,UNKNOWN_PROTOCOL:Ga});j(nn);var vn=1;var sn=2;var _n=3;var En=4;var on=5;var fn=6;var un=7;var Tn=8;var An=9;var Rn=10;var On=11;var dn=12;var cn=13;var ln=14;var hn=15;var Nn=16;var Un=17;var Sn=18;var Dn=19;var In=20;var gn=21;var Ln=22;var Cn=23;var Pn=24;var Mn=25;var yn=26;var mn=28;var Fn=30;var pn=31;var Yn=Object.freeze({__proto__:null,ACTIVE_ENERGY_T1:En,ACTIVE_ENERGY_T2:on,ACTIVE_ENERGY_T3:fn,ACTIVE_ENERGY_T4:un,ACTIVE_POWER_IN_NEUTRAL:An,ACTIVE_POWER_PER_PHASE:Tn,BATTERY_VOLTAGE:Ln,CURRENT_BALANCE:Fn,CURRENT_IN_NEUTRAL:On,CURRENT_IN_PHASE:Rn,DATE_MONTH_YEAR:ln,EXPORTED_ACTIVE_ENERGY_T1:Nn,EXPORTED_ACTIVE_ENERGY_T2:Un,EXPORTED_ACTIVE_ENERGY_T3:Sn,EXPORTED_ACTIVE_ENERGY_T4:Dn,HOUR_MINUTE_SECOND:cn,MAGNET_INDUCTION:mn,OPTOPORT_SPEED:pn,POWER_FACTOR_PHASE_A:In,POWER_FACTOR_PHASE_B:gn,POWER_THRESHOLD_T1:Cn,POWER_THRESHOLD_T2:Pn,POWER_THRESHOLD_T3:Mn,POWER_THRESHOLD_T4:yn,SET_ALL_SEGMENT_DISPLAY:vn,SOFTWARE_VERSION:sn,TOTAL_ACTIVE_ENERGY:_n,TOTAL_EXPORTED_ACTIVE_ENERGY:hn,VOLTAGE:dn});j(Yn);var Bn=120;var Gn=121;var Hn=254;var Vn=255;var xn=Object.freeze({__proto__:null,activateRatePlan:gt,errorDataFrameResponse:Vn,errorResponse:Hn,getBv:cr,getCorrectTime:tr,getCriticalEvent:rr,getCurrentStatusMeter:Zt,getCurrentValues:Nt,getDateTime:ct,getDayDemand:Pt,getDayDemandExport:ir,getDayEnergies:Bn,getDayMaxDemand:bt,getDayMaxDemandExport:Er,getDayMaxDemandPrevious:ar,getDayMaxPower:Gn,getDayProfile:qt,getDemand:Sr,getDemandParameters:Ur,getDeviceId:dt,getDeviceType:Ot,getDisplayParam:Ar,getEnergy:Ut,getEnergyDayPrevious:Rt,getEnergyExport:fr,getEnergyExportDayPrevious:vr,getEventStatus:At,getEvents:Xt,getEventsCounters:jt,getExtendedCurrentValues:kt,getExtendedCurrentValues2:xt,getHalfHourDemand:Ct,getHalfHourDemandExport:_r,getHalfHourDemandPrevious:nr,getHalfHourEnergies:dr,getMagneticFieldThreshold:Or,getMeterInfo:Dr,getMonthDemand:Mt,getMonthDemandExport:sr,getMonthMaxDemand:Kt,getMonthMaxDemandExport:or,getOperatorParameters:pt,getOperatorParametersExtended3:lr,getRatePlanInfo:Vt,getSaldo:Gt,getSaldoParameters:wt,getSeasonProfile:$t,getSpecialDay:Jt,getVersion:Bt,prepareRatePlan:Lt,resetPowerMaxDay:zt,resetPowerMaxMonth:Qt,runTariffPlan:er,setAccessKey:ht,setCorrectDateTime:ur,setCorrectTime:Ft,setDateTime:lt,setDayProfile:St,setDemandParameters:Nr,setDisplayParam:Tr,setOperatorParameters:Yt,setOperatorParametersExtended3:hr,setSaldo:Ht,setSaldoParameters:Wt,setSeasonProfile:Dt,setSpecialDay:It,setSpecialOperation:Rr,turnRelayOff:mt,turnRelayOn:yt});j(xn);var wn=2400;var Wn=9600;var bn={rs485orTwi:{0:Wn,2:wn,4:Wn},optoport:{0:wn,2:wn,4:Wn}};var Kn={rs485orTwi:j(bn.rs485orTwi),optoport:j(bn.optoport)};var Xn=11;var jn=74;var zn=7;var Qn=2+zn;var Zn={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_FACTOR_PHASE_A:524288,POWER_FACTOR_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var kn={...Zn,AUTO_SCREEN_SCROLLING:2147483648};var qn={...Zn,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var $n={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_1:8,RELAY_ON_TARIFF_2:16,RELAY_ON_TARIFF_3:32,RELAY_ON_TARIFF_4:64,RELAY_ON_V_GOOD:128};var Jn={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_1:4,RELAY_OFF_TARIFF_2:8,RELAY_OFF_TARIFF_3:16,RELAY_OFF_TARIFF_4:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var ti={RELAY_OFF_LIM_TARIFF_1:2,RELAY_OFF_LIM_TARIFF_2:4,RELAY_OFF_LIM_TARIFF_3:8,RELAY_OFF_LIM_TARIFF_4:16,RELAY_OFF_PF_MIN:32};var ri={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var ei={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var ai={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var ni={RELAY_OFF_LIMIT_P_MINUS_T1:8,RELAY_OFF_LIMIT_P_MINUS_T2:16,RELAY_OFF_LIMIT_P_MINUS_T3:32,RELAY_OFF_LIMIT_P_MINUS_T4:64};var ii=function(t){var r=0;r=y(r,4,1,Number(Kn.rs485orTwi[t.rs485orTwi]));r=y(r,4,5,Number(Kn.optoport[t.optoport]));return r};var vi=function(t){var r=0;r=y(r,2,1,t.tariff);r=y(r,1,3,+!t.isFirstHalfHour);r=y(r,5,4,t.hour);return r};var si=function(t,r){t.setUint8(r.isSummerTime?1:0);t.setUint8(r.seconds);t.setUint8(r.minutes);t.setUint8(r.hours);t.setUint8(r.day||0);t.setUint8(r.date);t.setUint8(r.month);t.setUint8(r.year)};var _i=function(t,r){t.setUint32(r.id);t.setUint8(r.tariffSet);t.setUint8(r.activateYear);t.setUint8(r.activateMonth);t.setUint8(r.activateDay);t.setUint8(r.specialProfilesArraySize);t.setUint8(r.seasonProfilesArraySize);t.setUint8(r.dayProfilesArraySize)};var Ei=function(t,r){t.setUint8(r.monthTransitionSummer);t.setUint8(r.dateTransitionSummer);t.setUint8(r.hoursTransitionSummer);t.setUint8(r.hoursCorrectSummer);t.setUint8(r.monthTransitionWinter);t.setUint8(r.dateTransitionWinter);t.setUint8(r.hoursTransitionWinter);t.setUint8(r.hoursCorrectWinter);t.setUint8(+r.isCorrectionNeeded)};var oi=function(t,r){t.setUint8(vi(r))};var fi=function(t,r){t.setUint8(r.month);t.setUint8(r.date);r.dayIndexes.forEach(function(r){return t.setUint8(r)})};var ui=function(t,r){t.setUint8(r.month);t.setUint8(r.date);t.setUint8(r.dayIndex);t.setUint8(+!r.isPeriodic)};var Ti=function(t,r){var e=r.timeCorrectPeriod|(r.timeCorrectPassHalfhour?128:0);t.setUint32(r.vpThreshold);t.setUint32(r.vThreshold);t.setUint32(r.ipThreshold);t.setUint32(r.pmaxThreshold0);t.setUint32(r.pmaxThreshold1);t.setUint32(r.pmaxThreshold2);t.setUint32(r.pmaxThreshold3);t.setUint8(ii(r.serialPortsSpeed));t.setUint8(r.tint);t.setUint8(r.calcPeriodDate);t.setUint8(r.timeoutDisplay);t.setUint8(r.timeoutScreen);t.setUint32(M(kn,r.displaySet));t.setUint8(M(ri,r.relaySet4));t.setUint8(M(ti,r.relaySet3));t.setUint8(M(Jn,r.relaySet2));t.setUint8(M($n,r.relaySet1));t.setUint8(r.displayType);t.setUint8(r.ten);t.setUint16(r.timeoutRefresh);t.setUint8(r.deltaCorMin);t.setUint8(r.timeoutMagnetOff);t.setUint8(r.timeoutMagnetOn);t.setUint8(M(ai,r.define1));t.setUint8(r.timeoutRelayOn);t.setUint8(r.timeoutRelayKey);t.setUint8(r.timeoutRelayAuto);t.setUint8(r.timeoutBadVAVB);t.setUint8(r.freqMax);t.setUint8(r.freqMin);t.setUint16(r.phMin);t.setUint8(r.year);t.setUint8(r.month);t.setUint8(r.date);t.setUint8(r.energyDecimalPoint);t.setUint8(r.typeMeter);t.setUint8(r.timeoutIMax);t.setUint8(r.timeoutPMax);t.setUint8(r.timeoutCos);t.setUint8(r.pMaxDef);t.setUint32(M(qn,r.displaySetExt));t.setUint8(r.timeoutUneqCurrent);t.setUint8(r.timeoutBipolarPower);t.setUint8(M(ei,r.relaySet5));t.setUint8(e)};var Ai=function(t,r){t.setUint8(r.year);t.setUint8(r.month);t.setUint8(r.date)};var Ri=function(t,r){r.coefficients.forEach(function(r){return t.setUint32(r)});t.setUint8(r.decimalPointTariff);t.setInt32(r.indicationThreshold);t.setInt32(r.relayThreshold);t.setUint8(r.mode);t.setUint8(r.saldoOffTimeBegin);t.setUint8(r.saldoOffTimeEnd);t.setUint8(r.decimalPointIndication);t.setUint32(r.powerThreshold);t.setInt32(r.creditThreshold)};var Oi=function(t,r){var e=r.date.year<<1|r.date.month>>3&1;var a=r.date.month<<5&224|r.date.date&31;t.setUint8(e);t.setUint8(a);t.setUint8(r.demandType);t.setUint16(r.firstIndex);t.setUint8(r.count);t.setUint8(r.period)};var di=function(t,r){t.setUint8(r.channelParam1);t.setUint8(r.counterInterval);t.setUint8(r.channelParam2);t.setUint8(0)};var ci=function(t,r){var e=r.pmaxMinusThreshold0,a=r.pmaxMinusThreshold1,n=r.pmaxMinusThreshold2,i=r.pmaxMinusThreshold3,v=r.relaySet;t.setUint32(e);t.setUint32(a);t.setUint32(n);t.setUint32(i);t.setUint8(M(ni,v))};var li=function(t){return btoa(t.map(function(t){return String.fromCharCode(t)}).join(""))};var hi=function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[t,r.length].concat(n(r))};var Ni=gt;var Ui=1+Xn;var Si=function(t){var r=new P(Ui,false);r.setUint8(t.tariffTable);_i(r,t.tariffPlan);return hi(Ni,r.data)};var Di=cr;var Ii=function(){return hi(Di)};var gi=tr;var Li=function(){return hi(gi)};var Ci=rr;var Pi=function(t){return hi(Ci,[t.event,t.index])};var Mi=Zt;var yi=function(){return hi(Mi)};var mi=Nt;var Fi=function(){return hi(mi)};var pi=ct;var Yi=function(){return hi(pi)};var Bi=3;var Gi=4;var Hi=Pt;var Vi=function(t){var r=new P(t?.energyType?Gi:Bi);Ai(r,t?.date);if(t?.energyType){r.setUint8(t.energyType)}return hi(Hi,r.data)};var xi=3;var wi=4;var Wi=ir;var bi=function(t){var r=new P(t?.energyType?wi:xi,false);Ai(r,t?.date);if(t?.energyType){r.setUint8(t.energyType)}return hi(Wi,r.data)};var Ki=bt;var Xi=3;var ji=function(t){var r=new P(Xi,false);Ai(r,t.date);return hi(Ki,r.data)};var zi=Er;var Qi=3;var Zi=function(t){var r=new P(Qi,false);Ai(r,t.date);return hi(zi,r.data)};var ki=ar;var qi=function(){return hi(ki)};var $i=qt;var Ji=3;var tv=function(t){var r=new P(Ji,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return hi($i,r.data)};var rv=Sr;var ev=7;var av=function(t){var r=new P(ev,false);Oi(r,t);return hi(rv,r.data)};var nv=Ur;var iv=function(){return hi(nv)};var vv=dt;var sv=function(){return hi(vv)};var _v=Ot;var Ev=function(){return hi(_v)};var ov=Ar;var fv=1;var uv=function(t){var r=new P(fv,false);r.setUint8(t.displayMode);return hi(ov,r.data)};var Tv=0;var Av=1;var Rv=Ut;var Ov=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=new P(t?.energyType?Av:Tv,false);if(t?.energyType){r.setUint8(t.energyType)}return hi(Rv,r.data)};var dv=Rt;var cv=function(t){if(t.energyType){return hi(dv,[t.energyType])}return hi(dv)};var lv=0;var hv=1;var Nv=fr;var Uv=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=new P(t?.energyType?hv:lv,false);if(t?.energyType){r.setUint8(t.energyType)}return hi(Nv,r.data)};var Sv=vr;var Dv=function(t){if(t.energyType){return hi(Sv,[t.energyType])}return hi(Sv)};var Iv=Xt;var gv=4;var Lv=function(t){var r=new P(gv,false);Ai(r,t.date);r.setUint8(t.offset);return hi(Iv,r.data)};var Cv=jt;var Pv=function(){return hi(Cv)};var Mv=At;var yv=function(){return hi(Mv)};var mv=kt;var Fv=function(){return hi(mv)};var pv=xt;var Yv=function(){return hi(pv)};var Bv=Ct;var Gv=3;var Hv=function(t){var r=new P(Gv,false);Ai(r,t.date);return hi(Bv,r.data)};var Vv=_r;var xv=3;var wv=function(t){var r=new P(xv,false);Ai(r,t.date);return hi(Vv,r.data)};var Wv=nr;var bv=function(){return hi(Wv)};var Kv={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var Xv=function(t){var r={};Object.keys(t).forEach(function(e){r[e]=!!t[e]});return M(Kv,r)};var jv=function(t,r){var e=r.year,a=r.month,n=r.date;var i=e<<1|a>>3&1;var v=a<<5&224|n&31;t.setUint8(i);t.setUint8(v)};var zv=function(t,r){t.setUint8(Xv(r))};var Qv=dr;var Zv=5;var kv=function(t){var r=new P(Zv,false);jv(r,t.date);zv(r,t.energies);r.setUint8(t.firstHalfhour);r.setUint8(t.halfhoursNumber);return hi(Qv,r.data)};var qv=Or;var $v=function(){return hi(qv)};var Jv=Dr;var ts=function(){return hi(Jv)};var rs=Mt;var es=2;var as=function(t){var r=new P(es,false);r.setUint8(t.year);r.setUint8(t.month);return hi(rs,r.data)};var ns=sr;var is=2;var vs=function(t){var r=new P(is,false);r.setUint8(t.year);r.setUint8(t.month);return hi(ns,r.data)};var ss=Kt;var _s=function(t){var r=t.year,e=t.month;return hi(ss,[r,e])};var Es=or;var os=function(t){var r=t.year,e=t.month;return hi(Es,[r,e])};var fs=pt;var us=function(){return hi(fs)};var Ts=lr;var As=function(){return hi(Ts)};var Rs=Vt;var Os=function(t){return hi(Rs,[t.tariffTable])};var ds=Gt;var cs=function(){return hi(ds)};var ls=wt;var hs=function(){return hi(ls)};var Ns=$t;var Us=3;var Ss=function(t){var r=new P(Us,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return hi(Ns,r.data)};var Ds=Jt;var Is=3;var gs=function(t){var r=new P(Is,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return hi(Ds,r.data)};var Ls=Bt;var Cs=function(){return hi(Ls)};var Ps=Lt;var Ms=5;var ys=function(t){var r=new P(Ms,false);r.setUint8(t.tariffTable);r.setUint32(t.id);return hi(Ps,r.data)};var ms=zt;var Fs=function(){return hi(ms)};var ps=Qt;var Ys=function(){return hi(ps)};var Bs=er;var Gs=function(t){return hi(Bs,[t.tariffTable])};var Hs=16;var Vs=ht;var xs=1+Hs;var ws=function(t){var r=new P(xs,false);r.setUint8(t.accessLevel);r.setBytes(t.key);return hi(Vs,r.data)};var Ws=ur;var bs=2;var Ks=function(t){var r=new P(bs,false);r.setInt16(t.seconds);return hi(Ws,r.data)};var Xs=Ft;var js=9;var zs=function(t){var r=new P(js,false);Ei(r,t);return hi(Xs,r.data)};var Qs=lt;var Zs=8;var ks=function(t){var r=new P(Zs,false);si(r,t);return hi(Qs,r.data)};var qs=8;var $s=255;var Js=St;var t_=function(t){var r=t.periods.length<qs;var e=2+t.periods.length+ +r;var a=new P(e,false);a.setUint8(t.tariffTable);a.setUint8(t.index);t.periods.forEach(function(t){oi(a,t)});if(r){a.setUint8($s)}return hi(Js,a.data)};var r_=Nr;var e_=4;var a_=function(t){var r=new P(e_,false);di(r,t);return hi(r_,r.data)};var n_=Tr;var i_=function(t){return hi(n_,[t.displayMode].concat(n(t.order)))};var v_=Yt;var s_=jn;var __=function(t){var r=new P(s_,false);Ti(r,t);return hi(v_,r.data)};var E_=hr;var o_=17;var f_=function(t){var r=new P(o_,false);ci(r,t);return hi(E_,r.data)};var u_=Ht;var T_=12;var A_=function(t){var r=new P(T_,false);r.setUint8(t.date.month);r.setUint8(t.date.date);r.setUint8(t.date.hours);r.setUint8(t.date.minutes);r.setInt32(t.saldoNew);r.setInt32(t.saldoOld);return hi(u_,r.data)};var R_=Wt;var O_=37;var d_=function(t){var r=new P(O_,false);Ri(r,t);return hi(R_,r.data)};var c_=Dt;var l_=Qn;var h_=function(t){var r=new P(l_,false);r.setUint8(t.tariffTable);r.setUint8(t.index);fi(r,t);return hi(c_,r.data)};var N_=It;var U_=6;var S_=function(t){var r=new P(U_,false);r.setUint8(t.tariffTable);r.setUint8(t.index);ui(r,t);return hi(N_,r.data)};var D_=Rr;var I_=2;var g_=function(t){var r=new P(I_,false);var e=0;if(t.readScreensInfo){e|=128}if(t.resetElectroMagneticIndication){e|=1}if(t.resetMagneticIndication){e|=2}r.setUint8(t.type);r.setUint8(e);return hi(D_,r.data)};var L_=mt;var C_=function(){return hi(L_)};var P_=yt;var M_=function(){return hi(P_)};var y_=Vn;var m_={encrypt:function(){},decrypt:function(){}};var F_=function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var e=r;t.forEach(function(t){e^=t});return e};var p_=16;var Y_=[0];var B_=function(t){return function(r,e){var a=e.messageId,i=a===void 0?1:a,v=e.accessLevel,s=v===void 0?k:v,_=e.aesKey;var E=r.flatMap(function(r){if("id"in r){return t[r.id](r.parameters||{})}if("command"in r){return r.command.bytes}throw new Error("wrong command format")});var o=s|16;var f=[i,o];var u=r.length===1&&"id"in r[0]&&r[0].id===y_;if(u){return f.concat(E)}var T=[].concat(o,E,Y_);if(s!==z){var A=(T.length+1)%p_;if(A){T=T.concat(new Array(p_-A).fill(0))}}T=T.concat(F_(T));if(_&&s!==z){T=n(m_.encrypt(_,T))}return f.concat(T)}};var G_={};var H_=B_(G_);G_[Ni]=Si;G_[Di]=Ii;G_[gi]=Li;G_[Ci]=Pi;G_[Mi]=yi;G_[mi]=Fi;G_[pi]=Yi;G_[Hi]=Vi;G_[Wi]=bi;G_[Ki]=ji;G_[zi]=Zi;G_[ki]=qi;G_[$i]=tv;G_[rv]=av;G_[nv]=iv;G_[vv]=sv;G_[_v]=Ev;G_[ov]=uv;G_[Rv]=Ov;G_[dv]=cv;G_[Nv]=Uv;G_[Sv]=Dv;G_[Iv]=Lv;G_[Cv]=Pv;G_[Mv]=yv;G_[mv]=Fv;G_[pv]=Yv;G_[Bv]=Hv;G_[Vv]=wv;G_[Wv]=bv;G_[Qv]=kv;G_[qv]=$v;G_[Jv]=ts;G_[rs]=as;G_[ns]=vs;G_[ss]=_s;G_[Es]=os;G_[fs]=us;G_[Ts]=As;G_[Rs]=Os;G_[ds]=cs;G_[ls]=hs;G_[Ns]=Ss;G_[Ds]=gs;G_[Ls]=Cs;G_[Ps]=ys;G_[ms]=Fs;G_[ps]=Ys;G_[Bs]=Gs;G_[Vs]=ws;G_[Ws]=Ks;G_[Xs]=zs;G_[Qs]=ks;G_[Js]=t_;G_[r_]=a_;G_[n_]=i_;G_[v_]=__;G_[E_]=f_;G_[u_]=A_;G_[R_]=d_;G_[c_]=h_;G_[N_]=S_;G_[D_]=g_;G_[L_]=C_;G_[P_]=M_;var V_=145;var x_=30;var w_=function(t){var r=[x_,t.length+2,0,V_].concat(n(t));return[].concat(n(r),[F_(r)])};toBytes=H_;getBase64FromBytes=li;setDataSegment=w_})();
//#endregion


/*
  Incoming arguments:
    * msg - JSON message payload downlink message json
    * msgType - type of message, for ex. 'ATTRIBUTES_UPDATED', 'POST_TELEMETRY_REQUEST', etc.
    * metadata - list of key-value pairs with additional data about the message
    * integrationMetadata - list of key-value pairs with additional data defined in Integration executing this converter

  Output must be an object with the following fields:
    * contentType - BINARY
    * data - payload in base64
*/

var bytes = toBytes(msg.commands);

// send nothing if not fit in a single data segment
if ( bytes.length > MAX_DATA_SEGMENT_SIZE ) {
    bytes = [];
} else {
    bytes = setDataSegment(bytes);
}

var result = {
    contentType: 'BINARY',
    data: getBase64FromBytes(bytes)
};

return result;
