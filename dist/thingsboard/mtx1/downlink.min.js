// IMPORTANT!!!
// This example only for default downlink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/

// encoded message should be less than this size
// to be able to send to a device
var MAX_DATA_SEGMENT_SIZE = 50;


//#region [autogenerated jooby-codec bundle from index.js]
var toBytes,setDataSegment,getBase64FromBytes;(function(){"use strict";function t(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,a=Array(r);e<r;e++)a[e]=t[e];return a}function r(r){if(Array.isArray(r))return t(r)}function e(t,r,e){return(r=E(r))in t?Object.defineProperty(t,r,{value:e,enumerable:true,configurable:true,writable:true}):t[r]=e,t}function a(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t){return r(t)||a(t)||s(t)||n()}function v(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var a=e.call(t,r);if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function E(t){var r=v(t,"string");return"symbol"==typeof r?r:r+""}function s(r,e){if(r){if("string"==typeof r)return t(r,e);var a={}.toString.call(r).slice(8,-1);return"Object"===a&&r.constructor&&(a=r.constructor.name),"Map"===a||"Set"===a?Array.from(r):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(r,e):void 0}}var _=1;var o=2;var f=3;var u=4;var T=Math.log,A=Math.pow,R=Math.LN2;var O=function(t,r,e,a,n){var i,v,E=n*8-a-1,s=(1<<E)-1,_=s>>1,o=-7,f=e?n-1:0,u=e?-1:1,T=t[r+f];f+=u;i=T&(1<<-o)-1;T>>=-o;o+=E;for(;o>0;i=i*256+t[r+f],f+=u,o-=8);v=i&(1<<-o)-1;i>>=-o;o+=a;for(;o>0;v=v*256+t[r+f],f+=u,o-=8);if(i===0){i=1-_}else if(i===s){return v?NaN:T?-Infinity:Infinity}else{v=v+A(2,a);i=i-_}return(T?-1:1)*v*A(2,i-a)};var d=function(t,r,e,a,n,i){var v,E,s,_=i*8-n-1,o=(1<<_)-1,f=o>>1,u=n===23?A(2,-24)-A(2,-77):0,O=a?0:i-1,d=a?1:-1,c=e<0||e===0&&1/e<0?1:0;e<0&&(e=-e);if(e!==e||e===Infinity){E=e!==e?1:0;v=o}else{v=T(e)/R|0;if(e*(s=A(2,-v))<1){v--;s*=2}if(v+f>=1){e+=u/s}else{e+=u*A(2,1-f)}if(e*s>=2){v++;s/=2}if(v+f>=o){E=0;v=o}else if(v+f>=1){E=(e*s-1)*A(2,n);v=v+f}else{E=e*A(2,f-1)*A(2,n);v=0}}for(;n>=8;t[r+O]=E&255,O+=d,E/=256,n-=8);v=v<<n|E;_+=n;for(;_>0;t[r+O]=v&255,O+=d,v/=256,_-=8);t[r+O-d]|=c*128};var c=[1,0];var l=[2,1,0];var N=[3,2,1,0];var U=[0,1];var h=[0,1,2];var S=[0,1,2,3];var D=function(t,r){return t[r]};var L=function(t,r,e){var a=e?U:c;var n=t[r+a[0]];var i=t[r+a[1]]<<8;return n|i};var g=function(t,r,e){var a=e?h:l;var n=t[r+a[0]];var i=t[r+a[1]]<<8;var v=t[r+a[2]]<<16;return n|i|v};var I=function(t,r,e){var a=e?S:N;var n=t[r+a[3]]*16777216;var i=t[r+a[2]]*65536;var v=t[r+a[1]]*256;var E=t[r+a[0]];return n+i+v+E};var C=function(t,r,e){t[r]=e&255};var P=function(t,r,e,a){var n=a?U:c;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255};var M=function(t,r,e,a){var n=a?h:l;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255;t[r+n[2]]=e>>>16&255};var y=function(t,r,e,a){var n=a?S:N;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255;t[r+n[2]]=e>>>16&255;t[r+n[3]]=e>>>24&255};function m(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof t==="number"){var e=new Array(t).fill(0);this.data=e}else{this.data=t}this.offset=0;this.isLittleEndian=r}m.prototype={toUint8Array:function(){return this.data},seek:function(t){if(t<0||t>=this.data.length){throw new Error("Invalid position.")}this.offset=t},setInt8:function(t){C(this.data,this.offset,t<0?t|256:t);this.offset+=_},getInt8:function(){var t=D(this.data,this.offset);this.offset+=_;return t&128?t^-256:t},setUint8:function(t){C(this.data,this.offset,t);this.offset+=_},getUint8:function(){var t=D(this.data,this.offset);this.offset+=_;return t},setInt16:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;P(this.data,this.offset,t<0?t|65536:t,r);this.offset+=o},getInt16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=L(this.data,this.offset,t);this.offset+=o;return r&32768?r^-65536:r},setUint16:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;P(this.data,this.offset,t,r);this.offset+=o},getUint16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=L(this.data,this.offset,t);this.offset+=o;return r},setInt24:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;M(this.data,this.offset,t<0?t|16777216:t,r);this.offset+=f},getInt24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=g(this.data,this.offset,t);this.offset+=f;return r&8388608?r^-16777216:r},setUint24:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;M(this.data,this.offset,t,r);this.offset+=f},getUint24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=g(this.data,this.offset,t);this.offset+=f;return r},setInt32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;y(this.data,this.offset,t<0?t|4294967296:t,r);this.offset+=u},getInt32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=I(this.data,this.offset,t);this.offset+=u;return r&2147483648?r^-4294967296:r},setUint32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;y(this.data,this.offset,t,r);this.offset+=u},getUint32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=I(this.data,this.offset,t);this.offset+=u;return r},setFloat32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;d(this.data,this.offset,t,r,23,4);this.offset+=u},getFloat32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=O(this.data,this.offset,t,23,4);this.offset+=u;return r},setString:function(t){this.setUint8(t.length);for(var r=0;r<t.length;++r){this.setUint8(t.charCodeAt(r))}},getString:function(){var t=this.getUint8();var r=this.offset+t;var e=[];while(this.offset<r){e.push(String.fromCharCode(this.getUint8()))}return e.join("")},getBytesToOffset:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,t)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=r+t;return this.data.slice(r,this.offset)},setBytes:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var e=this.data;e.splice.apply(e,[r,t.length].concat(i(t)));this.data=e;this.offset=r+t.length}};Object.defineProperties(m.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var F=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var e=0;for(var a in r){if(a in t&&r[a]){e|=t[a]}}return e};var p=function(t,r,e,a){var n=(1<<r)-1<<e-1;var i=a;var v=t;v&=~n;i<<=e-1;v|=i;return v};var Y=80;var H=81;var G=82;var B=83;var V=84;var w=85;var x=86;var b=87;var W=88;var K=89;var X=90;var j=91;var z=255;var Q=Object.freeze({__proto__:null,DATA_REQUEST:Y,DATA_RESPONSE:H,FRAGMENT_REQUEST:X,FRAGMENT_RESPONSE:j,IDENT_REQUEST:G,IDENT_RESPONSE:B,INVALID:z,L2_CHECK_ADDRESS_REQUEST:x,L2_CHECK_ADDRESS_RESPONSE:b,L2_RM_ADDRESS_REQUEST:W,L2_RM_ADDRESS_RESPONSE:K,L2_SET_ADDRESS_REQUEST:V,L2_SET_ADDRESS_RESPONSE:w});var Z=function(t){var r={};for(var e in t){var a=t[e];r[a]=e}return r};Z(Q);var k=0;var q=1;var $=2;var J=3;var tt=Object.freeze({__proto__:null,READ_ONLY:J,READ_WRITE:$,ROOT:q,UNENCRYPTED:k});Z(tt);var rt=0;var et=1;var at=2;var nt=3;var it=4;var vt=5;var Et=6;var st=7;var _t=8;var ot=9;var ft=10;var ut=11;var Tt=12;var At=13;var Rt=14;var Ot=Object.freeze({__proto__:null,CASE_MODULE_OPEN:ft,CASE_OPEN:rt,CASE_TERMINAL_OPEN:ot,DEVICE_FAILURE:_t,ERROR_ACCESS:vt,MAGNETIC_ON:et,PARAMETERS_UPDATE_LOCAL:nt,PARAMETERS_UPDATE_REMOTE:at,PROTECTION_RESET_EM:At,PROTECTION_RESET_MAGNETIC:Rt,RESTART:it,TARIFF_TABLE_GET:Tt,TARIFF_TABLE_SET:ut,TIME_CORRECT:st,TIME_SET:Et});Z(Ot);var dt=1;var ct=3;var lt=4;var Nt=5;var Ut=7;var ht=8;var St=9;var Dt=13;var Lt=15;var gt=16;var It=17;var Ct=18;var Pt=19;var Mt=20;var yt=21;var mt=22;var Ft=23;var pt=24;var Yt=25;var Ht=28;var Gt=30;var Bt=31;var Vt=40;var wt=41;var xt=42;var bt=44;var Wt=45;var Kt=46;var Xt=47;var jt=49;var zt=50;var Qt=51;var Zt=52;var kt=53;var qt=54;var $t=57;var Jt=58;var tr=59;var rr=60;var er=61;var ar=62;var nr=65;var ir=70;var vr=74;var Er=75;var sr=79;var _r=80;var or=82;var fr=83;var ur=88;var Tr=89;var Ar=91;var Rr=92;var Or=93;var dr=94;var cr=100;var lr=109;var Nr=111;var Ur=112;var hr=113;var Sr=114;var Dr=115;var Lr=116;var gr=117;var Ir=118;var Cr=122;var Pr=Object.freeze({__proto__:null,activateRatePlan:Pt,getBv:Ur,getCorrectTime:ar,getCriticalEvent:nr,getCurrentStatusMeter:$t,getCurrentValues:Dt,getDateTime:Ut,getDayDemand:mt,getDayDemandExport:sr,getDayMaxDemand:jt,getDayMaxDemandExport:ur,getDayMaxDemandPrevious:vr,getDayProfile:tr,getDemand:Ir,getDemandParameters:gr,getDeviceId:Nt,getDeviceType:lt,getDisplayParam:dr,getEnergy:Lt,getEnergyDayPrevious:ct,getEnergyExport:Ar,getEnergyExportDayPrevious:_r,getEventStatus:dt,getEvents:Qt,getEventsCounters:Zt,getExtendedCurrentValues:Jt,getExtendedCurrentValues2:Wt,getHalfHourDemand:yt,getHalfHourDemandExport:fr,getHalfHourDemandPrevious:Er,getHalfHourEnergies:Nr,getMagneticFieldThreshold:lr,getMeterInfo:Cr,getMonthDemand:Ft,getMonthDemandExport:or,getMonthMaxDemand:zt,getMonthMaxDemandExport:Tr,getOperatorParameters:Gt,getOperatorParametersExtended3:hr,getQuality:Dr,getRatePlanInfo:bt,getSaldo:wt,getSaldoParameters:Kt,getSeasonProfile:rr,getSpecialDay:er,getVersion:Vt,prepareRatePlan:Mt,resetPowerMaxDay:kt,resetPowerMaxMonth:qt,runTariffPlan:ir,setAccessKey:St,setCorrectDateTime:Rr,setCorrectTime:Ht,setDateTime:ht,setDayProfile:gt,setDemandParameters:Lr,setDisplayParam:Or,setOperatorParameters:Bt,setOperatorParametersExtended3:Sr,setSaldo:xt,setSaldoParameters:Xt,setSeasonProfile:It,setSpecialDay:Ct,setSpecialOperation:cr,turnRelayOff:Yt,turnRelayOn:pt});Z(Pr);var Mr=1;var yr=2;var mr=3;var Fr=16;var pr=17;var Yr=18;var Hr=19;var Gr=20;var Br=21;var Vr=32;var wr=33;var xr=34;var br=35;var Wr=36;var Kr=37;var Xr=38;var jr=39;var zr=40;var Qr=41;var Zr=49;var kr=50;var qr=51;var $r=52;var Jr=53;var te=54;var re=55;var ee=56;var ae=57;var ne=58;var ie=59;var ve=64;var Ee=65;var se=66;var _e=67;var oe=68;var fe=69;var ue=70;var Te=71;var Ae=72;var Re=73;var Oe=74;var de=75;var ce=76;var le=77;var Ne=78;var Ue=79;var he=80;var Se=81;var De=82;var Le=83;var ge=84;var Ie=85;var Ce=86;var Pe=87;var Me=88;var ye=89;var me=96;var Fe=97;var pe=98;var Ye=99;var He=100;var Ge=101;var Be=102;var Ve=103;var we=104;var xe=105;var be=112;var We=113;var Ke=114;var Xe=115;var je=116;var ze=117;var Qe=118;var Ze=119;var ke=120;var qe=121;var $e=122;var Je=123;var ta=124;var ra=125;var ea=144;var aa=145;var na=147;var ia=148;var va=152;var Ea=156;var sa=157;var _a=158;var oa=159;var fa=160;var ua=161;var Ta=162;var Aa=176;var Ra=177;var Oa=178;var da=179;var ca=180;var la=181;var Na=182;var Ua=183;var ha=185;var Sa=186;var Da=224;var La=225;var ga=226;var Ia=227;var Ca=228;var Pa=229;var Ma=230;var ya=231;var ma=232;var Fa=Object.freeze({__proto__:null,ACCESS_ERROR:pr,ACCESS_LOCKED:Fr,ACC_PARAMETERS_EXT_FAULT:Xe,ACC_PARAMETERS_FAULT:Ke,BAD_TEST_EEPROM:we,BAD_TEST_FRAM:xe,BATTERY_FAULT:Le,BATTERY_OK:De,BIPOLAR_POWER_FAULT:ca,BIPOLAR_POWER_OK:la,BLOCK_TARIFF_FAULT:ze,CALC_PERIOD_FAULT:je,CALIBRATION_FAULT:Ie,CALIBRATION_FLAG_RESET:Ve,CALIBRATION_FLAG_SET:Be,CALIBRATION_OK:ge,CALIBRATION_PARAMETERS_FAULT:Qe,CASE_CLOSED:Hr,CASE_MODULE_CLOSED:ra,CASE_MODULE_OPENED:ta,CASE_OPENED:Yr,CASE_TERMINAL_BOX_CLOSED:Je,CASE_TERMINAL_BOX_OPENED:$e,CHANGE_ACCESS_KEY0:Vr,CHANGE_ACCESS_KEY1:wr,CHANGE_ACCESS_KEY2:xr,CHANGE_ACCESS_KEY3:br,CHANGE_COR_TIME:Qr,CHANGE_PARAMETERS_CHANNEL:ha,CHANGE_PARAMETERS_LOCAL:Wr,CHANGE_PARAMETERS_REMOTE:Kr,CHANGE_TARIFF_TABLE:kr,CHANGE_TARIFF_TABLE_2:va,CLOCK_FAULT:Pe,CLOCK_OK:Ce,CMD_RELAY_2_OFF:Fe,CMD_RELAY_2_ON:me,CMD_RELAY_OFF:zr,CMD_RELAY_ON:jr,CMD_SET_DATETIME:Xr,COSF_MIN_OVER:ie,COSF_OK:ne,CROSS_ZERO_EN_T1:pe,CROSS_ZERO_EN_T2:Ye,CROSS_ZERO_EN_T3:He,CROSS_ZERO_EN_T4:Ge,CROSS_ZERO_EXPORT_EN_T1:_a,CROSS_ZERO_EXPORT_EN_T2:oa,CROSS_ZERO_EXPORT_EN_T3:fa,CROSS_ZERO_EXPORT_EN_T4:ua,CURRENT_UNEQUAL_FAULT:Oa,CURRENT_UNEQUAL_OK:da,EM_MAGNETIC_INFLUENCE_OFF:Ra,EM_MAGNETIC_INFLUENCE_ON:Aa,ENERGY_REGISTER_FAULT:Mr,ENERGY_REGISTER_OVERFLOW:Zr,F_MAX_OK:Ae,F_MAX_OVER:Re,F_MIN_OK:Oe,F_MIN_OVER:de,I_MAX_OK:ce,I_MAX_OVER:le,MAGNETIC_INFLUENCE_OFF:Br,MAGNETIC_INFLUENCE_ON:Gr,OPERATOR_PARAMETERS_VALUES_FAULT:mr,POWER_A_OFF:Me,POWER_A_ON:ye,POWER_OVER_RELAY_OFF:sa,POWER_SALDO_OK:he,POWER_SALDO_OVER:Se,P_MAX_A_MINUS_OK:ya,P_MAX_A_MINUS_OVER:ma,P_MAX_OK:Ne,P_MAX_OVER:Ue,RELAY_HARD_BAD_OFF:ea,RELAY_HARD_BAD_ON:na,RELAY_HARD_OFF:ia,RELAY_HARD_ON:aa,RELAY_OFF:re,RELAY_OFF_BAD_SALDO:Sa,RELAY_ON:te,RESET_EM_FLAG:Na,RESET_MAGNET_FLAG:Ua,RESTART:ee,SALDO_EN_FAULT:ke,SALDO_PARAMETERS_FAULT:We,SET_DEMAND_EN_10MIN:Ia,SET_DEMAND_EN_15MIN:Ca,SET_DEMAND_EN_1MIN:Da,SET_DEMAND_EN_30MIN:Pa,SET_DEMAND_EN_3MIN:La,SET_DEMAND_EN_5MIN:ga,SET_DEMAND_EN_60MIN:Ma,SET_NEW_SALDO:be,SET_SALDO_PARAM:Ea,SET_TARIFF_TABLE:qr,SUMMER_TIME:$r,TIME_CORRECT:qe,TIME_CORRECT_NEW:Ta,T_MAX_OK:oe,T_MAX_OVER:fe,T_MIN_OK:ue,T_MIN_OVER:Te,VENDOR_PAR_FAULT:yr,V_MAX_OK:ve,V_MAX_OVER:Ee,V_MIN_OK:se,V_MIN_OVER:_e,WATCHDOG_RESTART:ae,WINTER_SUMMER_FAULT:Ze,WINTER_TIME:Jr});Z(Fa);var pa=0;var Ya=128;var Ha=129;var Ga=130;var Ba=131;var Va=132;var wa=133;var xa=134;var ba=135;var Wa=136;var Ka=137;var Xa=144;var ja=145;var za=146;var Qa=147;var Za=149;var ka=151;var qa=152;var $a=153;var Ja=154;var tn=155;var rn=156;var en=159;var an=160;var nn=240;var vn=Object.freeze({__proto__:null,ACCESS_DENIED:Qa,BAD_ARRAY_INDEX:xa,BAD_BLOCK_NUMBER:rn,BAD_DATA_LENGTH:wa,BAD_MESSAGE:Va,BAD_RATE_PLAN_ID:Wa,BAD_RATE_PLAN_SIZE:Ka,BAD_RESPONSE_LENGTH:Xa,BAD_SALDO_WRITE:Za,BLOCKED_METER:ka,CALIBRATION_DISABLED:za,DECRYPTION_FAILURE:Ga,INTERNAL:nn,INVALID_CORRECTION_INTERVAL:Ja,NOT_ALIGNED_DATA:Ha,NOT_PREPARED_RATE_PLAN:ba,NO_DATA_FOR_DATE:ja,OK:pa,OUT_OFF_RANGE:en,SET_METER_TYPE_FAILURE:an,TIME_CORRECTION_FAILURE:$a,TIME_CORRECTION_OUT_HALF_HOUR_DISABLED:tn,UNENCRYPTED_COMMAND_DISABLED:qa,UNKNOWN_COMMAND:Ya,UNKNOWN_PROTOCOL:Ba});Z(vn);var En=1;var sn=2;var _n=3;var on=4;var fn=5;var un=6;var Tn=7;var An=8;var Rn=9;var On=10;var dn=11;var cn=12;var ln=13;var Nn=14;var Un=15;var hn=16;var Sn=17;var Dn=18;var Ln=19;var gn=20;var In=21;var Cn=22;var Pn=23;var Mn=24;var yn=25;var mn=26;var Fn=28;var pn=30;var Yn=31;var Hn=Object.freeze({__proto__:null,ACTIVE_ENERGY_T1:on,ACTIVE_ENERGY_T2:fn,ACTIVE_ENERGY_T3:un,ACTIVE_ENERGY_T4:Tn,ACTIVE_POWER_IN_NEUTRAL:Rn,ACTIVE_POWER_PER_PHASE:An,BATTERY_VOLTAGE:Cn,CURRENT_BALANCE:pn,CURRENT_IN_NEUTRAL:dn,CURRENT_IN_PHASE:On,DATE_MONTH_YEAR:Nn,EXPORTED_ACTIVE_ENERGY_T1:hn,EXPORTED_ACTIVE_ENERGY_T2:Sn,EXPORTED_ACTIVE_ENERGY_T3:Dn,EXPORTED_ACTIVE_ENERGY_T4:Ln,HOUR_MINUTE_SECOND:ln,MAGNET_INDUCTION:Fn,OPTOPORT_SPEED:Yn,POWER_FACTOR_PHASE_A:gn,POWER_FACTOR_PHASE_B:In,POWER_THRESHOLD_T1:Pn,POWER_THRESHOLD_T2:Mn,POWER_THRESHOLD_T3:yn,POWER_THRESHOLD_T4:mn,SET_ALL_SEGMENT_DISPLAY:En,SOFTWARE_VERSION:sn,TOTAL_ACTIVE_ENERGY:_n,TOTAL_EXPORTED_ACTIVE_ENERGY:Un,VOLTAGE:cn});Z(Hn);var Gn=120;var Bn=121;var Vn=123;var wn=254;var xn=255;var bn=Object.freeze({__proto__:null,activateRatePlan:Pt,errorDataFrameResponse:xn,errorResponse:wn,getBv:Ur,getCorrectTime:ar,getCriticalEvent:nr,getCurrentDemand:Vn,getCurrentStatusMeter:$t,getCurrentValues:Dt,getDateTime:Ut,getDayDemand:mt,getDayDemandExport:sr,getDayEnergies:Gn,getDayMaxDemand:jt,getDayMaxDemandExport:ur,getDayMaxDemandPrevious:vr,getDayMaxPower:Bn,getDayProfile:tr,getDemand:Ir,getDemandParameters:gr,getDeviceId:Nt,getDeviceType:lt,getDisplayParam:dr,getEnergy:Lt,getEnergyDayPrevious:ct,getEnergyExport:Ar,getEnergyExportDayPrevious:_r,getEventStatus:dt,getEvents:Qt,getEventsCounters:Zt,getExtendedCurrentValues:Jt,getExtendedCurrentValues2:Wt,getHalfHourDemand:yt,getHalfHourDemandExport:fr,getHalfHourDemandPrevious:Er,getHalfHourEnergies:Nr,getMagneticFieldThreshold:lr,getMeterInfo:Cr,getMonthDemand:Ft,getMonthDemandExport:or,getMonthMaxDemand:zt,getMonthMaxDemandExport:Tr,getOperatorParameters:Gt,getOperatorParametersExtended3:hr,getQuality:Dr,getRatePlanInfo:bt,getSaldo:wt,getSaldoParameters:Kt,getSeasonProfile:rr,getSpecialDay:er,getVersion:Vt,prepareRatePlan:Mt,resetPowerMaxDay:kt,resetPowerMaxMonth:qt,runTariffPlan:ir,setAccessKey:St,setCorrectDateTime:Rr,setCorrectTime:Ht,setDateTime:ht,setDayProfile:gt,setDemandParameters:Lr,setDisplayParam:Or,setOperatorParameters:Bt,setOperatorParametersExtended3:Sr,setSaldo:xt,setSaldoParameters:Xt,setSeasonProfile:It,setSpecialDay:Ct,setSpecialOperation:cr,turnRelayOff:Yt,turnRelayOn:pt});Z(bn);var Wn=2400;var Kn=9600;var Xn={rs485orTwi:{0:Kn,2:Wn,4:Kn},optoport:{0:Wn,2:Wn,4:Kn}};var jn={rs485orTwi:Z(Xn.rs485orTwi),optoport:Z(Xn.optoport)};var zn=11;var Qn=74;var Zn=7;var kn=2+Zn;var qn={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_FACTOR_PHASE_A:524288,POWER_FACTOR_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var $n={...qn,AUTO_SCREEN_SCROLLING:2147483648};var Jn={...qn,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var ti={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_1:8,RELAY_ON_TARIFF_2:16,RELAY_ON_TARIFF_3:32,RELAY_ON_TARIFF_4:64,RELAY_ON_V_GOOD:128};var ri={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_1:4,RELAY_OFF_TARIFF_2:8,RELAY_OFF_TARIFF_3:16,RELAY_OFF_TARIFF_4:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var ei={RELAY_OFF_LIM_TARIFF_1:2,RELAY_OFF_LIM_TARIFF_2:4,RELAY_OFF_LIM_TARIFF_3:8,RELAY_OFF_LIM_TARIFF_4:16,RELAY_OFF_PF_MIN:32};var ai={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var ni={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var ii={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var vi={RELAY_OFF_LIMIT_P_MINUS_T1:8,RELAY_OFF_LIMIT_P_MINUS_T2:16,RELAY_OFF_LIMIT_P_MINUS_T3:32,RELAY_OFF_LIMIT_P_MINUS_T4:64};var Ei=function(t){var r=0;r=p(r,4,1,Number(jn.rs485orTwi[t.rs485orTwi]));r=p(r,4,5,Number(jn.optoport[t.optoport]));return r};var si=function(t){var r=0;r=p(r,2,1,t.tariff);r=p(r,1,3,+!t.isFirstHalfHour);r=p(r,5,4,t.hour);return r};var _i=function(t,r){t.setUint8(r.isSummerTime?1:0);t.setUint8(r.seconds);t.setUint8(r.minutes);t.setUint8(r.hours);t.setUint8(r.day||0);t.setUint8(r.date);t.setUint8(r.month);t.setUint8(r.year)};var oi=function(t,r){t.setUint32(r.id);t.setUint8(r.tariffSet);t.setUint8(r.activateYear);t.setUint8(r.activateMonth);t.setUint8(r.activateDay);t.setUint8(r.specialProfilesArraySize);t.setUint8(r.seasonProfilesArraySize);t.setUint8(r.dayProfilesArraySize)};var fi=function(t,r){t.setUint8(r.monthTransitionSummer);t.setUint8(r.dateTransitionSummer);t.setUint8(r.hoursTransitionSummer);t.setUint8(r.hoursCorrectSummer);t.setUint8(r.monthTransitionWinter);t.setUint8(r.dateTransitionWinter);t.setUint8(r.hoursTransitionWinter);t.setUint8(r.hoursCorrectWinter);t.setUint8(+r.isCorrectionNeeded)};var ui=function(t,r){t.setUint8(si(r))};var Ti=function(t,r){t.setUint8(r.month);t.setUint8(r.date);r.dayIndexes.forEach(function(r){return t.setUint8(r)})};var Ai=function(t,r){t.setUint8(r.month);t.setUint8(r.date);t.setUint8(r.dayIndex);t.setUint8(r.year)};var Ri=function(t,r){var e=r.timeCorrectPeriod|(r.timeCorrectPassHalfhour?128:0);t.setUint32(r.vpThreshold);t.setUint32(r.vThreshold);t.setUint32(r.ipThreshold);t.setUint32(r.pmaxThreshold0);t.setUint32(r.pmaxThreshold1);t.setUint32(r.pmaxThreshold2);t.setUint32(r.pmaxThreshold3);t.setUint8(Ei(r.serialPortsSpeed));t.setUint8(r.tint);t.setUint8(r.calcPeriodDate);t.setUint8(r.timeoutDisplay);t.setUint8(r.timeoutScreen);t.setUint32(F($n,r.displaySet));t.setUint8(F(ai,r.relaySet4));t.setUint8(F(ei,r.relaySet3));t.setUint8(F(ri,r.relaySet2));t.setUint8(F(ti,r.relaySet1));t.setUint8(r.displayType);t.setUint8(r.ten);t.setUint8(r.voltageAveragingInterval);t.setUint8(0);t.setUint8(r.deltaCorMin);t.setUint8(r.timeoutMagnetOff);t.setUint8(r.timeoutMagnetOn);t.setUint8(F(ii,r.define1));t.setUint8(r.timeoutRelayOn);t.setUint8(r.timeoutRelayKey);t.setUint8(r.timeoutRelayAuto);t.setUint8(r.timeoutBadVAVB);t.setUint8(r.freqMax);t.setUint8(r.freqMin);t.setUint16(r.phMin);t.setUint8(r.year);t.setUint8(r.month);t.setUint8(r.date);t.setUint8(r.energyDecimalPoint);t.setUint8(r.typeMeter);t.setUint8(r.timeoutIMax);t.setUint8(r.timeoutPMax);t.setUint8(r.timeoutCos);t.setUint8(r.pMaxDef);t.setUint32(F(Jn,r.displaySetExt));t.setUint8(r.timeoutUneqCurrent);t.setUint8(r.timeoutBipolarPower);t.setUint8(F(ni,r.relaySet5));t.setUint8(e)};var Oi=function(t,r){t.setUint8(r.year);t.setUint8(r.month);t.setUint8(r.date)};var di=function(t,r){r.coefficients.forEach(function(r){return t.setUint32(r)});t.setUint8(r.decimalPointTariff);t.setInt32(r.indicationThreshold);t.setInt32(r.relayThreshold);t.setUint8(r.mode);t.setUint8(r.saldoOffTimeBegin);t.setUint8(r.saldoOffTimeEnd);t.setUint8(r.decimalPointIndication);t.setUint32(r.powerThreshold);t.setInt32(r.creditThreshold)};var ci=function(t,r){var e=r.date.year<<1|r.date.month>>3&1;var a=r.date.month<<5&224|r.date.date&31;t.setUint8(e);t.setUint8(a);t.setUint8(r.demandType);t.setUint16(r.firstIndex);t.setUint8(r.count);t.setUint8(r.period)};var li=function(t,r){t.setUint8(r.channelParam1);t.setUint8(r.powerOffTrackingInterval);t.setUint8(r.channelParam2);t.setUint8(0)};var Ni=function(t,r){var e=r.pmaxMinusThreshold0,a=r.pmaxMinusThreshold1,n=r.pmaxMinusThreshold2,i=r.pmaxMinusThreshold3,v=r.relaySet;t.setUint32(e);t.setUint32(a);t.setUint32(n);t.setUint32(i);t.setUint8(F(vi,v))};var Ui=function(t){return btoa(t.map(function(t){return String.fromCharCode(t)}).join(""))};var hi=function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[t,r.length].concat(i(r))};var Si=Pt;var Di=1+zn;var Li=function(t){var r=new m(Di,false);r.setUint8(t.tariffTable);oi(r,t.tariffPlan);return hi(Si,r.data)};var gi=Ur;var Ii=function(){return hi(gi)};var Ci=ar;var Pi=function(){return hi(Ci)};var Mi=nr;var yi=function(t){return hi(Mi,[t.event,t.index])};var mi=$t;var Fi=function(){return hi(mi)};var pi=Dt;var Yi=function(){return hi(pi)};var Hi=Ut;var Gi=function(){return hi(Hi)};var Bi=3;var Vi=4;var wi=mt;var xi=function(t){var r=new m(t?.energyType?Vi:Bi);Oi(r,t?.date);if(t?.energyType){r.setUint8(t.energyType)}return hi(wi,r.data)};var bi=3;var Wi=4;var Ki=sr;var Xi=function(t){var r=new m(t?.energyType?Wi:bi,false);Oi(r,t?.date);if(t?.energyType){r.setUint8(t.energyType)}return hi(Ki,r.data)};var ji=jt;var zi=3;var Qi=function(t){var r=new m(zi,false);Oi(r,t.date);return hi(ji,r.data)};var Zi=ur;var ki=3;var qi=function(t){var r=new m(ki,false);Oi(r,t.date);return hi(Zi,r.data)};var $i=vr;var Ji=function(){return hi($i)};var tv=tr;var rv=3;var ev=function(t){var r=new m(rv,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return hi(tv,r.data)};var av=Ir;var nv=7;var iv=function(t){var r=new m(nv,false);ci(r,t);return hi(av,r.data)};var vv=gr;var Ev=function(){return hi(vv)};var sv=Nt;var _v=function(){return hi(sv)};var ov=lt;var fv=function(){return hi(ov)};var uv=dr;var Tv=1;var Av=function(t){var r=new m(Tv,false);r.setUint8(t.displayMode);return hi(uv,r.data)};var Rv=0;var Ov=1;var dv=Lt;var cv=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=new m(t?.energyType?Ov:Rv,false);if(t?.energyType){r.setUint8(t.energyType)}return hi(dv,r.data)};var lv=ct;var Nv=function(t){if(t.energyType){return hi(lv,[t.energyType])}return hi(lv)};var Uv=0;var hv=1;var Sv=Ar;var Dv=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=new m(t?.energyType?hv:Uv,false);if(t?.energyType){r.setUint8(t.energyType)}return hi(Sv,r.data)};var Lv=_r;var gv=function(t){if(t.energyType){return hi(Lv,[t.energyType])}return hi(Lv)};var Iv=Qt;var Cv=4;var Pv=function(t){var r=new m(Cv,false);Oi(r,t.date);r.setUint8(t.offset);return hi(Iv,r.data)};var Mv=Zt;var yv=function(){return hi(Mv)};var mv=dt;var Fv=function(){return hi(mv)};var pv=Jt;var Yv=function(){return hi(pv)};var Hv=Wt;var Gv=function(){return hi(Hv)};var Bv=yt;var Vv=3;var wv=function(t){var r=new m(Vv,false);Oi(r,t.date);return hi(Bv,r.data)};var xv=fr;var bv=3;var Wv=function(t){var r=new m(bv,false);Oi(r,t.date);return hi(xv,r.data)};var Kv=Er;var Xv=function(){return hi(Kv)};var jv={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var zv=function(t){var r={};Object.keys(t).forEach(function(e){r[e]=!!t[e]});return F(jv,r)};var Qv=function(t,r){var e=r.year,a=r.month,n=r.date;var i=e<<1|a>>3&1;var v=a<<5&224|n&31;t.setUint8(i);t.setUint8(v)};var Zv=function(t,r){t.setUint8(zv(r))};var kv=Nr;var qv=5;var $v=function(t){var r=new m(qv,false);Qv(r,t.date);Zv(r,t.energies);r.setUint8(t.firstHalfhour);r.setUint8(t.halfhoursNumber);return hi(kv,r.data)};var Jv=lr;var tE=function(){return hi(Jv)};var rE=Cr;var eE=function(){return hi(rE)};var aE=Ft;var nE=2;var iE=function(t){var r=new m(nE,false);r.setUint8(t.year);r.setUint8(t.month);return hi(aE,r.data)};var vE=or;var EE=2;var sE=function(t){var r=new m(EE,false);r.setUint8(t.year);r.setUint8(t.month);return hi(vE,r.data)};var _E=zt;var oE=function(t){var r=t.year,e=t.month;return hi(_E,[r,e])};var fE=Tr;var uE=function(t){var r=t.year,e=t.month;return hi(fE,[r,e])};var TE=Gt;var AE=function(){return hi(TE)};var RE=hr;var OE=function(){return hi(RE)};var dE=Dr;var cE=function(t){var r=t.year,e=t.month;return hi(dE,[r,e])};var lE=bt;var NE=function(t){return hi(lE,[t.tariffTable])};var UE=wt;var hE=function(){return hi(UE)};var SE=Kt;var DE=function(){return hi(SE)};var LE=rr;var gE=3;var IE=function(t){var r=new m(gE,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return hi(LE,r.data)};var CE=er;var PE=3;var ME=function(t){var r=new m(PE,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return hi(CE,r.data)};var yE=Vt;var mE=function(){return hi(yE)};var FE=Mt;var pE=5;var YE=function(t){var r=new m(pE,false);r.setUint8(t.tariffTable);r.setUint32(t.id);return hi(FE,r.data)};var HE=kt;var GE=function(){return hi(HE)};var BE=qt;var VE=function(){return hi(BE)};var wE=ir;var xE=function(t){return hi(wE,[t.tariffTable])};var bE=16;var WE=St;var KE=1+bE;var XE=function(t){var r=new m(KE,false);r.setUint8(t.accessLevel);r.setBytes(t.key);return hi(WE,r.data)};var jE=Rr;var zE=2;var QE=function(t){var r=new m(zE,false);r.setInt16(t.seconds);return hi(jE,r.data)};var ZE=Ht;var kE=9;var qE=function(t){var r=new m(kE,false);fi(r,t);return hi(ZE,r.data)};var $E=ht;var JE=8;var ts=function(t){var r=new m(JE,false);_i(r,t);return hi($E,r.data)};var rs=8;var es=255;var as=gt;var ns=function(t){var r=t.periods.length<rs;var e=2+t.periods.length+ +r;var a=new m(e,false);a.setUint8(t.tariffTable);a.setUint8(t.index);t.periods.forEach(function(t){ui(a,t)});if(r){a.setUint8(es)}return hi(as,a.data)};var is=Lr;var vs=4;var Es=function(t){var r=new m(vs,false);li(r,t);return hi(is,r.data)};var ss=Or;var _s=function(t){return hi(ss,[t.displayMode].concat(i(t.order)))};var os=Bt;var fs=Qn;var us=function(t){var r=new m(fs,false);Ri(r,t);return hi(os,r.data)};var Ts=Sr;var As=17;var Rs=function(t){var r=new m(As,false);Ni(r,t);return hi(Ts,r.data)};var Os=xt;var ds=12;var cs=function(t){var r=new m(ds,false);r.setUint8(t.date.month);r.setUint8(t.date.date);r.setUint8(t.date.hours);r.setUint8(t.date.minutes);r.setInt32(t.saldoNew);r.setInt32(t.saldoOld);return hi(Os,r.data)};var ls=Xt;var Ns=37;var Us=function(t){var r=new m(Ns,false);di(r,t);return hi(ls,r.data)};var hs=It;var Ss=2+kn;var Ds=function(t){var r=new m(Ss,false);r.setUint8(t.tariffTable);r.setUint8(t.index);Ti(r,t);return hi(hs,r.data)};var Ls=Ct;var gs=6;var Is=function(t){var r=new m(gs,false);r.setUint8(t.tariffTable);r.setUint8(t.index);Ai(r,t);return hi(Ls,r.data)};var Cs=cr;var Ps=2;var Ms=function(t){var r=new m(Ps,false);var e=0;if(t.readScreensInfo){e|=128}if(t.resetElectroMagneticIndication){e|=1}if(t.resetMagneticIndication){e|=2}r.setUint8(t.type);r.setUint8(e);return hi(Cs,r.data)};var ys=Yt;var ms=function(){return hi(ys)};var Fs=pt;var ps=function(){return hi(Fs)};var Ys=xn;var Hs={encrypt:function(){},decrypt:function(){}};var Gs=function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var e=r;t.forEach(function(t){e^=t});return e};var Bs=e(e(e(e({},k,0),J,1),$,2),q,3);var Vs=function(t){var r=J;t.forEach(function(t){var e;if("accessLevel"in t){e=t.accessLevel}if("command"in t){e=t.command.accessLevel}if(Bs[e]>Bs[r]){r=e}});return r};var ws=16;var xs=[0];var bs=function(t){return function(r,e){var a=e.messageId,n=a===void 0?1:a,v=e.accessLevel,E=v===void 0?Vs(r):v,s=e.aesKey;var _=r.flatMap(function(r){if("id"in r){return t[r.id](r.parameters||{})}if("command"in r){return r.command.bytes}throw new Error("wrong command format")});var o=E|16;var f=[n,o];var u=r.length===1&&"id"in r[0]&&r[0].id===Ys;if(u){return f.concat(_)}var T=[].concat(o,_,xs);if(E!==k){var A=(T.length+1)%ws;if(A){T=T.concat(new Array(ws-A).fill(0))}}T=T.concat(Gs(T));if(s&&E!==k){T=i(Hs.encrypt(s,T))}return f.concat(T)}};var Ws={};var Ks=bs(Ws);Ws[Si]=Li;Ws[gi]=Ii;Ws[Ci]=Pi;Ws[Mi]=yi;Ws[mi]=Fi;Ws[pi]=Yi;Ws[Hi]=Gi;Ws[wi]=xi;Ws[Ki]=Xi;Ws[ji]=Qi;Ws[Zi]=qi;Ws[$i]=Ji;Ws[tv]=ev;Ws[av]=iv;Ws[vv]=Ev;Ws[sv]=_v;Ws[ov]=fv;Ws[uv]=Av;Ws[dv]=cv;Ws[lv]=Nv;Ws[Sv]=Dv;Ws[Lv]=gv;Ws[Iv]=Pv;Ws[Mv]=yv;Ws[mv]=Fv;Ws[pv]=Yv;Ws[Hv]=Gv;Ws[Bv]=wv;Ws[xv]=Wv;Ws[Kv]=Xv;Ws[kv]=$v;Ws[Jv]=tE;Ws[rE]=eE;Ws[aE]=iE;Ws[vE]=sE;Ws[_E]=oE;Ws[fE]=uE;Ws[TE]=AE;Ws[RE]=OE;Ws[dE]=cE;Ws[lE]=NE;Ws[UE]=hE;Ws[SE]=DE;Ws[LE]=IE;Ws[CE]=ME;Ws[yE]=mE;Ws[FE]=YE;Ws[HE]=GE;Ws[BE]=VE;Ws[wE]=xE;Ws[WE]=XE;Ws[jE]=QE;Ws[ZE]=qE;Ws[$E]=ts;Ws[as]=ns;Ws[is]=Es;Ws[ss]=_s;Ws[os]=us;Ws[Ts]=Rs;Ws[Os]=cs;Ws[ls]=Us;Ws[hs]=Ds;Ws[Ls]=Is;Ws[Cs]=Ms;Ws[ys]=ms;Ws[Fs]=ps;var Xs=145;var js=30;var zs=function(t){var r=[js,t.length+2,0,Xs].concat(i(t));return[].concat(i(r),[Gs(r)])};toBytes=Ks;getBase64FromBytes=Ui;setDataSegment=zs})();
//#endregion


/*
  Incoming arguments:
    * msg - JSON message payload downlink message json
    * msgType - type of message, for ex. 'ATTRIBUTES_UPDATED', 'POST_TELEMETRY_REQUEST', etc.
    * metadata - list of key-value pairs with additional data about the message
    * integrationMetadata - list of key-value pairs with additional data defined in Integration executing this converter

  Output must be an object with the following fields:
    * contentType - BINARY
    * data - payload in base64
*/

var bytes = toBytes(msg.commands);

// send nothing if not fit in a single data segment
if ( bytes.length > MAX_DATA_SEGMENT_SIZE ) {
    bytes = [];
} else {
    bytes = setDataSegment(bytes);
}

var result = {
    contentType: 'BINARY',
    data: getBase64FromBytes(bytes)
};

return result;
