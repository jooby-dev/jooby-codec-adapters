// IMPORTANT!!!
// This example only for default downlink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/

// encoded message should be less than this size
// to be able to send to a device
var MAX_DATA_SEGMENT_SIZE = 50;


//#region [autogenerated jooby-codec bundle from index.js]
var toBytes,setDataSegment,getBase64FromBytes;(function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(t){if(Array.isArray(t))return t}function r(e){if(Array.isArray(e))return t(e)}function n(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function i(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,s,o=[],v=true,f=false;try{if(a=(r=r.call(t)).next,0===e);else for(;!(v=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);v=!0);}catch(t){f=true,i=t}finally{try{if(!v&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(f)throw i}}return o}}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,r){return e(t)||i(t,r)||f(t,r)||a()}function v(t){return r(t)||n(t)||f(t)||s()}function f(e,r){if(e){if("string"==typeof e)return t(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}var u={separator:" ",prefix:""};var h=1;var E=2;var _=3;var A=4;var g=Math.log,T=Math.pow,c=Math.LN2;var d=function(t,e,r,n,i){var a,s,o=i*8-n-1,v=(1<<o)-1,f=v>>1,u=-7,h=r?i-1:0,E=r?-1:1,_=t[e+h];h+=E;a=_&(1<<-u)-1;_>>=-u;u+=o;for(;u>0;a=a*256+t[e+h],h+=E,u-=8);s=a&(1<<-u)-1;a>>=-u;u+=n;for(;u>0;s=s*256+t[e+h],h+=E,u-=8);if(a===0){a=1-f}else if(a===v){return s?NaN:_?-Infinity:Infinity}else{s=s+T(2,n);a=a-f}return(_?-1:1)*s*T(2,a-n)};var l=function(t,e,r,n,i,a){var s,o,v,f=a*8-i-1,u=(1<<f)-1,h=u>>1,E=i===23?T(2,-24)-T(2,-77):0,_=n?0:a-1,A=n?1:-1,d=r<0||r===0&&1/r<0?1:0;r<0&&(r=-r);if(r!==r||r===Infinity){o=r!==r?1:0;s=u}else{s=g(r)/c|0;if(r*(v=T(2,-s))<1){s--;v*=2}if(s+h>=1){r+=E/v}else{r+=E*T(2,1-h)}if(r*v>=2){s++;v/=2}if(s+h>=u){o=0;s=u}else if(s+h>=1){o=(r*v-1)*T(2,i);s=s+h}else{o=r*T(2,h-1)*T(2,i);s=0}}for(;i>=8;t[e+_]=o&255,_+=A,o/=256,i-=8);s=s<<i|o;f+=i;for(;f>0;t[e+_]=s&255,_+=A,s/=256,f-=8);t[e+_-A]|=d*128};var p=[1,0];var R=[2,1,0];var U=[3,2,1,0];var y=[0,1];var O=[0,1,2];var m=[0,1,2,3];var S=function(t,e){return t[e]};var P=function(t,e,r){var n=r?y:p;var i=t[e+n[0]];var a=t[e+n[1]]<<8;return i|a};var M=function(t,e,r){var n=r?O:R;var i=t[e+n[0]];var a=t[e+n[1]]<<8;var s=t[e+n[2]]<<16;return i|a|s};var D=function(t,e,r){var n=r?m:U;var i=t[e+n[3]]*16777216;var a=t[e+n[2]]*65536;var s=t[e+n[1]]*256;var o=t[e+n[0]];return i+a+s+o};var N=function(t,e,r){t[e]=r&255};var I=function(t,e,r,n){var i=n?y:p;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255};var C=function(t,e,r,n){var i=n?O:R;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255;t[e+i[2]]=r>>>16&255};var L=function(t,e,r,n){var i=n?m:U;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255;t[e+i[2]]=r>>>16&255;t[e+i[3]]=r>>>24&255};function F(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof t==="number"){var r=new Array(t).fill(0);this.data=r}else{this.data=t}this.offset=0;this.isLittleEndian=e}F.prototype={toUint8Array:function(){return this.data},seek:function(t){if(t<0||t>=this.data.length){throw new Error("Invalid position.")}this.offset=t},setInt8:function(t){N(this.data,this.offset,t<0?t|256:t);this.offset+=h},getInt8:function(){var t=S(this.data,this.offset);this.offset+=h;return t&128?t^-256:t},setUint8:function(t){N(this.data,this.offset,t);this.offset+=h},getUint8:function(){var t=S(this.data,this.offset);this.offset+=h;return t},setInt16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;I(this.data,this.offset,t<0?t|65536:t,e);this.offset+=E},getInt16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=P(this.data,this.offset,t);this.offset+=E;return e&32768?e^-65536:e},setUint16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;I(this.data,this.offset,t,e);this.offset+=E},getUint16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=P(this.data,this.offset,t);this.offset+=E;return e},setInt24:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;C(this.data,this.offset,t<0?t|16777216:t,e);this.offset+=_},getInt24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=M(this.data,this.offset,t);this.offset+=_;return e&8388608?e^-16777216:e},setUint24:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;C(this.data,this.offset,t,e);this.offset+=_},getUint24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=M(this.data,this.offset,t);this.offset+=_;return e},setInt32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;L(this.data,this.offset,t<0?t|4294967296:t,e);this.offset+=A},getInt32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=D(this.data,this.offset,t);this.offset+=A;return e&2147483648?e^-4294967296:e},setUint32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;L(this.data,this.offset,t,e);this.offset+=A},getUint32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=D(this.data,this.offset,t);this.offset+=A;return e},setFloat32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;l(this.data,this.offset,t,e,23,4);this.offset+=A},getFloat32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=d(this.data,this.offset,t,23,4);this.offset+=A;return e},setString:function(t){this.setUint8(t.length);for(var e=0;e<t.length;++e){this.setUint8(t.charCodeAt(e))}},getString:function(){var t=this.getUint8();var e=this.offset+t;var r=[];while(this.offset<e){r.push(String.fromCharCode(this.getUint8()))}return r.join("")},getBytesToOffset:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,t)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=e+t;return this.data.slice(e,this.offset)},setBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var r=this.data;r.splice.apply(r,[e,t.length].concat(v(t)));this.data=r;this.offset=e+t.length}};Object.defineProperties(F.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var x=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=0;for(var n in e){if(n in t&&e[n]){r|=t[n]}}return r};var w=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r={};for(var n in t){r[n]=(e&t[n])!==0}return r};var Y=function(t,e,r){return(1<<e)-1&t>>r-1};var B=function(t,e,r,n){var i=(1<<e)-1<<r-1;var a=n;var s=t;s&=~i;a<<=r-1;s|=a;return s};var H=function(t){var e=t.trim();if(!e){return[]}e=e.replace(/0x/g,"").split(/\s+/).map((function(t){return t.padStart(2,"0")})).join("");if(e.length%2!==0){e="0".concat(e)}var r=e.length/2;var n=new Array(r);for(var i=0;i<r;i++){n[i]=parseInt(e.substring(i*2,i*2+2),16)}return n};var G="x";var V=[".","1","3","R","M"];var W=[".","A","G","R","T","D"];var b=[".","0","1","2","3","4","5"];var K=[".","A","B","C","D","E","F"];var X=[".","A","B","C","D","E","F","H","K","G"];var j=[".","1","2","3","4"];var z=[".","L","M","Z","K"];var Q=[".","0","1","2","3","4","5","6","7","8","9"];var Z=[".","D","B","C","E","P","R","O","L","F","S","M","Y","G","N","U"];var k=[".","0","1","2","3","4","5","6","P","R","L","E","G","-","/"];var q=[".","H","A","T","0","0","0","0","0","1","2","3","4","0","0","0"];var $=[".","0","1","2","3","4","5","6","7","8","I","X","G","W","M","-"];var J={typeMeterG:1<<0,downgradedToA:1<<4,supportMeterInfo:1<<6};var tt={typeMeterTransformer:1<<0,downgradedToR:1<<3,typeMeterG:1<<4,supportMeterInfo:1<<6,reactiveRPlusRMinus:1<<7};var et=function(t){return[t>>4,t&15]};var rt=function(t){var e=new Array(t.length*2).fill(0);t.forEach((function(t,r){var n=et(t),i=o(n,2),a=i[0],s=i[1];e[r*2]=a;e[r*2+1]=s}));return e};var nt=function(t){var e=[];t.forEach((function(t){return e.push(t.toString(16))}));if(t.length&1){e.push("0")}return H(e.join(""))};var it=function(t){if(t.length!==14&&t.length!==16){throw new Error("Device type bytes wrong size")}var e=["MTX "];e.push(V[t[0]]??G);e.push(W[t[1]]??G);e.push(b[t[2]]??G);e.push(b[t[3]]??G);e.push(".");e.push(K[t[4]]??G);e.push(X[t[5]]??G);e.push(".");e.push(j[t[6]]??G);e.push(z[t[7]]??G);var r=t[8];e.push(Q[t[9]]??G);e.push("-");var n;if(t.length<14||t[12]===0&&t[13]===0){e.push(Z[t[10]]??G);n=11}else if(t[13]===0){e.push(Z[t[10]]??G);e.push(Z[t[11]]??G);n=12}else{e.push(Z[t[10]]??G);e.push(Z[t[11]]??G);e.push(Z[t[12]]??G);n=13}var i=t[n];if(i&&i!==0){e.push(q[i]??G)}return{type:e.join(""),revision:r}};var at=function(t,e,r){var n=[];if(t.length<11){throw new Error("Wrong format")}n.push(V.indexOf(t[0]));n.push(W.indexOf(t[1]));n.push(b.indexOf(t[2]));n.push(b.indexOf(t[3]));if(t[4]!=="."){throw new Error("Wrong format")}n.push(K.indexOf(t[5]));n.push(X.indexOf(t[6]));if(t[7]!=="."){throw new Error("Wrong format")}n.push(j.indexOf(t[8]));n.push(z.indexOf(t[9]));n.push(r??0);n.push(Q.indexOf(t[10]));if(t[11]!=="-"){throw new Error("Wrong format")}var i=t.length>13?t.length-1:t.length;for(var a=12;a<i;a++){n.push(Z.indexOf(t[a]))}if(i<t.length){n.push(q.indexOf(t[i]))}var s=nt(n);var o=new Array(9).fill(0);o[0]=0;for(var v=0;v<s.length;v++){o[v+(s.length<8?1:0)]=s[v]}return o};var st=function(t){if(t.length<14){throw new Error("The buffer is too small")}var e=["MTX "];var r=t[1]===5?"-":" ";e.push(V[t[0]]??G);e.push(W[t[1]]??G);e.push(r);for(var n=2;n<t.length;n++){if(t[n]!==0){e.push(k[t[n]]??G)}}return{type:e.join("")}};var ot=function(t){if(t.length<3){throw new Error("Wrong format")}var e=[];e.push(V.indexOf(t[0]));e.push(W.indexOf(t[1]));for(var r=3;r<t.length;r++){e.push(k.indexOf(t[r]))}var n=nt(e);if(n.length===8){return n}if(n.length>8){throw new Error("Wrong format")}var i=new Array(8).fill(0);for(var a=0;a<n.length;a++){i[a]=n[a]}return i};var vt=function(t){if(t.length<14){throw new Error("The buffer is too small")}var e=[];e.push(V[t[0]]??G);for(var r=1;r<t.length;r++){if(t[r]!==0){e.push($[t[r]]??G)}}return{type:e.join("")}};var ft=function(t){if(t.length<1){throw new Error("Wrong format")}var e=[];e.push(V.indexOf(t[0]));for(var r=1;r<t.length;r++){e.push($.indexOf(t[r]))}var n=nt(e);var i=new Array(8).fill(0);for(var a=0;a<n.length&&a<8;a++){i[a]=n[a]}return i};var ut=function(t){if(t.length!==9){throw new Error("The buffer is too small")}var e;var r=[0,5,6,7,9,127,239];var n=r.indexOf(t[0])!==-1?2:0;var i=rt(t.slice(0,8));var a=i[n];var s=V[a];if(s==="1"||s==="3"){e={...it(i.slice(n)),descriptor:s==="1"?{meterType:"mtx1",...w(J,t[8])}:{meterType:"mtx3",...w(tt,t[8])}}}else{e=s==="M"?vt(i):st(i)}return e};var ht=function(t,e){var r=t.type,n=t.revision,i=t.descriptor;if(!r.startsWith("MTX ")){throw new Error("Wrong format")}var a;var s=r.substring(4);var o=r[4];if(o==="1"||o==="3"){a=at(s,e,n)}else{a=o==="M"?ft(s):ot(s)}if(i?.meterType){a[8]=i.meterType==="mtx1"?x(J,i):x(tt,i)}else{a[8]=0}return a};var Et=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=Object.assign({},u,e),n=r.separator,i=r.prefix;return t.map((function(t){return"".concat(i).concat(t.toString(16).padStart(2,"0"))})).join(n)};var _t=80;var At=81;var gt=82;var Tt=83;var ct=84;var dt=85;var lt=86;var pt=87;var Rt=88;var Ut=89;var yt=90;var Ot=91;var mt=255;var St=Object.freeze({__proto__:null,DATA_REQUEST:_t,DATA_RESPONSE:At,FRAGMENT_REQUEST:yt,FRAGMENT_RESPONSE:Ot,IDENT_REQUEST:gt,IDENT_RESPONSE:Tt,INVALID:mt,L2_CHECK_ADDRESS_REQUEST:lt,L2_CHECK_ADDRESS_RESPONSE:pt,L2_RM_ADDRESS_REQUEST:Rt,L2_RM_ADDRESS_RESPONSE:Ut,L2_SET_ADDRESS_REQUEST:ct,L2_SET_ADDRESS_RESPONSE:dt});var Pt=function(t){var e={};for(var r in t){var n=t[r];e[n]=r}return e};var Mt=Pt(St);var Dt=1;var Nt=2;var It=3;var Ct=16;var Lt=17;var Ft=18;var xt=19;var wt=20;var Yt=21;var Bt=32;var Ht=33;var Gt=34;var Vt=35;var Wt=36;var bt=37;var Kt=38;var Xt=39;var jt=40;var zt=41;var Qt=49;var Zt=50;var kt=51;var qt=52;var $t=53;var Jt=54;var te=55;var ee=56;var re=57;var ne=64;var ie=65;var ae=66;var se=67;var oe=68;var ve=69;var fe=70;var ue=71;var he=72;var Ee=73;var _e=74;var Ae=75;var ge=76;var Te=77;var ce=78;var de=79;var le=80;var pe=81;var Re=82;var Ue=83;var ye=84;var Oe=85;var me=86;var Se=87;var Pe=88;var Me=89;var De=96;var Ne=97;var Ie=98;var Ce=99;var Le=100;var Fe=101;var xe=102;var we=103;var Ye=104;var Be=105;var He=112;var Ge=113;var Ve=114;var We=115;var be=116;var Ke=117;var Xe=118;var je=119;var ze=120;var Qe=121;var Ze=122;var ke=123;var qe=124;var $e=125;var Je=144;var tr=145;var er=147;var rr=148;var nr=156;var ir=157;var ar=158;var sr=159;var or=160;var vr=161;var fr=162;var ur=176;var hr=177;var Er=178;var _r=179;var Ar=180;var gr=181;var Tr=182;var cr=183;var dr=208;var lr=224;var pr=225;var Rr=226;var Ur=227;var yr=228;var Or=229;var mr=230;var Sr=Object.freeze({__proto__:null,ACCESS_CLOSED:Ct,ACCPARAM_BAD:Ve,ACCPARAM_EXT_BAD:We,BAD_TEST_EEPROM:Ye,BAD_TEST_FRAM:Be,BAT_FAULT:Ue,BAT_OK:Re,BIPOLAR_POWER_FAULT:Ar,BIPOLAR_POWER_OK:gr,BLOCK_TARIFF_BAD:Ke,CALC_PERIOD_BAD:be,CALFLAG_RESET:we,CALFLAG_SET:xe,CALIBR_PARAM_BAD:Xe,CAL_FAULT:Oe,CAL_OK:ye,CASE_CLOSE:xt,CASE_MODULE_CLOSE:$e,CASE_MODULE_OPEN:qe,CASE_OPEN:Ft,CASE_TERMINAL_CLOSE:ke,CASE_TERMINAL_OPEN:Ze,CHANGE_ACCESS_KEY0:Bt,CHANGE_ACCESS_KEY1:Ht,CHANGE_ACCESS_KEY2:Gt,CHANGE_ACCESS_KEY3:Vt,CHANGE_COR_TIME:zt,CHANGE_PAR_LOCAL:Wt,CHANGE_PAR_REMOTE:bt,CHANGE_TARIFF_TBL:Zt,CLOCK_FAULT:Se,CLOCK_OK:me,CMD_CHANGE_TIME:Kt,CMD_RELAY_2_OFF:Ne,CMD_RELAY_2_ON:De,CMD_RELAY_OFF:jt,CMD_RELAY_ON:Xt,CROSSZERO_ENT1:Ie,CROSSZERO_ENT2:Ce,CROSSZERO_ENT3:Le,CROSSZERO_ENT4:Fe,CROSSZERO_EXP_ENT1:ar,CROSSZERO_EXP_ENT2:sr,CROSSZERO_EXP_ENT3:or,CROSSZERO_EXP_ENT4:vr,CURRENT_UNEQUIL_FAULT:Er,CURRENT_UNEQUIL_OK:_r,EM_MAGNETIC_OFF:hr,EM_MAGNETIC_ON:ur,ENERGY_REG_FAULT:Dt,ENERGY_REG_OVERFLOW:Qt,ERR_ACCESS:Lt,F_MAX_OK:he,F_MAX_OVER:Ee,F_MIN_OK:_e,F_MIN_OVER:Ae,I_MAX_OK:ge,I_MAX_OVER:Te,MAGNETIC_OFF:Yt,MAGNETIC_ON:wt,NVRAM_FAULT:dr,OP_PAR_FAULT:It,POWERSALDO_OK:le,POWERSALDO_OVER:pe,POWER_A_OFF:Pe,POWER_A_ON:Me,POWER_OVER_RELAY_OFF:ir,P_MAX_OK:ce,P_MAX_OVER:de,RELAY_HARD_BAD_OFF:Je,RELAY_HARD_BAD_ON:er,RELAY_HARD_OFF:rr,RELAY_HARD_ON:tr,RELAY_OFF:te,RELAY_ON:Jt,RESET_EM_FLAG:Tr,RESET_MAGN_FLAG:cr,RESTART:ee,SALDO_EN_BAD:ze,SALDO_PARAM_BAD:Ge,SET_DEMAND_EN_10MIN:Ur,SET_DEMAND_EN_15MIN:yr,SET_DEMAND_EN_1MIN:lr,SET_DEMAND_EN_30MIN:Or,SET_DEMAND_EN_3MIN:pr,SET_DEMAND_EN_5MIN:Rr,SET_DEMAND_EN_60MIN:mr,SET_NEW_SALDO:He,SET_SALDO_PARAM:nr,SET_TARIFF_TBL:kt,SUMMER_TIME:qt,TIME_CORRECT:Qe,TIME_CORRECT_NEW:fr,T_MAX_OK:oe,T_MAX_OVER:ve,T_MIN_OK:fe,T_MIN_OVER:ue,VENDOR_PAR_FAULT:Nt,V_MAX_OK:ne,V_MAX_OVER:ie,V_MIN_OK:ae,V_MIN_OVER:se,WD_RESTART:re,WINTER_SUMMER_BAD:je,WINTER_TIME:$t});var Pr=Pt(Sr);var Mr={type:_t,destination:65535,source:65534};var Dr=11;var Nr=74;var Ir=7;var Cr=2+Ir;var Lr=4;var Fr={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_COEFFICIENT_PHASE_A:524288,POWER_COEFFICIENT_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var xr={...Fr,AUTO_SCREEN_SCROLLING:2147483648};var wr={...Fr,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var Yr={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_1:8,RELAY_ON_TARIFF_2:16,RELAY_ON_TARIFF_3:32,RELAY_ON_TARIFF_4:64,RELAY_ON_V_GOOD:128};var Br={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_1:4,RELAY_OFF_TARIFF_2:8,RELAY_OFF_TARIFF_3:16,RELAY_OFF_TARIFF_4:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var Hr={RELAY_OFF_LIM_TARIFF_1:2,RELAY_OFF_LIM_TARIFF_2:4,RELAY_OFF_LIM_TARIFF_3:8,RELAY_OFF_LIM_TARIFF_4:16,RELAY_OFF_PF_MIN:32};var Gr={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var Vr={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var Wr={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var br={CASE_OPEN:2**0,MAGNETIC_ON:2**1,PARAMETERS_UPDATE_REMOTE:2**2,PARAMETERS_UPDATE_LOCAL:2**3,RESTART:2**4,ERROR_ACCESS:2**5,TIME_SET:2**6,TIME_CORRECT:2**7,DEVICE_FAILURE:2**8,CASE_TERMINAL_OPEN:2**9,CASE_MODULE_OPEN:2**10,TARIFF_TABLE_SET:2**11,TARIFF_TABLE_GET:2**12,PROTECTION_RESET_EM:2**13,PROTECTION_RESET_MAGNETIC:2**14};var Kr={RELAY_STATE:2**0,RELAY_UBAD:2**1,RELAY_UNEQ_CURRENT:2**4,RELAY_OFF_CENTER:2**5,RELAY_IMAX:2**6,RELAY_PMAX:2**7};var Xr={RELAY_COSFI:2**0,RELAY_SALDO_OFF_FLAG:2**1,RELAY_UNEQUIL_CURRENT_OFF:2**2,RELAY_BIPOLAR_POWER_OFF:2**3,RELAY_SALDO_OFF_ON_MAX_POWER:2**4,RELAY_HARD_ST1:2**5};var jr={MAXVA:2**0,MINVA:2**1,MAXT:2**2,MINT:2**3,MAXF:2**4,MINF:2**5,MAXIA:2**6,MAXP:2**7};var zr={MAX_POWER_SALDO:2**0,BATTERY_VBAT_BAD:2**1,CLOCK_UNSET:2**3,MIN_COS_FI:2**5};var Qr={UNEQUIL_CURRENT:2**0,BIPOLAR_POWER:2**1,POWER_A_NEGATIVE:2**6,POWER_B_NEGATIVE:2**7};var Zr={RELAY_OFF_LIMIT_P_MINUS_T1:8,RELAY_OFF_LIMIT_P_MINUS_T2:16,RELAY_OFF_LIMIT_P_MINUS_T3:32,RELAY_OFF_LIMIT_P_MINUS_T4:64};function kr(t,e,r){var n=r>>Lr;var i=new Array(Lr).fill(0);i.forEach((function(e,r){var a=!!Y(n,1,r+1);if(a){i[r]=t.getUint32()}else{i[r]=null}}));return i}function qr(t,e,r){var n=1+Lr;var i=e;r.forEach((function(t,e){i=B(i,1,e+n,Number(!!t))}));t.setUint8(i)}function $r(t){if(t===65535){return{tariff:undefined,energy:undefined}}return{tariff:t>>14&3,energy:t&16383}}function Jr(t,e){var r=e.tariff,n=e.energy;if(r!==undefined&&n!==undefined){t.setUint16(r<<14|n&16383)}else{t.setUint16(65535)}}function tn(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;F.call(this,t,e)}tn.prototype=Object.create(F.prototype);tn.prototype.constructor=tn;tn.getDayProfileFromByte=function(t){return{tariff:Y(t,2,1),isFirstHalfHour:!Y(t,1,3),hour:Y(t,5,4)}};tn.getByteFromDayProfile=function(t){var e=0;e=B(e,2,1,t.tariff);e=B(e,1,3,+!t.isFirstHalfHour);e=B(e,5,4,t.hour);return e};tn.getDefaultSeasonProfile=function(){return{month:1,date:1,dayIndexes:[0,0,0,0,0,0,0]}};tn.getDefaultOperatorParameters=function(){return{vpThreshold:265e3,vThreshold:156e3,ipThreshold:12e4,pmaxThreshold0:31800,pmaxThreshold1:31800,pmaxThreshold2:31800,pmaxThreshold3:31800,speedOptoPort:0,tint:30,calcPeriodDate:1,timeoutDisplay:127,timeoutScreen:7,displaySet:w(xr,2147496324),relaySet4:w(Gr,0),relaySet3:w(Hr,0),relaySet2:w(Br,3),relaySet1:w(Yr,3),displayType:0,ten:0,timeoutRefresh:240,deltaCorMin:15,timeoutMagnetOff:5,timeoutMagnetOn:5,define1:w(Wr,0),timeoutRelayOn:1,timeoutRelayKey:0,timeoutRelayAuto:5,timeoutBadVAVB:5,freqMax:55,freqMin:45,phMin:0,year:0,month:0,date:0,energyDecimalPoint:2,typeMeter:0,timeoutIMax:5,timeoutPMax:5,timeoutCos:5,pMaxDef:1,displaySetExt:w(wr,137904127),timeoutUneqCurrent:5,timeoutBipolarPower:5,relaySet5:w(Vr,0),timeCorrectPeriod:24,timeCorrectPassHalfhour:false}};tn.getDefaultOperatorParametersExtended3=function(){return{pmaxMinusThreshold0:0,pmaxMinusThreshold1:0,pmaxMinusThreshold2:0,pmaxMinusThreshold3:0,relaySet:w(Zr,0)}};tn.prototype.getFrameHeader=function(){var t=this.getUint8();var e=Mt[t];var r=this.getUint16();var n=this.getUint16();return{type:t,typeName:e,destination:r,source:n}};tn.prototype.setFrameHeader=function(t){var e=t.type,r=e===void 0?Mr.type:e,n=t.destination,i=n===void 0?Mr.destination:n,a=t.source,s=a===void 0?Mr.source:a;this.setUint8(r);this.setUint16(i);this.setUint16(s)};tn.prototype.getDeviceId=function(){var t=Et(this.getBytes(3),{separator:""});var e=this.getUint8();var r=this.getUint8();var n=Et(this.getBytes(3),{separator:""});return{manufacturer:t,type:e,year:r,serial:n}};tn.prototype.setDeviceId=function(t){var e=t.manufacturer,r=t.type,n=t.year,i=t.serial;this.setBytes(H(e));this.setUint8(r);this.setUint8(n);this.setBytes(H(i))};tn.prototype.getDateTime=function(){return{isSummerTime:!!this.getUint8(),seconds:this.getUint8(),minutes:this.getUint8(),hours:this.getUint8(),day:this.getUint8(),date:this.getUint8(),month:this.getUint8(),year:this.getUint8()}};tn.prototype.setDateTime=function(t){this.setUint8(t.isSummerTime?1:0);this.setUint8(t.seconds);this.setUint8(t.minutes);this.setUint8(t.hours);this.setUint8(t.day||0);this.setUint8(t.date);this.setUint8(t.month);this.setUint8(t.year)};tn.prototype.getTariffPlan=function(){return{id:this.getUint32(),tariffSet:this.getUint8(),activateYear:this.getUint8(),activateMonth:this.getUint8(),activateDay:this.getUint8(),specialProfilesArraySize:this.getUint8(),seasonProfilesArraySize:this.getUint8(),dayProfilesArraySize:this.getUint8()}};tn.prototype.setTariffPlan=function(t){this.setUint32(t.id);this.setUint8(t.tariffSet);this.setUint8(t.activateYear);this.setUint8(t.activateMonth);this.setUint8(t.activateDay);this.setUint8(t.specialProfilesArraySize);this.setUint8(t.seasonProfilesArraySize);this.setUint8(t.dayProfilesArraySize)};tn.prototype.getTimeCorrectionParameters=function(){return{monthTransitionSummer:this.getUint8(),dateTransitionSummer:this.getUint8(),hoursTransitionSummer:this.getUint8(),hoursCorrectSummer:this.getUint8(),monthTransitionWinter:this.getUint8(),dateTransitionWinter:this.getUint8(),hoursTransitionWinter:this.getUint8(),hoursCorrectWinter:this.getUint8(),isCorrectionNeeded:this.getUint8()===1}};tn.prototype.setTimeCorrectionParameters=function(t){this.setUint8(t.monthTransitionSummer);this.setUint8(t.dateTransitionSummer);this.setUint8(t.hoursTransitionSummer);this.setUint8(t.hoursCorrectSummer);this.setUint8(t.monthTransitionWinter);this.setUint8(t.dateTransitionWinter);this.setUint8(t.hoursTransitionWinter);this.setUint8(t.hoursCorrectWinter);this.setUint8(+t.isCorrectionNeeded)};tn.prototype.getDayProfile=function(){return tn.getDayProfileFromByte(this.getUint8())};tn.prototype.setDayProfile=function(t){this.setUint8(tn.getByteFromDayProfile(t))};tn.prototype.getSeasonProfile=function(){var t=this;return{month:this.getUint8(),date:this.getUint8(),dayIndexes:new Array(Ir).fill(0).map((function(){return t.getUint8()}))}};tn.prototype.setSeasonProfile=function(t){var e=this;this.setUint8(t.month);this.setUint8(t.date);t.dayIndexes.forEach((function(t){return e.setUint8(t)}))};tn.prototype.getSpecialDay=function(){return{month:this.getUint8(),date:this.getUint8(),dayIndex:this.getUint8(),isPeriodic:this.getUint8()===0}};tn.prototype.setSpecialDay=function(t){this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.dayIndex);this.setUint8(+!t.isPeriodic)};tn.prototype.getDeviceType=function(){return ut(this.getBytes(9))};tn.prototype.setDeviceType=function(t){this.setBytes(ht(t))};tn.prototype.getOperatorParameters=function(){var t={vpThreshold:this.getUint32(),vThreshold:this.getUint32(),ipThreshold:this.getUint32(),pmaxThreshold0:this.getUint32(),pmaxThreshold1:this.getUint32(),pmaxThreshold2:this.getUint32(),pmaxThreshold3:this.getUint32(),speedOptoPort:this.getUint8(),tint:this.getUint8(),calcPeriodDate:this.getUint8(),timeoutDisplay:this.getUint8(),timeoutScreen:this.getUint8(),displaySet:w(xr,this.getUint32()),relaySet4:w(Gr,this.getUint8()),relaySet3:w(Hr,this.getUint8()),relaySet2:w(Br,this.getUint8()),relaySet1:w(Yr,this.getUint8()),displayType:this.getUint8(),ten:this.getUint8(),timeoutRefresh:this.getUint16(),deltaCorMin:this.getUint8(),timeoutMagnetOff:this.getUint8(),timeoutMagnetOn:this.getUint8(),define1:w(Wr,this.getUint8()),timeoutRelayOn:this.getUint8(),timeoutRelayKey:this.getUint8(),timeoutRelayAuto:this.getUint8(),timeoutBadVAVB:this.getUint8(),freqMax:this.getUint8(),freqMin:this.getUint8(),phMin:this.getUint16(),year:this.getUint8(),month:this.getUint8(),date:this.getUint8(),energyDecimalPoint:this.getUint8(),typeMeter:this.getUint8(),timeoutIMax:this.getUint8(),timeoutPMax:this.getUint8(),timeoutCos:this.getUint8(),pMaxDef:this.getUint8(),displaySetExt:w(wr,this.getUint32()),timeoutUneqCurrent:this.getUint8(),timeoutBipolarPower:this.getUint8(),relaySet5:w(Vr,this.getUint8()),timeCorrectPeriod:0,timeCorrectPassHalfhour:false};var e=this.getUint8();t.timeCorrectPeriod=e&127;t.timeCorrectPassHalfhour=!!(e&128);return t};tn.prototype.setOperatorParameters=function(t){var e=t.timeCorrectPeriod|(t.timeCorrectPassHalfhour?128:0);this.setUint32(t.vpThreshold);this.setUint32(t.vThreshold);this.setUint32(t.ipThreshold);this.setUint32(t.pmaxThreshold0);this.setUint32(t.pmaxThreshold1);this.setUint32(t.pmaxThreshold2);this.setUint32(t.pmaxThreshold3);this.setUint8(t.speedOptoPort);this.setUint8(t.tint);this.setUint8(t.calcPeriodDate);this.setUint8(t.timeoutDisplay);this.setUint8(t.timeoutScreen);this.setUint32(x(xr,t.displaySet));this.setUint8(x(Gr,t.relaySet4));this.setUint8(x(Hr,t.relaySet3));this.setUint8(x(Br,t.relaySet2));this.setUint8(x(Yr,t.relaySet1));this.setUint8(t.displayType);this.setUint8(t.ten);this.setUint16(t.timeoutRefresh);this.setUint8(t.deltaCorMin);this.setUint8(t.timeoutMagnetOff);this.setUint8(t.timeoutMagnetOn);this.setUint8(x(Wr,t.define1));this.setUint8(t.timeoutRelayOn);this.setUint8(t.timeoutRelayKey);this.setUint8(t.timeoutRelayAuto);this.setUint8(t.timeoutBadVAVB);this.setUint8(t.freqMax);this.setUint8(t.freqMin);this.setUint16(t.phMin);this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.energyDecimalPoint);this.setUint8(t.typeMeter);this.setUint8(t.timeoutIMax);this.setUint8(t.timeoutPMax);this.setUint8(t.timeoutCos);this.setUint8(t.pMaxDef);this.setUint32(x(wr,t.displaySetExt));this.setUint8(t.timeoutUneqCurrent);this.setUint8(t.timeoutBipolarPower);this.setUint8(x(Vr,t.relaySet5));this.setUint8(e)};tn.prototype.getPackedEnergyWithType=function(){var t=this.getUint8();var e=Y(t,Lr,1);var r=kr(this,e,t);return{energyType:e,energies:r}};tn.prototype.setPackedEnergyWithType=function(t){var e=this;var r=t.energyType,n=t.energies;if(r){qr(this,r,n)}n.forEach((function(t){if(t!==null){e.setUint32(t)}}))};tn.prototype.getEnergies=function(){var t=this;return new Array(Lr).fill(0).map((function(){return t.getInt32()}))};tn.prototype.setEnergies=function(t){var e=this;t.forEach((function(t){return e.setUint32(t)}))};tn.prototype.getDate=function(){return{year:this.getUint8(),month:this.getUint8(),date:this.getUint8()}};tn.prototype.setDate=function(t){this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date)};tn.prototype.getSaldoParameters=function(){var t=this;return{coefficients:new Array(4).fill(0).map((function(){return t.getUint32()})),decimalPointTariff:this.getUint8(),indicationThreshold:this.getInt32(),relayThreshold:this.getInt32(),mode:this.getUint8(),saldoOffTimeBegin:this.getUint8(),saldoOffTimeEnd:this.getUint8(),decimalPointIndication:this.getUint8(),powerThreshold:this.getUint32(),creditThreshold:this.getInt32()}};tn.prototype.setSaldoParameters=function(t){var e=this;t.coefficients.forEach((function(t){return e.setUint32(t)}));this.setUint8(t.decimalPointTariff);this.setInt32(t.indicationThreshold);this.setInt32(t.relayThreshold);this.setUint8(t.mode);this.setUint8(t.saldoOffTimeBegin);this.setUint8(t.saldoOffTimeEnd);this.setUint8(t.decimalPointIndication);this.setUint32(t.powerThreshold);this.setInt32(t.creditThreshold)};tn.prototype.getEnergyPeriods=function(t){var e=this;var r=new Array(t).fill(0).map((function(){return e.getUint16()}));return r.map((function(t){return $r(t)}))};tn.prototype.setEnergyPeriods=function(t){var e=this;t.forEach((function(t){return Jr(e,t)}))};tn.prototype.getEventStatus=function(){var t=this.getUint16();return w(br,t)};tn.prototype.setEventStatus=function(t){this.setUint16(x(br,t))};tn.prototype.getExtendedCurrentValues2=function(){var t=this.getUint16();var e=w(Kr,this.getUint8());var r=w(Xr,this.getUint8());var n=w(jr,this.getUint8());var i=w(zr,this.getUint8());var a=w(Qr,this.getUint8());return{uBattery:t,relayStatus:e,relayStatus2:r,status1:n,status2:i,status3:a}};tn.prototype.setExtendedCurrentValues2=function(t){var e=t.uBattery,r=t.relayStatus,n=t.relayStatus2,i=t.status1,a=t.status2,s=t.status3;this.setUint16(e);this.setUint8(x(Kr,r));this.setUint8(x(Xr,n));this.setUint8(x(jr,i));this.setUint8(x(zr,a));this.setUint8(x(Qr,s))};tn.prototype.getEvent=function(){var t={hours:this.getUint8(),minutes:this.getUint8(),seconds:this.getUint8(),event:this.getUint8()};var e=t.event;var r=this.bytesLeft;t.eventName=Pr[e];switch(e){case ir:if(r<4){return t}t.power=[this.getUint8(),this.getUint8(),this.getUint8(),this.getUint8()];break;case Kt:case Qe:if(r<8){return t}t.newDate=this.getDateTime();break}return t};tn.prototype.setEvent=function(t){this.setUint8(t.hours);this.setUint8(t.minutes);this.setUint8(t.seconds);this.setUint8(t.event);switch(t.event){case ir:for(var e of t.power){this.setUint8(e)}break;case Kt:case Qe:this.setDateTime(t.newDate);break}};tn.prototype.getDemand=function(){var t=this.getUint8();var e=this.getUint8();return{date:{year:t>>1,month:t<<3&15|e>>5,date:e&31},energyType:this.getUint8(),firstIndex:this.getUint16(),count:this.getUint8(),period:this.getUint8()}};tn.prototype.setDemand=function(t){var e=t.date.year<<1|t.date.month>>3&1;var r=t.date.month<<5&224|t.date.date&31;this.setUint8(e);this.setUint8(r);this.setUint8(t.energyType);this.setUint16(t.firstIndex);this.setUint8(t.count);this.setUint8(t.period)};tn.prototype.getDayMaxDemandResponse=function(){var t=this;var e=this.getDate();var r=new Array(Lr).fill(0).map((function(){return{hours:t.getUint8(),minutes:t.getUint8(),power:t.getUint32()}}));return{date:e,power:r}};tn.prototype.setDayMaxDemandResponse=function(t){var e=this;this.setDate(t.date);t.power.forEach((function(t){e.setUint8(t.hours);e.setUint8(t.minutes);e.setUint32(t.power)}))};tn.prototype.getOperatorParametersExtended3=function(){return{pmaxMinusThreshold0:this.getUint32(),pmaxMinusThreshold1:this.getUint32(),pmaxMinusThreshold2:this.getUint32(),pmaxMinusThreshold3:this.getUint32(),relaySet:w(Zr,this.getUint8())}};tn.prototype.setOperatorParametersExtended3=function(t){var e=t.pmaxMinusThreshold0,r=t.pmaxMinusThreshold1,n=t.pmaxMinusThreshold2,i=t.pmaxMinusThreshold3,a=t.relaySet;this.setUint32(e);this.setUint32(r);this.setUint32(n);this.setUint32(i);this.setUint8(x(Zr,a))};tn.prototype.getMonthMaxPowerByTariffs=function(){var t=this;return new Array(Lr).fill(0).map((function(){return{date:t.getUint8(),hours:t.getUint8(),minutes:t.getUint8(),power:t.getUint32()}}))};tn.prototype.setMonthMaxPowerByTariffs=function(t){var e=this;t.forEach((function(t){e.setUint8(t.date);e.setUint8(t.hours);e.setUint8(t.minutes);e.setUint32(t.power)}))};var en=function(t){return btoa(t.map((function(t){return String.fromCharCode(t)})).join(""))};var rn=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[t,e.length].concat(v(e))};var nn=0;var an=3;var sn=1;var on=3;var vn=4;var fn=5;var un=7;var hn=8;var En=9;var _n=13;var An=15;var gn=16;var Tn=17;var cn=18;var dn=19;var ln=20;var pn=21;var Rn=22;var Un=23;var yn=24;var On=25;var mn=28;var Sn=30;var Pn=31;var Mn=40;var Dn=41;var Nn=42;var In=44;var Cn=45;var Ln=46;var Fn=47;var xn=49;var wn=50;var Yn=51;var Bn=52;var Hn=53;var Gn=54;var Vn=57;var Wn=58;var bn=59;var Kn=60;var Xn=61;var jn=62;var zn=65;var Qn=70;var Zn=74;var kn=75;var qn=79;var $n=80;var Jn=82;var ti=83;var ei=88;var ri=89;var ni=91;var ii=92;var ai=93;var si=94;var oi=100;var vi=109;var fi=111;var ui=112;var hi=113;var Ei=114;var _i=118;var Ai=122;var gi=Object.freeze({__proto__:null,activateRatePlan:dn,getBuildVersion:ui,getCorrectTime:jn,getCriticalEvent:zn,getCurrentStatusMeter:Vn,getCurrentValues:_n,getDateTime:un,getDayDemand:Rn,getDayDemandExport:qn,getDayMaxDemand:xn,getDayMaxDemandExport:ei,getDayMaxDemandPrevious:Zn,getDayProfile:bn,getDemand:_i,getDeviceId:fn,getDeviceType:vn,getDisplayParam:si,getEnergy:An,getEnergyDayPrevious:on,getEnergyExport:ni,getEnergyExportDayPrevious:$n,getEventStatus:sn,getEvents:Yn,getEventsCounters:Bn,getExtendedCurrentValues:Wn,getExtendedCurrentValues2:Cn,getHalfHourDemand:pn,getHalfHourDemandExport:ti,getHalfHourDemandPrevious:kn,getHalfhoursEnergies:fi,getMagneticFieldThreshold:vi,getMeterInfo:Ai,getMonthDemand:Un,getMonthDemandExport:Jn,getMonthMaxDemand:wn,getMonthMaxDemandExport:ri,getOperatorParameters:Sn,getOperatorParametersExtended3:hi,getRatePlanInfo:In,getSaldo:Dn,getSaldoParameters:Ln,getSeasonProfile:Kn,getSpecialDay:Xn,getVersion:Mn,prepareRatePlan:ln,resetPowerMaxDay:Hn,resetPowerMaxMonth:Gn,runTariffPlan:Qn,setAccessKey:En,setCorrectDateTime:ii,setCorrectTime:mn,setDateTime:hn,setDayProfile:gn,setDisplayParam:ai,setOperatorParameters:Pn,setOperatorParametersExtended3:Ei,setSaldo:Nn,setSaldoParameters:Fn,setSeasonProfile:Tn,setSpecialDay:cn,setSpecialOperation:oi,turnRelayOff:On,turnRelayOn:yn});Pt(gi);var Ti=dn;var ci=1+Dr;var di=function(t){var e=new tn(ci);e.setUint8(t.tariffTable);e.setTariffPlan(t.tariffPlan);return rn(Ti,e.data)};var li=ui;var pi=function(){return rn(li)};var Ri=jn;var Ui=function(){return rn(Ri)};var yi=0;var Oi=1;var mi=2;var Si=3;var Pi=4;var Mi=5;var Di=6;var Ni=7;var Ii=8;var Ci=9;var Li=10;var Fi=11;var xi=12;var wi=13;var Yi=14;var Bi=Object.freeze({__proto__:null,CASE_MODULE_OPEN:Li,CASE_OPEN:yi,CASE_TERMINAL_OPEN:Ci,DEVICE_FAILURE:Ii,ERROR_ACCESS:Mi,MAGNETIC_ON:Oi,PARAMETERS_UPDATE_LOCAL:Si,PARAMETERS_UPDATE_REMOTE:mi,PROTECTION_RESET_EM:wi,PROTECTION_RESET_MAGNETIC:Yi,RESTART:Pi,TARIFF_TABLE_GET:xi,TARIFF_TABLE_SET:Fi,TIME_CORRECT:Ni,TIME_SET:Di});Pt(Bi);var Hi=zn;var Gi=function(t){return rn(Hi,[t.event,t.index])};var Vi=Vn;var Wi=function(){return rn(Vi)};var bi=_n;var Ki=function(){return rn(bi)};var Xi=un;var ji=function(){return rn(Xi)};var zi=3;var Qi=4;var Zi=Rn;var ki=function(t){var e=new tn(t?.energyType?Qi:zi);e.setDate(t?.date);if(t?.energyType){e.setUint8(t.energyType)}return rn(Zi,e.data)};var qi=3;var $i=4;var Ji=qn;var ta=function(t){var e=new tn(t?.energyType?$i:qi);e.setDate(t?.date);if(t?.energyType){e.setUint8(t.energyType)}return rn(Ji,e.data)};var ea=xn;var ra=3;var na=function(t){var e=new tn(ra);e.setDate(t.date);return rn(ea,e.data)};var ia=ei;var aa=3;var sa=function(t){var e=new tn(aa);e.setDate(t.date);return rn(ia,e.data)};var oa=Zn;var va=function(){return rn(oa)};var fa=bn;var ua=3;var ha=function(t){var e=new tn(ua);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return rn(fa,e.data)};var Ea=_i;var _a=7;var Aa=function(t){var e=new tn(_a);e.setDemand(t);return rn(Ea,e.data)};var ga=fn;var Ta=function(){return rn(ga)};var ca=vn;var da=function(){return rn(ca)};var la=0;var pa=128;var Ra=129;var Ua=130;var ya=131;var Oa=132;var ma=133;var Sa=134;var Pa=135;var Ma=136;var Da=137;var Na=144;var Ia=145;var Ca=146;var La=147;var Fa=149;var xa=151;var wa=152;var Ya=153;var Ba=154;var Ha=155;var Ga=156;var Va=159;var Wa=160;var ba=240;var Ka=Object.freeze({__proto__:null,ACCESS_DENIED:La,BAD_ARRAY_INDEX:Sa,BAD_BLOCK_NUMBER:Ga,BAD_DATA_LENGTH:ma,BAD_MESSAGE:Oa,BAD_RATE_PLAN_ID:Ma,BAD_RATE_PLAN_SIZE:Da,BAD_RESPONSE_LENGTH:Na,BAD_SALDO_WRITE:Fa,BLOCKED_METER:xa,CALIBRATION_DISABLED:Ca,DECRYPTION_FAILURE:Ua,INTERNAL:ba,INVALID_CORRECTION_INTERVAL:Ba,NOT_ALIGNED_DATA:Ra,NOT_PREPARED_RATE_PLAN:Pa,NO_DATA_FOR_DATE:Ia,OK:la,OUT_OFF_RANGE:Va,SET_METER_TYPE_FAILURE:Wa,TIME_CORRECTION_FAILURE:Ya,TIME_CORRECTION_OUT_HALF_HOUR_DISABLED:Ha,UNENCRYPTED_COMMAND_DISABLED:wa,UNKNOWN_COMMAND:pa,UNKNOWN_PROTOCOL:ya});Pt(Ka);var Xa=1;var ja=2;var za=3;var Qa=4;var Za=5;var ka=6;var qa=7;var $a=8;var Ja=9;var ts=10;var es=11;var rs=12;var ns=13;var is=14;var as=15;var ss=16;var os=17;var vs=18;var fs=19;var us=20;var hs=21;var Es=22;var _s=23;var As=24;var gs=25;var Ts=26;var cs=28;var ds=30;var ls=31;var ps=Object.freeze({__proto__:null,ACTIVE_ENERGY_T1:Qa,ACTIVE_ENERGY_T2:Za,ACTIVE_ENERGY_T3:ka,ACTIVE_ENERGY_T4:qa,ACTIVE_POWER_IN_NEUTRAL:Ja,ACTIVE_POWER_PER_PHASE:$a,BATTERY_VOLTAGE:Es,CURRENT_BALANCE:ds,CURRENT_IN_NEUTRAL:es,CURRENT_IN_PHASE:ts,DATE_MONTH_YEAR:is,EXPORTED_ACTIVE_ENERGY_T1:ss,EXPORTED_ACTIVE_ENERGY_T2:os,EXPORTED_ACTIVE_ENERGY_T3:vs,EXPORTED_ACTIVE_ENERGY_T4:fs,HOUR_MINUTE_SECOND:ns,MAGNET_INDUCTION:cs,OPTOPORT_SPEED:ls,POWER_COEFFICIENT_PHASE_A:us,POWER_COEFFICIENT_PHASE_B:hs,POWER_THRESHOLD_T1:_s,POWER_THRESHOLD_T2:As,POWER_THRESHOLD_T3:gs,POWER_THRESHOLD_T4:Ts,SET_ALL_SEGMENT_DISPLAY:Xa,SOFTWARE_VERSION:ja,TOTAL_ACTIVE_ENERGY:za,TOTAL_EXPORTED_ACTIVE_ENERGY:as,VOLTAGE:rs});Pt(ps);var Rs=120;var Us=121;var ys=254;var Os=Object.freeze({__proto__:null,activateRatePlan:dn,errorResponse:ys,getBuildVersion:ui,getCorrectTime:jn,getCriticalEvent:zn,getCurrentStatusMeter:Vn,getCurrentValues:_n,getDateTime:un,getDayDemand:Rn,getDayDemandExport:qn,getDayEnergies:Rs,getDayMaxDemand:xn,getDayMaxDemandExport:ei,getDayMaxDemandPrevious:Zn,getDayMaxPower:Us,getDayProfile:bn,getDemand:_i,getDeviceId:fn,getDeviceType:vn,getDisplayParam:si,getEnergy:An,getEnergyDayPrevious:on,getEnergyExport:ni,getEnergyExportDayPrevious:$n,getEventStatus:sn,getEvents:Yn,getEventsCounters:Bn,getExtendedCurrentValues:Wn,getExtendedCurrentValues2:Cn,getHalfHourDemand:pn,getHalfHourDemandExport:ti,getHalfHourDemandPrevious:kn,getHalfhoursEnergies:fi,getMagneticFieldThreshold:vi,getMeterInfo:Ai,getMonthDemand:Un,getMonthDemandExport:Jn,getMonthMaxDemand:wn,getMonthMaxDemandExport:ri,getOperatorParameters:Sn,getOperatorParametersExtended3:hi,getRatePlanInfo:In,getSaldo:Dn,getSaldoParameters:Ln,getSeasonProfile:Kn,getSpecialDay:Xn,getVersion:Mn,prepareRatePlan:ln,resetPowerMaxDay:Hn,resetPowerMaxMonth:Gn,runTariffPlan:Qn,setAccessKey:En,setCorrectDateTime:ii,setCorrectTime:mn,setDateTime:hn,setDayProfile:gn,setDisplayParam:ai,setOperatorParameters:Pn,setOperatorParametersExtended3:Ei,setSaldo:Nn,setSaldoParameters:Fn,setSeasonProfile:Tn,setSpecialDay:cn,setSpecialOperation:oi,turnRelayOff:On,turnRelayOn:yn});Pt(Os);var ms=si;var Ss=1;var Ps=function(t){var e=new tn(Ss);e.setUint8(t.displayMode);return rn(ms,e.data)};var Ms=0;var Ds=1;var Ns=An;var Is=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=new tn(t?.energyType?Ds:Ms);if(t?.energyType){e.setUint8(t.energyType)}return rn(Ns,e.data)};var Cs=on;var Ls=function(t){if(t.energyType){return rn(Cs,[t.energyType])}return rn(Cs)};var Fs=0;var xs=1;var ws=ni;var Ys=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=new tn(t?.energyType?xs:Fs);if(t?.energyType){e.setUint8(t.energyType)}return rn(ws,e.data)};var Bs=$n;var Hs=function(t){if(t.energyType){return rn(Bs,[t.energyType])}return rn(Bs)};var Gs=Yn;var Vs=4;var Ws=function(t){var e=new tn(Vs);e.setDate(t.date);e.setUint8(t.offset);return rn(Gs,e.data)};var bs=Bn;var Ks=function(){return rn(bs)};var Xs=sn;var js=function(){return rn(Xs)};var zs=Wn;var Qs=function(){return rn(zs)};var Zs=Cn;var ks=function(){return rn(Zs)};var qs=pn;var $s=3;var Js=function(t){var e=new tn($s);e.setDate(t.date);return rn(qs,e.data)};var to=ti;var eo=3;var ro=function(t){var e=new tn(eo);e.setDate(t.date);return rn(to,e.data)};var no=kn;var io=function(){return rn(no)};var ao=4;var so=["A+","A+R+","A+R-","A-","A-R+","A-R-"];var oo=4294967295;var vo={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var fo=function(t){var e={};Object.keys(t).forEach((function(r){e[r]=!!t[r]}));return x(vo,e)};var uo=function(t){return t<ao?1<<t:0};var ho=function(t){return t<ao?1<<t<<4:0};var Eo=function(t,e){var r=0;if(t<ao){if(e["A+"]||e["A+R+"]||e["A+R-"]){r|=uo(t)}if(e["A-"]||e["A-R+"]||e["A-R-"]){r|=ho(t)}}return r};function _o(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;F.call(this,t,e)}_o.prototype=Object.create(F.prototype);_o.prototype.constructor=_o;_o.prototype.getDate=function(){var t=this.getUint8();var e=this.getUint8();return{year:t>>1,month:t<<3&15|e>>5,date:e&31}};_o.prototype.setDate=function(t){var e=t.year,r=t.month,n=t.date;var i=e<<1|r>>3&1;var a=r<<5&224|n&31;this.setUint8(i);this.setUint8(a)};_o.prototype.getEnergiesFlags=function(){var t=this.getUint8();return w(vo,t)};_o.prototype.setEnergiesFlags=function(t){this.setUint8(fo(t))};_o.prototype.getHalfhoursEnergy1=function(t){var e=[];for(var r=0;r<t;r++){var n=this.getUint16();var i=n>>14&3;var a=n&16383;e.push(n===oo?undefined:{tariff:i,energy:a})}return e};_o.prototype.setHalfhoursEnergy1=function(t){if(t){for(var e=0;e<t.length;e++){var r=t[e],n=r.tariff,i=r.energy;var a=n<<14|i;this.setUint16(a===undefined?oo:a)}}};_o.prototype.getHalfhoursEnergy3=function(t){var e=[];for(var r=0;r<t;r++){var n=this.getUint16();e.push(n===oo?undefined:n)}return e};_o.prototype.setHalfhoursEnergy3=function(t){if(t){for(var e=0;e<t.length;e++){var r=t[e];this.setUint16(r===undefined?oo:r)}}};_o.prototype.getHalfhoursEnergies1=function(t,e){var r=this;var n={};so.forEach((function(i){if(t[i]){n[i]=r.getHalfhoursEnergy1(e)}}));return n};_o.prototype.getHalfhoursEnergies3=function(t,e){var r=this;var n={};so.forEach((function(i){if(t[i]){n[i]=r.getHalfhoursEnergy3(e)}}));return n};_o.prototype.setHalfhoursEnergies1=function(t){var e=this;so.forEach((function(r){e.setHalfhoursEnergy1(t[r])}))};_o.prototype.setHalfhoursEnergies3=function(t){var e=this;so.forEach((function(r){e.setHalfhoursEnergy3(t[r])}))};_o.prototype.getAPlusTariffEnergies=function(t){var e={};if(t&vo["A+"]){e["A+"]=this.getUint32()}if(t&vo["A+R+"]){e["A+R+"]=this.getUint32()}if(t&vo["A+R-"]){e["A+R-"]=this.getUint32()}return e};_o.prototype.setAPlusTariffEnergies=function(t){if(t){if(t["A+"]){this.setUint32(t["A+"])}if(t["A+R+"]){this.setUint32(t["A+R+"])}if(t["A+R-"]){this.setUint32(t["A+R-"])}}};_o.prototype.getAMinusTariffEnergies=function(t){var e={};if(t&vo["A-"]){e["A-"]=this.getUint32()}if(t&vo["A-R+"]){e["A-R+"]=this.getUint32()}if(t&vo["A-R-"]){e["A-R-"]=this.getUint32()}return e};_o.prototype.setAMinusTariffEnergies=function(t){if(t){if(t["A-"]){this.setUint32(t["A-"])}if(t["A-R+"]){this.setUint32(t["A-R+"])}if(t["A-R-"]){this.setUint32(t["A-R-"])}}};_o.prototype.getTariffsEnergies=function(){var t=this.getUint8();var e=this.getUint8();var r=new Array(ao).fill(null);for(var n=0;n<ao;n++){if(e&uo(n)){r[n]=this.getAPlusTariffEnergies(t)}}for(var i=0;i<ao;i++){if(e&ho(i)){r[i]={...r[i],...this.getAMinusTariffEnergies(t)}}}return r};_o.prototype.setTariffsEnergies=function(t){var e=this;var r=0;var n=0;t.forEach((function(t,e){if(t){r|=fo(t);n|=Eo(e,t)}}));this.setUint8(r);this.setUint8(n);t.forEach((function(t){return e.setAPlusTariffEnergies(t)}));t.forEach((function(t){return e.setAMinusTariffEnergies(t)}))};_o.prototype.getPowerMax=function(){return{hours:this.getUint8(),minutes:this.getUint8(),power:this.getUint32()}};_o.prototype.setPowerMax=function(t){if(t){var e=t.hours,r=t.minutes,n=t.power;this.setUint8(e);this.setUint8(r);this.setUint32(n)}};_o.prototype.getAPlusTariffPowerMax=function(t){var e={};if(t&vo["A+"]){e["A+"]=this.getPowerMax()}if(t&vo["A+R+"]){e["A+R+"]=this.getPowerMax()}if(t&vo["A+R-"]){e["A+R-"]=this.getPowerMax()}return e};_o.prototype.setAPlusTariffPowerMax=function(t){if(t){this.setPowerMax(t["A+"]);this.setPowerMax(t["A+R+"]);this.setPowerMax(t["A+R+"])}};_o.prototype.getAMinusTariffPowerMax=function(t){var e={};if(t&vo["A-"]){e["A-"]=this.getPowerMax()}if(t&vo["A-R+"]){e["A-R+"]=this.getPowerMax()}if(t&vo["A-R-"]){e["A-R-"]=this.getPowerMax()}return e};_o.prototype.setAMinusTariffPowerMax=function(t){if(t){this.setPowerMax(t["A-"]);this.setPowerMax(t["A-R+"]);this.setPowerMax(t["A-R-"])}};_o.prototype.getTariffsPowerMax=function(){var t=this.getUint8();var e=this.getUint8();var r=new Array(ao).fill(null);for(var n=0;n<ao;n++){if(e&uo(n)){r[n]=this.getAPlusTariffPowerMax(t)}}for(var i=0;i<ao;i++){if(e&ho(i)){r[i]={...r[i],...this.getAMinusTariffPowerMax(t)}}}return r};_o.prototype.setTariffsPowerMax=function(t){var e=this;var r=0;var n=0;t.forEach((function(t,e){if(t){r|=fo(t);n|=Eo(e,t)}}));this.setUint8(r);this.setUint8(n);t.forEach((function(t){return e.setAPlusTariffPowerMax(t)}));t.forEach((function(t){return e.setAMinusTariffPowerMax(t)}))};var Ao=fi;var go=5;var To=function(t){var e=new _o(go);e.setDate(t.date);e.setEnergiesFlags(t.energies);e.setUint8(t.firstHalfhour);e.setUint8(t.halfhoursNumber);return rn(Ao,e.data)};var co=vi;var lo=function(){return rn(co)};var po=Ai;var Ro=function(){return rn(po)};var Uo=Un;var yo=2;var Oo=function(t){var e=new tn(yo);e.setUint8(t.year);e.setUint8(t.month);return rn(Uo,e.data)};var mo=Jn;var So=2;var Po=function(t){var e=new tn(So);e.setUint8(t.year);e.setUint8(t.month);return rn(mo,e.data)};var Mo=wn;var Do=function(t){var e=t.year,r=t.month;return rn(Mo,[e,r])};var No=ri;var Io=function(t){var e=t.year,r=t.month;return rn(No,[e,r])};var Co=hi;var Lo=function(){return rn(Co)};var Fo=Sn;var xo=function(){return rn(Fo)};var wo=In;var Yo=function(t){return rn(wo,[t.tariffTable])};var Bo=Dn;var Ho=function(){return rn(Bo)};var Go=Ln;var Vo=function(){return rn(Go)};var Wo=Kn;var bo=3;var Ko=function(t){var e=new tn(bo);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return rn(Wo,e.data)};var Xo=Xn;var jo=3;var zo=function(t){var e=new tn(jo);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return rn(Xo,e.data)};var Qo=Mn;var Zo=function(){return rn(Qo)};var ko=ln;var qo=5;var $o=function(t){var e=new tn(qo);e.setUint8(t.tariffTable);e.setUint32(t.id);return rn(ko,e.data)};var Jo=Hn;var tv=function(){return rn(Jo)};var ev=Gn;var rv=function(){return rn(ev)};var nv=Qn;var iv=function(t){return rn(nv,[t.tariffTable])};var av=16;var sv=En;var ov=1+av;var vv=function(t){var e=new tn(ov);e.setUint8(t.accessLevel);e.setBytes(t.key);return rn(sv,e.data)};var fv=ii;var uv=2;var hv=function(t){var e=new tn(uv);e.setInt16(t.seconds);return rn(fv,e.data)};var Ev=mn;var _v=9;var Av=function(t){var e=new tn(_v);e.setTimeCorrectionParameters(t);return rn(Ev,e.data)};var gv=hn;var Tv=8;var cv=function(t){var e=new tn(Tv);e.setDateTime(t);return rn(gv,e.data)};var dv=8;var lv=255;var pv=gn;var Rv=function(t){var e=t.periods.length<dv;var r=2+t.periods.length+ +e;var n=new tn(r);n.setUint8(t.tariffTable);n.setUint8(t.index);t.periods.forEach((function(t){n.setDayProfile(t)}));if(e){n.setUint8(lv)}return rn(pv,n.data)};var Uv=ai;var yv=function(t){return rn(Uv,[t.displayMode].concat(v(t.order)))};var Ov=Ei;var mv=17;var Sv=function(t){var e=new tn(mv);e.setOperatorParametersExtended3(t);return rn(Ov,e.data)};var Pv=Pn;var Mv=Nr;var Dv=function(t){var e=new tn(Mv);e.setOperatorParameters(t);return rn(Pv,e.data)};var Nv=Nn;var Iv=12;var Cv=function(t){var e=new tn(Iv);e.setUint8(t.date.month);e.setUint8(t.date.date);e.setUint8(t.date.hours);e.setUint8(t.date.minutes);e.setInt32(t.saldoNew);e.setInt32(t.saldoOld);return rn(Nv,e.data)};var Lv=Fn;var Fv=37;var xv=function(t){var e=new tn(Fv);e.setSaldoParameters(t);return rn(Lv,e.data)};var wv=Tn;var Yv=Cr;var Bv=function(t){var e=new tn(Yv);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setSeasonProfile(t);return rn(wv,e.data)};var Hv=cn;var Gv=6;var Vv=function(t){var e=new tn(Gv);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setSpecialDay(t);return rn(Hv,e.data)};var Wv=oi;var bv=2;var Kv=function(t){var e=new tn(bv);var r=0;if(t.readScreensInfo){r|=128}if(t.resetElectroMagneticIndication){r|=1}if(t.resetMagneticIndication){r|=2}e.setUint8(t.type);e.setUint8(r);return rn(Wv,e.data)};var Xv=On;var jv=function(){return rn(Xv)};var zv=yn;var Qv=function(){return rn(zv)};var Zv={encrypt:function(){},decrypt:function(){}};var kv=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var r=e;t.forEach((function(t){r^=t}));return r};var qv=16;var $v=[0];var Jv=function(t){return function(e,r){var n;var i=r.messageId,a=i===void 0?1:i,s=r.accessLevel,o=s===void 0?an:s,f=r.aesKey;var u=e.map((function(e){if("id"in e){return t[e.id](e.parameters||{})}if("command"in e){return e.command.bytes}throw new Error("wrong command format")}));var h=o|16;var E=[a,h];var _=(n=[]).concat.apply(n,[h].concat(v(u),[$v]));if(o!==nn){var A=(_.length+1)%qv;if(A){_=_.concat(new Array(qv-A).fill(0))}}_=_.concat(kv(_));if(f&&o!==nn){_=v(Zv.encrypt(f,_))}return E.concat(_)}};var tf={};var ef=Jv(tf);tf[Ti]=di;tf[li]=pi;tf[Ri]=Ui;tf[Hi]=Gi;tf[Vi]=Wi;tf[bi]=Ki;tf[Xi]=ji;tf[Zi]=ki;tf[Ji]=ta;tf[ea]=na;tf[ia]=sa;tf[oa]=va;tf[fa]=ha;tf[Ea]=Aa;tf[ga]=Ta;tf[ca]=da;tf[ms]=Ps;tf[Ns]=Is;tf[Cs]=Ls;tf[ws]=Ys;tf[Bs]=Hs;tf[Gs]=Ws;tf[bs]=Ks;tf[Xs]=js;tf[zs]=Qs;tf[Zs]=ks;tf[qs]=Js;tf[to]=ro;tf[no]=io;tf[Ao]=To;tf[co]=lo;tf[po]=Ro;tf[Uo]=Oo;tf[mo]=Po;tf[Mo]=Do;tf[No]=Io;tf[Co]=Lo;tf[Fo]=xo;tf[wo]=Yo;tf[Bo]=Ho;tf[Go]=Vo;tf[Wo]=Ko;tf[Xo]=zo;tf[Qo]=Zo;tf[ko]=$o;tf[Jo]=tv;tf[ev]=rv;tf[nv]=iv;tf[sv]=vv;tf[fv]=hv;tf[Ev]=Av;tf[gv]=cv;tf[pv]=Rv;tf[Uv]=yv;tf[Ov]=Sv;tf[Pv]=Dv;tf[Nv]=Cv;tf[Lv]=xv;tf[wv]=Bv;tf[Hv]=Vv;tf[Wv]=Kv;tf[Xv]=jv;tf[zv]=Qv;var rf=145;var nf=30;var af=function(t){var e=[nf,t.length+2,0,rf].concat(v(t));return[].concat(v(e),[kv(e)])};getBase64FromBytes=en;toBytes=ef;setDataSegment=af})();
//#endregion


/*
  Incoming arguments:
    * msg - JSON message payload downlink message json
    * msgType - type of message, for ex. 'ATTRIBUTES_UPDATED', 'POST_TELEMETRY_REQUEST', etc.
    * metadata - list of key-value pairs with additional data about the message
    * integrationMetadata - list of key-value pairs with additional data defined in Integration executing this converter

  Output must be an object with the following fields:
    * contentType - BINARY
    * data - payload in base64
*/

var bytes = toBytes(msg.commands);

// send nothing if not fit in a single data segment
if ( bytes.length > MAX_DATA_SEGMENT_SIZE ) {
    bytes = [];
} else {
    bytes = setDataSegment(bytes);
}

var result = {
    contentType: 'BINARY',
    data: getBase64FromBytes(bytes)
};

return result;
