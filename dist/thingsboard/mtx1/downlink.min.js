// IMPORTANT!!!
// This example only for default downlink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/

// encoded message should be less than this size
// to be able to send to a device
var MAX_DATA_SEGMENT_SIZE = 50;


//#region [autogenerated jooby-codec bundle from index.js]
var toBytes,setDataSegment,getBase64FromBytes;(function(){"use strict";function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(t){if(Array.isArray(t))return t}function r(e){if(Array.isArray(e))return t(e)}function n(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function i(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,a,s,o=[],f=!0,h=!1;try{if(a=(r=r.call(t)).next,0===e);else for(;!(f=(n=a.call(r)).done)&&(o.push(n.value),o.length!==e);f=!0);}catch(t){h=!0,i=t}finally{try{if(!f&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(h)throw i}}return o}}function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,r){return e(t)||i(t,r)||h(t,r)||a()}function f(t){return r(t)||n(t)||h(t)||s()}function h(e,r){if(e){if("string"==typeof e)return t(e,r);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}var v={separator:" ",prefix:""};var u=1;var E=2;var _=3;var c=4;var g=Math.log,A=Math.pow,d=Math.LN2;var l=function(t,e,r,n,i){var a,s,o=i*8-n-1,f=(1<<o)-1,h=f>>1,v=-7,u=r?i-1:0,E=r?-1:1,_=t[e+u];u+=E;a=_&(1<<-v)-1;_>>=-v;v+=o;for(;v>0;a=a*256+t[e+u],u+=E,v-=8);s=a&(1<<-v)-1;a>>=-v;v+=n;for(;v>0;s=s*256+t[e+u],u+=E,v-=8);if(a===0){a=1-h}else if(a===f){return s?NaN:_?-Infinity:Infinity}else{s=s+A(2,n);a=a-h}return(_?-1:1)*s*A(2,a-n)};var U=function(t,e,r,n,i,a){var s,o,f,h=a*8-i-1,v=(1<<h)-1,u=v>>1,E=i===23?A(2,-24)-A(2,-77):0,_=n?0:a-1,c=n?1:-1,l=r<0||r===0&&1/r<0?1:0;r<0&&(r=-r);if(r!==r||r===Infinity){o=r!==r?1:0;s=v}else{s=g(r)/d|0;if(r*(f=A(2,-s))<1){s--;f*=2}if(s+u>=1){r+=E/f}else{r+=E*A(2,1-u)}if(r*f>=2){s++;f/=2}if(s+u>=v){o=0;s=v}else if(s+u>=1){o=(r*f-1)*A(2,i);s=s+u}else{o=r*A(2,u-1)*A(2,i);s=0}}for(;i>=8;t[e+_]=o&255,_+=c,o/=256,i-=8);s=s<<i|o;h+=i;for(;h>0;t[e+_]=s&255,_+=c,s/=256,h-=8);t[e+_-c]|=l*128};var p=[1,0];var T=[2,1,0];var y=[3,2,1,0];var R=[0,1];var O=[0,1,2];var m=[0,1,2,3];var S=function(t,e){return t[e]};var M=function(t,e,r){var n=r?R:p;var i=t[e+n[0]];var a=t[e+n[1]]<<8;return i|a};var P=function(t,e,r){var n=r?O:T;var i=t[e+n[0]];var a=t[e+n[1]]<<8;var s=t[e+n[2]]<<16;return i|a|s};var D=function(t,e,r){var n=r?m:y;var i=t[e+n[3]]*16777216;var a=t[e+n[2]]*65536;var s=t[e+n[1]]*256;var o=t[e+n[0]];return i+a+s+o};var L=function(t,e,r){t[e]=r&255};var N=function(t,e,r,n){var i=n?R:p;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255};var I=function(t,e,r,n){var i=n?O:T;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255;t[e+i[2]]=r>>>16&255};var C=function(t,e,r,n){var i=n?m:y;t[e+i[0]]=r&255;t[e+i[1]]=r>>>8&255;t[e+i[2]]=r>>>16&255;t[e+i[3]]=r>>>24&255};function F(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof t==="number"){var r=new Array(t).fill(0);this.data=r}else{this.data=t}this.offset=0;this.isLittleEndian=e}F.prototype={toUint8Array:function(){return this.data},seek:function(t){if(t<0||t>=this.data.length){throw new Error("Invalid position.")}this.offset=t},setInt8:function(t){L(this.data,this.offset,t<0?t|256:t);this.offset+=u},getInt8:function(){var t=S(this.data,this.offset);this.offset+=u;return t&128?t^-256:t},setUint8:function(t){L(this.data,this.offset,t);this.offset+=u},getUint8:function(){var t=S(this.data,this.offset);this.offset+=u;return t},setInt16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;N(this.data,this.offset,t<0?t|65536:t,e);this.offset+=E},getInt16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=M(this.data,this.offset,t);this.offset+=E;return e&32768?e^-65536:e},setUint16:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;N(this.data,this.offset,t,e);this.offset+=E},getUint16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=M(this.data,this.offset,t);this.offset+=E;return e},setInt24:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;I(this.data,this.offset,t<0?t|16777216:t,e);this.offset+=_},getInt24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=P(this.data,this.offset,t);this.offset+=_;return e&8388608?e^-16777216:e},setUint24:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;I(this.data,this.offset,t,e);this.offset+=_},getUint24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=P(this.data,this.offset,t);this.offset+=_;return e},setInt32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;C(this.data,this.offset,t<0?t|4294967296:t,e);this.offset+=c},getInt32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=D(this.data,this.offset,t);this.offset+=c;return e&2147483648?e^-4294967296:e},setUint32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;C(this.data,this.offset,t,e);this.offset+=c},getUint32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=D(this.data,this.offset,t);this.offset+=c;return e},setFloat32:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;U(this.data,this.offset,t,e,23,4);this.offset+=c},getFloat32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var e=l(this.data,this.offset,t,23,4);this.offset+=c;return e},setString:function(t){this.setUint8(t.length);for(var e=0;e<t.length;++e){this.setUint8(t.charCodeAt(e))}},getString:function(){var t=this.getUint8();var e=this.offset+t;var r=[];while(this.offset<e){r.push(String.fromCharCode(this.getUint8()))}return r.join("")},getBytesToOffset:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,t)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=e+t;return this.data.slice(e,this.offset)},setBytes:function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var r=this.data;r.splice.apply(r,[e,t.length].concat(f(t)));this.data=r;this.offset=e+t.length}};Object.defineProperties(F.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var w=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=0;for(var n in e){if(n in t&&e[n]){r|=t[n]}}return r};var x=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var r={};for(var n in t){r[n]=(e&t[n])!==0}return r};var Y=function(t,e,r){return(1<<e)-1&t>>r-1};var B=function(t,e,r,n){var i=(1<<e)-1<<r-1;var a=n;var s=t;s&=~i;a<<=r-1;s|=a;return s};var H=function(t){var e=t.trim();if(!e){return[]}e=e.replace(/0x/g,"").split(/\s+/).map((function(t){return t.padStart(2,"0")})).join("");if(e.length%2!==0){e="0".concat(e)}var r=e.length/2;var n=new Array(r);for(var i=0;i<r;i++){n[i]=parseInt(e.substring(i*2,i*2+2),16)}return n};var G="x";var b=[".","1","3","R","M"];var V=[".","A","G","R","T","D"];var W=[".","0","1","2","3","4","5"];var K=[".","A","B","C","D","E","F"];var X=[".","A","B","C","D","E","F","H","K","G"];var j=[".","1","2","3","4"];var Q=[".","L","M","Z","K"];var z=[".","0","1","2","3","4","5","6","7","8","9"];var k=[".","D","B","C","E","P","R","O","L","F","S","M","Y","G","N","U"];var q=[".","0","1","2","3","4","5","6","P","R","L","E","G","-","/"];var Z=[".","H","A","T","0","0","0","0","0","1","2","3","4","0","0","0"];var $=[".","0","1","2","3","4","5","6","7","8","I","X","G","W","M","-"];var J=function(t){return[t>>4,t&15]};var tt=function(t){var e=new Array(t.length*2).fill(0);t.forEach((function(t,r){var n=J(t),i=o(n,2),a=i[0],s=i[1];e[r*2]=a;e[r*2+1]=s}));return e};var et=function(t){var e=[];t.forEach((function(t){return e.push(t.toString(16))}));if(t.length&1){e.push("0")}return H(e.join(""))};var rt=function(t){if(t.length!==14&&t.length!==16){throw new Error("Device type bytes wrong size")}var e=["MTX "];e.push(b[t[0]]??G);e.push(V[t[1]]??G);e.push(W[t[2]]??G);e.push(W[t[3]]??G);e.push(".");e.push(K[t[4]]??G);e.push(X[t[5]]??G);e.push(".");e.push(j[t[6]]??G);e.push(Q[t[7]]??G);var r=t[8];e.push(z[t[9]]??G);e.push("-");var n;if(t.length<14||t[12]===0&&t[13]===0){e.push(k[t[10]]??G);n=11}else if(t[13]===0){e.push(k[t[10]]??G);e.push(k[t[11]]??G);n=12}else{e.push(k[t[10]]??G);e.push(k[t[11]]??G);e.push(k[t[12]]??G);n=13}var i=t[n];if(i&&i!==0){e.push(Z[i]??G)}return{type:e.join(""),revision:r,meterType:0}};var nt=function(t,e,r){var n=[];if(t.length<11){throw new Error("Wrong format")}n.push(b.indexOf(t[0]));n.push(V.indexOf(t[1]));n.push(W.indexOf(t[2]));n.push(W.indexOf(t[3]));if(t[4]!=="."){throw new Error("Wrong format")}n.push(K.indexOf(t[5]));n.push(X.indexOf(t[6]));if(t[7]!=="."){throw new Error("Wrong format")}n.push(j.indexOf(t[8]));n.push(Q.indexOf(t[9]));n.push(r??0);n.push(z.indexOf(t[10]));if(t[11]!=="-"){throw new Error("Wrong format")}var i=t.length>13?t.length-1:t.length;for(var a=12;a<i;a++){n.push(k.indexOf(t[a]))}if(i<t.length){n.push(Z.indexOf(t[i]))}var s=et(n);var o=new Array(9).fill(0);o[0]=0;for(var f=0;f<s.length;f++){o[f+(s.length<8?1:0)]=s[f]}return o};var it=function(t){if(t.length<14){throw new Error("The buffer is too small")}var e=["MTX "];var r=t[1]===5?"-":" ";e.push(b[t[0]]??G);e.push(V[t[1]]??G);e.push(r);for(var n=2;n<t.length;n++){if(t[n]!==0){e.push(q[t[n]]??G)}}return{type:e.join(""),meterType:0}};var at=function(t){if(t.length<3){throw new Error("Wrong format")}var e=[];e.push(b.indexOf(t[0]));e.push(V.indexOf(t[1]));for(var r=3;r<t.length;r++){e.push(q.indexOf(t[r]))}var n=et(e);if(n.length===8){return n}if(n.length>8){throw new Error("Wrong format")}var i=new Array(8).fill(0);for(var a=0;a<n.length;a++){i[a]=n[a]}return i};var st=function(t){if(t.length<14){throw new Error("The buffer is too small")}var e=[];e.push(b[t[0]]??G);for(var r=1;r<t.length;r++){if(t[r]!==0){e.push($[t[r]]??G)}}return{type:e.join(""),meterType:0}};var ot=function(t){if(t.length<1){throw new Error("Wrong format")}var e=[];e.push(b.indexOf(t[0]));for(var r=1;r<t.length;r++){e.push($.indexOf(t[r]))}var n=et(e);var i=new Array(8).fill(0);for(var a=0;a<n.length&&a<8;a++){i[a]=n[a]}return i};var ft=function(t){if(t.length!==9){throw new Error("The buffer is too small")}var e;var r=[0,5,6,7,9,127,239];var n=r.indexOf(t[0])!==-1?2:0;var i=tt(t.slice(0,8));var a=i[n];var s=b[a];if(s==="1"||s==="3"){e=rt(i.slice(n))}else{e=s==="M"?st(i):it(i)}e.meterType=t[8];return e};var ht=function(t,e){var r=t.type,n=t.revision,i=t.meterType;if(!r.startsWith("MTX ")){throw new Error("Wrong format")}var a;var s=r.substring(4);var o=r[4];if(o==="1"||o==="3"){a=nt(s,e,n)}else{a=o==="M"?ot(s):at(s)}a[8]=i;return a};var vt=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=Object.assign({},v,e),n=r.separator,i=r.prefix;return t.map((function(t){return"".concat(i).concat(t.toString(16).padStart(2,"0"))})).join(n)};var ut=80;var Et=81;var _t=82;var ct=83;var gt=84;var At=85;var dt=86;var lt=87;var Ut=88;var pt=89;var Tt=90;var yt=91;var Rt=255;var Ot=Object.freeze({__proto__:null,DATA_REQUEST:ut,DATA_RESPONSE:Et,FRAGMENT_REQUEST:Tt,FRAGMENT_RESPONSE:yt,IDENT_REQUEST:_t,IDENT_RESPONSE:ct,INVALID:Rt,L2_CHECK_ADDRESS_REQUEST:dt,L2_CHECK_ADDRESS_RESPONSE:lt,L2_RM_ADDRESS_REQUEST:Ut,L2_RM_ADDRESS_RESPONSE:pt,L2_SET_ADDRESS_REQUEST:gt,L2_SET_ADDRESS_RESPONSE:At});var mt=function(t){var e={};for(var r in t){var n=t[r];e[n]=r}return e};var St=mt(Ot);var Mt=1;var Pt=2;var Dt=3;var Lt=16;var Nt=17;var It=18;var Ct=19;var Ft=20;var wt=21;var xt=32;var Yt=33;var Bt=34;var Ht=35;var Gt=36;var bt=37;var Vt=38;var Wt=39;var Kt=40;var Xt=41;var jt=49;var Qt=50;var zt=51;var kt=52;var qt=53;var Zt=54;var $t=55;var Jt=56;var te=57;var ee=64;var re=65;var ne=66;var ie=67;var ae=68;var se=69;var oe=70;var fe=71;var he=72;var ve=73;var ue=74;var Ee=75;var _e=76;var ce=77;var ge=78;var Ae=79;var de=80;var le=81;var Ue=82;var pe=83;var Te=84;var ye=85;var Re=86;var Oe=87;var me=88;var Se=89;var Me=96;var Pe=97;var De=98;var Le=99;var Ne=100;var Ie=101;var Ce=102;var Fe=103;var we=104;var xe=105;var Ye=112;var Be=113;var He=114;var Ge=115;var be=116;var Ve=117;var We=118;var Ke=119;var Xe=120;var je=121;var Qe=122;var ze=123;var ke=124;var qe=125;var Ze=144;var $e=145;var Je=147;var tr=148;var er=156;var rr=157;var nr=158;var ir=159;var ar=160;var sr=161;var or=162;var fr=176;var hr=177;var vr=178;var ur=179;var Er=180;var _r=181;var cr=182;var gr=183;var Ar=208;var dr=224;var lr=225;var Ur=226;var pr=227;var Tr=228;var yr=229;var Rr=230;var Or=Object.freeze({__proto__:null,ACCESS_CLOSED:Lt,ACCPARAM_BAD:He,ACCPARAM_EXT_BAD:Ge,BAD_TEST_EEPROM:we,BAD_TEST_FRAM:xe,BAT_FAULT:pe,BAT_OK:Ue,BIPOLAR_POWER_FAULT:Er,BIPOLAR_POWER_OK:_r,BLOCK_TARIFF_BAD:Ve,CALC_PERIOD_BAD:be,CALFLAG_RESET:Fe,CALFLAG_SET:Ce,CALIBR_PARAM_BAD:We,CAL_FAULT:ye,CAL_OK:Te,CASE_CLOSE:Ct,CASE_MODULE_CLOSE:qe,CASE_MODULE_OPEN:ke,CASE_OPEN:It,CASE_TERMINAL_CLOSE:ze,CASE_TERMINAL_OPEN:Qe,CHANGE_ACCESS_KEY0:xt,CHANGE_ACCESS_KEY1:Yt,CHANGE_ACCESS_KEY2:Bt,CHANGE_ACCESS_KEY3:Ht,CHANGE_COR_TIME:Xt,CHANGE_PAR_LOCAL:Gt,CHANGE_PAR_REMOTE:bt,CHANGE_TARIFF_TBL:Qt,CLOCK_FAULT:Oe,CLOCK_OK:Re,CMD_CHANGE_TIME:Vt,CMD_RELAY_2_OFF:Pe,CMD_RELAY_2_ON:Me,CMD_RELAY_OFF:Kt,CMD_RELAY_ON:Wt,CROSSZERO_ENT0:De,CROSSZERO_ENT1:Le,CROSSZERO_ENT2:Ne,CROSSZERO_ENT3:Ie,CROSSZERO_EXP_ENT0:nr,CROSSZERO_EXP_ENT1:ir,CROSSZERO_EXP_ENT2:ar,CROSSZERO_EXP_ENT3:sr,CURRENT_UNEQUIL_FAULT:vr,CURRENT_UNEQUIL_OK:ur,EM_MAGNETIC_OFF:hr,EM_MAGNETIC_ON:fr,ENERGY_REG_FAULT:Mt,ENERGY_REG_OVERFLOW:jt,ERR_ACCESS:Nt,F_MAX_OK:he,F_MAX_OVER:ve,F_MIN_OK:ue,F_MIN_OVER:Ee,I_MAX_OK:_e,I_MAX_OVER:ce,MAGNETIC_OFF:wt,MAGNETIC_ON:Ft,NVRAM_FAULT:Ar,OP_PAR_FAULT:Dt,POWERSALDO_OK:de,POWERSALDO_OVER:le,POWER_A_OFF:me,POWER_A_ON:Se,POWER_OVER_RELAY_OFF:rr,P_MAX_OK:ge,P_MAX_OVER:Ae,RELAY_HARD_BAD_OFF:Ze,RELAY_HARD_BAD_ON:Je,RELAY_HARD_OFF:tr,RELAY_HARD_ON:$e,RELAY_OFF:$t,RELAY_ON:Zt,RESET_EM_FLAG:cr,RESET_MAGN_FLAG:gr,RESTART:Jt,SALDO_EN_BAD:Xe,SALDO_PARAM_BAD:Be,SET_DEMAND_EN_10MIN:pr,SET_DEMAND_EN_15MIN:Tr,SET_DEMAND_EN_1MIN:dr,SET_DEMAND_EN_30MIN:yr,SET_DEMAND_EN_3MIN:lr,SET_DEMAND_EN_5MIN:Ur,SET_DEMAND_EN_60MIN:Rr,SET_NEW_SALDO:Ye,SET_SALDO_PARAM:er,SET_TARIFF_TBL:zt,SUMMER_TIME:kt,TIME_CORRECT:je,TIME_CORRECT_NEW:or,T_MAX_OK:ae,T_MAX_OVER:se,T_MIN_OK:oe,T_MIN_OVER:fe,VENDOR_PAR_FAULT:Pt,V_MAX_OK:ee,V_MAX_OVER:re,V_MIN_OK:ne,V_MIN_OVER:ie,WD_RESTART:te,WINTER_SUMMER_BAD:Ke,WINTER_TIME:qt});var mr=mt(Or);var Sr={type:ut,destination:65535,source:65534};var Mr=11;var Pr=74;var Dr=7;var Lr=2+Dr;var Nr=4;var Ir={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_COEFFICIENT_PHASE_A:524288,POWER_COEFFICIENT_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var Cr={...Ir,AUTO_SCREEN_SCROLLING:2147483648};var Fr={...Ir,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var wr={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_0:8,RELAY_ON_TARIFF_1:16,RELAY_ON_TARIFF_2:32,RELAY_ON_TARIFF_3:64,RELAY_ON_V_GOOD:128};var xr={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_0:4,RELAY_OFF_TARIFF_1:8,RELAY_OFF_TARIFF_2:16,RELAY_OFF_TARIFF_3:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var Yr={RELAY_OFF_LIM_TARIFF_0:2,RELAY_OFF_LIM_TARIFF_1:4,RELAY_OFF_LIM_TARIFF_2:8,RELAY_OFF_LIM_TARIFF_3:16,RELAY_OFF_PF_MIN:32};var Br={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var Hr={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var Gr={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var br={CASE_OPEN:2**0,MAGNETIC_ON:2**1,PARAMETERS_UPDATE_REMOTE:2**2,PARAMETERS_UPDATE_LOCAL:2**3,RESTART:2**4,ERROR_ACCESS:2**5,TIME_SET:2**6,TIME_CORRECT:2**7,DEVICE_FAILURE:2**8,CASE_TERMINAL_OPEN:2**9,CASE_MODULE_OPEN:2**10,TARIFF_TABLE_SET:2**11,TARIFF_TABLE_GET:2**12,PROTECTION_RESET_EM:2**13,PROTECTION_RESET_MAGNETIC:2**14};var Vr={RELAY_STATE:2**0,RELAY_UBAD:2**1,RELAY_UNEQ_CURRENT:2**4,RELAY_OFF_CENTER:2**5,RELAY_IMAX:2**6,RELAY_PMAX:2**7};var Wr={RELAY_COSFI:2**0,RELAY_SALDO_OFF_FLAG:2**1,RELAY_UNEQUIL_CURRENT_OFF:2**2,RELAY_BIPOLAR_POWER_OFF:2**3,RELAY_SALDO_OFF_ON_MAX_POWER:2**4,RELAY_HARD_ST1:2**5};var Kr={MAXVA:2**0,MINVA:2**1,MAXT:2**2,MINT:2**3,MAXF:2**4,MINF:2**5,MAXIA:2**6,MAXP:2**7};var Xr={MAX_POWER_SALDO:2**0,BATTERY_VBAT_BAD:2**1,CLOCK_UNSET:2**3,MIN_COS_FI:2**5};var jr={UNEQUIL_CURRENT:2**0,BIPOLAR_POWER:2**1,POWER_A_NEGATIVE:2**6,POWER_B_NEGATIVE:2**7};var Qr={RELAY_OFF_LIMIT_P_MINUS_T1:4,RELAY_OFF_LIMIT_P_MINUS_T2:8,RELAY_OFF_LIMIT_P_MINUS_T3:16,RELAY_OFF_LIMIT_P_MINUS_T4:32};function zr(t,e,r){var n=r>>Nr;var i=new Array(Nr).fill(0);i.forEach((function(e,r){var a=!!Y(n,1,r+1);if(a){i[r]=t.getUint32()}else{i[r]=null}}));return i}function kr(t,e,r){var n=1+Nr;var i=e;r.forEach((function(t,e){i=B(i,1,e+n,Number(!!t))}));t.setUint8(i)}function qr(t){if(t===65535){return{tariff:undefined,energy:undefined}}return{tariff:t>>14&3,energy:t&16383}}function Zr(t,e){var r=e.tariff,n=e.energy;if(r!==undefined&&n!==undefined){t.setUint16(r<<14|n&16383)}else{t.setUint16(65535)}}function $r(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;F.call(this,t,e)}$r.prototype=Object.create(F.prototype);$r.prototype.constructor=$r;$r.getDayProfileFromByte=function(t){return{tariff:Y(t,2,1),isFirstHalfHour:!Y(t,1,3),hour:Y(t,5,4)}};$r.getByteFromDayProfile=function(t){var e=0;e=B(e,2,1,t.tariff);e=B(e,1,3,+!t.isFirstHalfHour);e=B(e,5,4,t.hour);return e};$r.getDefaultSeasonProfile=function(){return{month:1,date:1,dayIndexes:[0,0,0,0,0,0,0]}};$r.getDefaultOperatorParameters=function(){return{vpThreshold:265e3,vThreshold:156e3,ipThreshold:12e4,pmaxThreshold0:31800,pmaxThreshold1:31800,pmaxThreshold2:31800,pmaxThreshold3:31800,speedOptoPort:0,tint:30,calcPeriodDate:1,timeoutDisplay:127,timeoutScreen:7,displaySet:x(Cr,2147496324),relaySet4:x(Br,0),relaySet3:x(Yr,0),relaySet2:x(xr,3),relaySet1:x(wr,3),displayType:0,ten:0,timeoutRefresh:240,deltaCorMin:15,timeoutMagnetOff:5,timeoutMagnetOn:5,define1:x(Gr,0),timeoutRelayOn:1,timeoutRelayKey:0,timeoutRelayAuto:5,timeoutBadVAVB:5,freqMax:55,freqMin:45,phMin:0,year:0,month:0,date:0,energyDecimalPoint:2,typeMeter:0,timeoutIMax:5,timeoutPMax:5,timeoutCos:5,pMaxDef:1,displaySetExt:x(Fr,137904127),timeoutUneqCurrent:5,timeoutBipolarPower:5,relaySet5:x(Hr,0),timeCorrectPeriod:24,timeCorrectPassHalfhour:false}};$r.prototype.getFrameHeader=function(){var t=this.getUint8();var e=St[t];var r=this.getUint16();var n=this.getUint16();return{type:t,typeName:e,destination:r,source:n}};$r.prototype.setFrameHeader=function(t){var e=t.type,r=e===void 0?Sr.type:e,n=t.destination,i=n===void 0?Sr.destination:n,a=t.source,s=a===void 0?Sr.source:a;this.setUint8(r);this.setUint16(i);this.setUint16(s)};$r.prototype.getDeviceId=function(){var t=vt(this.getBytes(3),{separator:""});var e=this.getUint8();var r=this.getUint8();var n=vt(this.getBytes(3),{separator:""});return{manufacturer:t,type:e,year:r,serial:n}};$r.prototype.setDeviceId=function(t){var e=t.manufacturer,r=t.type,n=t.year,i=t.serial;this.setBytes(H(e));this.setUint8(r);this.setUint8(n);this.setBytes(H(i))};$r.prototype.getDateTime=function(){return{isSummerTime:!!this.getUint8(),seconds:this.getUint8(),minutes:this.getUint8(),hours:this.getUint8(),day:this.getUint8(),date:this.getUint8(),month:this.getUint8(),year:this.getUint8()}};$r.prototype.setDateTime=function(t){this.setUint8(t.isSummerTime?1:0);this.setUint8(t.seconds);this.setUint8(t.minutes);this.setUint8(t.hours);this.setUint8(t.day||0);this.setUint8(t.date);this.setUint8(t.month);this.setUint8(t.year)};$r.prototype.getTariffPlan=function(){return{id:this.getUint32(),tariffSet:this.getUint8(),activateYear:this.getUint8(),activateMonth:this.getUint8(),activateDay:this.getUint8(),specialProfilesArraySize:this.getUint8(),seasonProfilesArraySize:this.getUint8(),dayProfilesArraySize:this.getUint8()}};$r.prototype.setTariffPlan=function(t){this.setUint32(t.id);this.setUint8(t.tariffSet);this.setUint8(t.activateYear);this.setUint8(t.activateMonth);this.setUint8(t.activateDay);this.setUint8(t.specialProfilesArraySize);this.setUint8(t.seasonProfilesArraySize);this.setUint8(t.dayProfilesArraySize)};$r.prototype.getTimeCorrectionParameters=function(){return{monthTransitionSummer:this.getUint8(),dateTransitionSummer:this.getUint8(),hoursTransitionSummer:this.getUint8(),hoursCorrectSummer:this.getUint8(),monthTransitionWinter:this.getUint8(),dateTransitionWinter:this.getUint8(),hoursTransitionWinter:this.getUint8(),hoursCorrectWinter:this.getUint8(),isCorrectionNeeded:this.getUint8()===1}};$r.prototype.setTimeCorrectionParameters=function(t){this.setUint8(t.monthTransitionSummer);this.setUint8(t.dateTransitionSummer);this.setUint8(t.hoursTransitionSummer);this.setUint8(t.hoursCorrectSummer);this.setUint8(t.monthTransitionWinter);this.setUint8(t.dateTransitionWinter);this.setUint8(t.hoursTransitionWinter);this.setUint8(t.hoursCorrectWinter);this.setUint8(+t.isCorrectionNeeded)};$r.prototype.getDayProfile=function(){return $r.getDayProfileFromByte(this.getUint8())};$r.prototype.setDayProfile=function(t){this.setUint8($r.getByteFromDayProfile(t))};$r.prototype.getSeasonProfile=function(){var t=this;return{month:this.getUint8(),date:this.getUint8(),dayIndexes:new Array(Dr).fill(0).map((function(){return t.getUint8()}))}};$r.prototype.setSeasonProfile=function(t){var e=this;this.setUint8(t.month);this.setUint8(t.date);t.dayIndexes.forEach((function(t){return e.setUint8(t)}))};$r.prototype.getSpecialDay=function(){return{month:this.getUint8(),date:this.getUint8(),dayIndex:this.getUint8(),isPeriodic:this.getUint8()===0}};$r.prototype.setSpecialDay=function(t){this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.dayIndex);this.setUint8(+!t.isPeriodic)};$r.prototype.getDeviceType=function(){return ft(this.getBytes(9))};$r.prototype.setDeviceType=function(t){this.setBytes(ht(t))};$r.prototype.getOperatorParameters=function(){var t={vpThreshold:this.getUint32(),vThreshold:this.getUint32(),ipThreshold:this.getUint32(),pmaxThreshold0:this.getUint32(),pmaxThreshold1:this.getUint32(),pmaxThreshold2:this.getUint32(),pmaxThreshold3:this.getUint32(),speedOptoPort:this.getUint8(),tint:this.getUint8(),calcPeriodDate:this.getUint8(),timeoutDisplay:this.getUint8(),timeoutScreen:this.getUint8(),displaySet:x(Cr,this.getUint32()),relaySet4:x(Br,this.getUint8()),relaySet3:x(Yr,this.getUint8()),relaySet2:x(xr,this.getUint8()),relaySet1:x(wr,this.getUint8()),displayType:this.getUint8(),ten:this.getUint8(),timeoutRefresh:this.getUint16(),deltaCorMin:this.getUint8(),timeoutMagnetOff:this.getUint8(),timeoutMagnetOn:this.getUint8(),define1:x(Gr,this.getUint8()),timeoutRelayOn:this.getUint8(),timeoutRelayKey:this.getUint8(),timeoutRelayAuto:this.getUint8(),timeoutBadVAVB:this.getUint8(),freqMax:this.getUint8(),freqMin:this.getUint8(),phMin:this.getUint16(),year:this.getUint8(),month:this.getUint8(),date:this.getUint8(),energyDecimalPoint:this.getUint8(),typeMeter:this.getUint8(),timeoutIMax:this.getUint8(),timeoutPMax:this.getUint8(),timeoutCos:this.getUint8(),pMaxDef:this.getUint8(),displaySetExt:x(Fr,this.getUint32()),timeoutUneqCurrent:this.getUint8(),timeoutBipolarPower:this.getUint8(),relaySet5:x(Hr,this.getUint8()),timeCorrectPeriod:0,timeCorrectPassHalfhour:false};var e=this.getUint8();t.timeCorrectPeriod=e&127;t.timeCorrectPassHalfhour=!!(e&128);return t};$r.prototype.setOperatorParameters=function(t){var e=t.timeCorrectPeriod|(t.timeCorrectPassHalfhour?128:0);this.setUint32(t.vpThreshold);this.setUint32(t.vThreshold);this.setUint32(t.ipThreshold);this.setUint32(t.pmaxThreshold0);this.setUint32(t.pmaxThreshold1);this.setUint32(t.pmaxThreshold2);this.setUint32(t.pmaxThreshold3);this.setUint8(t.speedOptoPort);this.setUint8(t.tint);this.setUint8(t.calcPeriodDate);this.setUint8(t.timeoutDisplay);this.setUint8(t.timeoutScreen);this.setUint32(w(Cr,t.displaySet));this.setUint8(w(Br,t.relaySet4));this.setUint8(w(Yr,t.relaySet3));this.setUint8(w(xr,t.relaySet2));this.setUint8(w(wr,t.relaySet1));this.setUint8(t.displayType);this.setUint8(t.ten);this.setUint16(t.timeoutRefresh);this.setUint8(t.deltaCorMin);this.setUint8(t.timeoutMagnetOff);this.setUint8(t.timeoutMagnetOn);this.setUint8(w(Gr,t.define1));this.setUint8(t.timeoutRelayOn);this.setUint8(t.timeoutRelayKey);this.setUint8(t.timeoutRelayAuto);this.setUint8(t.timeoutBadVAVB);this.setUint8(t.freqMax);this.setUint8(t.freqMin);this.setUint16(t.phMin);this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date);this.setUint8(t.energyDecimalPoint);this.setUint8(t.typeMeter);this.setUint8(t.timeoutIMax);this.setUint8(t.timeoutPMax);this.setUint8(t.timeoutCos);this.setUint8(t.pMaxDef);this.setUint32(w(Fr,t.displaySetExt));this.setUint8(t.timeoutUneqCurrent);this.setUint8(t.timeoutBipolarPower);this.setUint8(w(Hr,t.relaySet5));this.setUint8(e)};$r.prototype.getPackedEnergyWithType=function(){var t=this.getUint8();var e=Y(t,Nr,1);var r=zr(this,e,t);return{energyType:e,energies:r}};$r.prototype.setPackedEnergyWithType=function(t){var e=this;var r=t.energyType,n=t.energies;if(r){kr(this,r,n)}n.forEach((function(t){if(t!==null){e.setUint32(t)}}))};$r.prototype.getEnergies=function(){var t=this;return new Array(Nr).fill(0).map((function(){return t.getInt32()}))};$r.prototype.setEnergies=function(t){var e=this;t.forEach((function(t){return e.setUint32(t)}))};$r.prototype.getDate=function(){return{year:this.getUint8(),month:this.getUint8(),date:this.getUint8()}};$r.prototype.setDate=function(t){this.setUint8(t.year);this.setUint8(t.month);this.setUint8(t.date)};$r.prototype.getSaldoParameters=function(){var t=this;return{coefficients:new Array(4).fill(0).map((function(){return t.getUint32()})),decimalPointTariff:this.getUint8(),indicationThreshold:this.getInt32(),relayThreshold:this.getInt32(),mode:this.getUint8(),saldoOffTimeBegin:this.getUint8(),saldoOffTimeEnd:this.getUint8(),decimalPointIndication:this.getUint8(),powerThreshold:this.getUint32(),creditThreshold:this.getInt32()}};$r.prototype.setSaldoParameters=function(t){var e=this;t.coefficients.forEach((function(t){return e.setUint32(t)}));this.setUint8(t.decimalPointTariff);this.setInt32(t.indicationThreshold);this.setInt32(t.relayThreshold);this.setUint8(t.mode);this.setUint8(t.saldoOffTimeBegin);this.setUint8(t.saldoOffTimeEnd);this.setUint8(t.decimalPointIndication);this.setUint32(t.powerThreshold);this.setInt32(t.creditThreshold)};$r.prototype.getEnergyPeriods=function(t){var e=this;var r=new Array(t).fill(0).map((function(){return e.getUint16()}));return r.map((function(t){return qr(t)}))};$r.prototype.setEnergyPeriods=function(t){var e=this;t.forEach((function(t){return Zr(e,t)}))};$r.prototype.getEventStatus=function(){var t=this.getUint16();return x(br,t)};$r.prototype.setEventStatus=function(t){this.setUint16(w(br,t))};$r.prototype.getExtendedCurrentValues2=function(){var t=this.getUint16();var e=x(Vr,this.getUint8());var r=x(Wr,this.getUint8());var n=x(Kr,this.getUint8());var i=x(Xr,this.getUint8());var a=x(jr,this.getUint8());return{uBattery:t,relayStatus:e,relayStatus2:r,status1:n,status2:i,status3:a}};$r.prototype.setExtendedCurrentValues2=function(t){var e=t.uBattery,r=t.relayStatus,n=t.relayStatus2,i=t.status1,a=t.status2,s=t.status3;this.setUint16(e);this.setUint8(w(Vr,r));this.setUint8(w(Wr,n));this.setUint8(w(Kr,i));this.setUint8(w(Xr,a));this.setUint8(w(jr,s))};$r.prototype.getEvent=function(){var t={hours:this.getUint8(),minutes:this.getUint8(),seconds:this.getUint8(),event:this.getUint8()};var e=t.event;var r=this.bytesLeft;t.eventName=mr[e];switch(e){case rr:if(r<4){return t}t.power=[this.getUint8(),this.getUint8(),this.getUint8(),this.getUint8()];break;case Vt:case je:if(r<8){return t}t.newDate=this.getDateTime();break}return t};$r.prototype.setEvent=function(t){this.setUint8(t.hours);this.setUint8(t.minutes);this.setUint8(t.seconds);this.setUint8(t.event);switch(t.event){case rr:for(var e of t.power){this.setUint8(e)}break;case Vt:case je:this.setDateTime(t.newDate);break}};$r.prototype.getDemand=function(){var t=this.getUint8();var e=this.getUint8();return{date:{year:t>>1,month:t<<3&15|e>>5,date:e&31},energyType:this.getUint8(),firstIndex:this.getUint16(),count:this.getUint8(),period:this.getUint8()}};$r.prototype.setDemand=function(t){var e=t.date.year<<1|t.date.month>>3&1;var r=t.date.month<<5&224|t.date.date&31;this.setUint8(e);this.setUint8(r);this.setUint8(t.energyType);this.setUint16(t.firstIndex);this.setUint8(t.count);this.setUint8(t.period)};$r.prototype.getDayMaxDemandResponse=function(){var t=this;var e=this.getDate();var r=new Array(Nr).fill(0).map((function(){return{hours:t.getUint8(),minutes:t.getUint8(),power:t.getUint32()}}));return{date:e,power:r}};$r.prototype.setDayMaxDemandResponse=function(t){var e=this;this.setDate(t.date);t.power.forEach((function(t){e.setUint8(t.hours);e.setUint8(t.minutes);e.setUint32(t.power)}))};$r.prototype.getOperatorParametersExtended3=function(){return{pmaxMinusThreshold0:this.getUint32(),pmaxMinusThreshold1:this.getUint32(),pmaxMinusThreshold2:this.getUint32(),pmaxMinusThreshold3:this.getUint32(),relaySet:x(Qr,this.getUint8())}};$r.prototype.setOperatorParametersExtended3=function(t){var e=t.pmaxMinusThreshold0,r=t.pmaxMinusThreshold1,n=t.pmaxMinusThreshold2,i=t.pmaxMinusThreshold3,a=t.relaySet;this.setUint32(e);this.setUint32(r);this.setUint32(n);this.setUint32(i);this.setUint8(w(Qr,a))};$r.prototype.getMonthMaxPowerByTariffs=function(){var t=this;return new Array(Nr).fill(0).map((function(){return{date:t.getUint8(),hours:t.getUint8(),minutes:t.getUint8(),power:t.getUint32()}}))};$r.prototype.setMonthMaxPowerByTariffs=function(t){var e=this;t.forEach((function(t){e.setUint8(t.date);e.setUint8(t.hours);e.setUint8(t.minutes);e.setUint32(t.power)}))};var Jr=function(t){return btoa(t.map((function(t){return String.fromCharCode(t)})).join(""))};var tn=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[t,e.length].concat(f(e))};var en=0;var rn=3;var nn=1;var an=3;var sn=4;var on=5;var fn=7;var hn=8;var vn=9;var un=13;var En=15;var _n=16;var cn=17;var gn=18;var An=19;var dn=20;var ln=21;var Un=22;var pn=23;var Tn=24;var yn=25;var Rn=28;var On=30;var mn=31;var Sn=40;var Mn=41;var Pn=42;var Dn=44;var Ln=45;var Nn=46;var In=47;var Cn=49;var Fn=50;var wn=51;var xn=52;var Yn=53;var Bn=54;var Hn=57;var Gn=58;var bn=59;var Vn=60;var Wn=61;var Kn=62;var Xn=65;var jn=70;var Qn=74;var zn=75;var kn=79;var qn=80;var Zn=82;var $n=83;var Jn=88;var ti=89;var ei=91;var ri=92;var ni=93;var ii=94;var ai=100;var si=109;var oi=111;var fi=112;var hi=113;var vi=114;var ui=118;var Ei=122;var _i=Object.freeze({__proto__:null,activateRatePlan:An,getBuildVersion:fi,getCorrectTime:Kn,getCriticalEvent:Xn,getCurrentStatusMeter:Hn,getCurrentValues:un,getDateTime:fn,getDayDemand:Un,getDayDemandExport:kn,getDayMaxDemand:Cn,getDayMaxDemandExport:Jn,getDayMaxDemandPrevious:Qn,getDayProfile:bn,getDemand:ui,getDeviceId:on,getDeviceType:sn,getDisplayParam:ii,getEnergy:En,getEnergyDayPrevious:an,getEnergyExport:ei,getEnergyExportDayPrevious:qn,getEventStatus:nn,getEvents:wn,getEventsCounters:xn,getExtendedCurrentValues:Gn,getExtendedCurrentValues2:Ln,getHalfHourDemand:ln,getHalfHourDemandExport:$n,getHalfHourDemandPrevious:zn,getHalfhoursEnergies:oi,getMagneticFieldThreshold:si,getMeterInfo:Ei,getMonthDemand:pn,getMonthDemandExport:Zn,getMonthMaxDemand:Fn,getMonthMaxDemandExport:ti,getOperatorParameters:On,getOperatorParametersExtended3:hi,getRatePlanInfo:Dn,getSaldo:Mn,getSaldoParameters:Nn,getSeasonProfile:Vn,getSpecialDay:Wn,getVersion:Sn,prepareRatePlan:dn,resetPowerMaxDay:Yn,resetPowerMaxMonth:Bn,runTariffPlan:jn,setAccessKey:vn,setCorrectDateTime:ri,setCorrectTime:Rn,setDateTime:hn,setDayProfile:_n,setDisplayParam:ni,setOperatorParameters:mn,setOperatorParametersExtended3:vi,setSaldo:Pn,setSaldoParameters:In,setSeasonProfile:cn,setSpecialDay:gn,setSpecialOperation:ai,turnRelayOff:yn,turnRelayOn:Tn});mt(_i);var ci=An;var gi=1+Mr;var Ai=function(t){var e=new $r(gi);e.setUint8(t.tariffTable);e.setTariffPlan(t.tariffPlan);return tn(ci,e.data)};var di=fi;var li=function(){return tn(di)};var Ui=Kn;var pi=function(){return tn(Ui)};var Ti=0;var yi=1;var Ri=2;var Oi=3;var mi=4;var Si=5;var Mi=6;var Pi=7;var Di=8;var Li=9;var Ni=10;var Ii=11;var Ci=12;var Fi=13;var wi=14;var xi=Object.freeze({__proto__:null,CASE_MODULE_OPEN:Ni,CASE_OPEN:Ti,CASE_TERMINAL_OPEN:Li,DEVICE_FAILURE:Di,ERROR_ACCESS:Si,MAGNETIC_ON:yi,PARAMETERS_UPDATE_LOCAL:Oi,PARAMETERS_UPDATE_REMOTE:Ri,PROTECTION_RESET_EM:Fi,PROTECTION_RESET_MAGNETIC:wi,RESTART:mi,TARIFF_TABLE_GET:Ci,TARIFF_TABLE_SET:Ii,TIME_CORRECT:Pi,TIME_SET:Mi});mt(xi);var Yi=Xn;var Bi=function(t){return tn(Yi,[t.event,t.index])};var Hi=Hn;var Gi=function(){return tn(Hi)};var bi=un;var Vi=function(){return tn(bi)};var Wi=fn;var Ki=function(){return tn(Wi)};var Xi=3;var ji=4;var Qi=Un;var zi=function(t){var e=new $r(t?.energyType?ji:Xi);e.setDate(t?.date);if(t?.energyType){e.setUint8(t.energyType)}return tn(Qi,e.data)};var ki=3;var qi=4;var Zi=kn;var $i=function(t){var e=new $r(t?.energyType?qi:ki);e.setDate(t?.date);if(t?.energyType){e.setUint8(t.energyType)}return tn(Zi,e.data)};var Ji=Cn;var ta=3;var ea=function(t){var e=new $r(ta);e.setDate(t.date);return tn(Ji,e.data)};var ra=Jn;var na=3;var ia=function(t){var e=new $r(na);e.setDate(t.date);return tn(ra,e.data)};var aa=Qn;var sa=function(){return tn(aa)};var oa=bn;var fa=3;var ha=function(t){var e=new $r(fa);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return tn(oa,e.data)};var va=ui;var ua=7;var Ea=function(t){var e=new $r(ua);e.setDemand(t);return tn(va,e.data)};var _a=on;var ca=function(){return tn(_a)};var ga=sn;var Aa=function(){return tn(ga)};var da=ii;var la=1;var Ua=function(t){var e=new $r(la);e.setUint8(t.displayMode);return tn(da,e.data)};var pa=0;var Ta=1;var ya=En;var Ra=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=new $r(t?.energyType?Ta:pa);if(t?.energyType){e.setUint8(t.energyType)}return tn(ya,e.data)};var Oa=an;var ma=function(t){if(t.energyType){return tn(Oa,[t.energyType])}return tn(Oa)};var Sa=0;var Ma=1;var Pa=ei;var Da=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var e=new $r(t?.energyType?Ma:Sa);if(t?.energyType){e.setUint8(t.energyType)}return tn(Pa,e.data)};var La=qn;var Na=function(t){if(t.energyType){return tn(La,[t.energyType])}return tn(La)};var Ia=wn;var Ca=4;var Fa=function(t){var e=new $r(Ca);e.setDate(t.date);e.setUint8(t.offset);return tn(Ia,e.data)};var wa=xn;var xa=function(){return tn(wa)};var Ya=nn;var Ba=function(){return tn(Ya)};var Ha=Gn;var Ga=function(){return tn(Ha)};var ba=Ln;var Va=function(){return tn(ba)};var Wa=ln;var Ka=3;var Xa=function(t){var e=new $r(Ka);e.setDate(t.date);return tn(Wa,e.data)};var ja=$n;var Qa=3;var za=function(t){var e=new $r(Qa);e.setDate(t.date);return tn(ja,e.data)};var ka=zn;var qa=function(){return tn(ka)};var Za=4;var $a=4294967295;var Ja={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var ts=function(t){var e={};Object.keys(t).forEach((function(r){e[r]=!!t[r]}));return w(Ja,e)};var es=function(t){return t<Za?1<<t:0};var rs=function(t){return t<Za?1<<t<<4:0};var ns=function(t,e){var r=0;if(t<Za){if(e["A+"]||e["A+R+"]||e["A+R-"]){r|=es(t)}if(e["A-"]||e["A-R+"]||e["A-R-"]){r|=rs(t)}}return r};function is(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;F.call(this,t,e)}is.prototype=Object.create(F.prototype);is.prototype.constructor=is;is.prototype.getDate=function(){var t=this.getUint8();var e=this.getUint8();return{year:t>>1,month:t<<3&15|e>>5,date:e&31}};is.prototype.setDate=function(t){var e=t.year,r=t.month,n=t.date;var i=e<<1|r>>3&1;var a=r<<5&224|n&31;this.setUint8(i);this.setUint8(a)};is.prototype.getEnergiesFlags=function(){var t=this.getUint8();return x(Ja,t)};is.prototype.setEnergiesFlags=function(t){this.setUint8(ts(t))};is.prototype.getHalfhoursEnergy=function(t){var e=[];for(var r=0;r<t;r++){var n=this.getUint16();e.push(n===$a?undefined:n)}return e};is.prototype.setHalfhoursEnergy=function(t){if(t){for(var e=0;e<t.length;e++){var r=t[e];this.setUint16(r===undefined?$a:r)}}};is.prototype.getHalfhoursEnergies=function(t,e){var r={};if(t["A+"]){r["A+"]=this.getHalfhoursEnergy(e)}if(t["A+R+"]){r["A+R+"]=this.getHalfhoursEnergy(e)}if(t["A+R-"]){r["A+R-"]=this.getHalfhoursEnergy(e)}if(t["A-"]){r["A-"]=this.getHalfhoursEnergy(e)}if(t["A-R+"]){r["A-R+"]=this.getHalfhoursEnergy(e)}if(t["A-R-"]){r["A-R-"]=this.getHalfhoursEnergy(e)}return r};is.prototype.setHalfhoursEnergies=function(t){this.setHalfhoursEnergy(t["A+"]);this.setHalfhoursEnergy(t["A+R+"]);this.setHalfhoursEnergy(t["A+R-"]);this.setHalfhoursEnergy(t["A-"]);this.setHalfhoursEnergy(t["A-R+"]);this.setHalfhoursEnergy(t["A-R-"])};is.prototype.getAPlusTariffEnergies=function(t){var e={};if(t&Ja["A+"]){e["A+"]=this.getUint32()}if(t&Ja["A+R+"]){e["A+R+"]=this.getUint32()}if(t&Ja["A+R-"]){e["A+R-"]=this.getUint32()}return e};is.prototype.setAPlusTariffEnergies=function(t){if(t){if(t["A+"]){this.setUint32(t["A+"])}if(t["A+R+"]){this.setUint32(t["A+R+"])}if(t["A+R-"]){this.setUint32(t["A+R-"])}}};is.prototype.getAMinusTariffEnergies=function(t){var e={};if(t&Ja["A-"]){e["A-"]=this.getUint32()}if(t&Ja["A-R+"]){e["A-R+"]=this.getUint32()}if(t&Ja["A-R-"]){e["A-R-"]=this.getUint32()}return e};is.prototype.setAMinusTariffEnergies=function(t){if(t){if(t["A-"]){this.setUint32(t["A-"])}if(t["A-R+"]){this.setUint32(t["A-R+"])}if(t["A-R-"]){this.setUint32(t["A-R-"])}}};is.prototype.getTariffsEnergies=function(){var t=this.getUint8();var e=this.getUint8();var r=new Array(Za).fill(null);for(var n=0;n<Za;n++){if(e&es(n)){r[n]=this.getAPlusTariffEnergies(t)}}for(var i=0;i<Za;i++){if(e&rs(i)){r[i]={...r[i],...this.getAMinusTariffEnergies(t)}}}return r};is.prototype.setTariffsEnergies=function(t){var e=this;var r=0;var n=0;t.forEach((function(t,e){if(t){r|=ts(t);n|=ns(e,t)}}));this.setUint8(r);this.setUint8(n);t.forEach((function(t){return e.setAPlusTariffEnergies(t)}));t.forEach((function(t){return e.setAMinusTariffEnergies(t)}))};is.prototype.getPowerMax=function(){return{hours:this.getUint8(),minutes:this.getUint8(),power:this.getUint32()}};is.prototype.setPowerMax=function(t){if(t){var e=t.hours,r=t.minutes,n=t.power;this.setUint8(e);this.setUint8(r);this.setUint32(n)}};is.prototype.getAPlusTariffPowerMax=function(t){var e={};if(t&Ja["A+"]){e["A+"]=this.getPowerMax()}if(t&Ja["A+R+"]){e["A+R+"]=this.getPowerMax()}if(t&Ja["A+R-"]){e["A+R-"]=this.getPowerMax()}return e};is.prototype.setAPlusTariffPowerMax=function(t){if(t){this.setPowerMax(t["A+"]);this.setPowerMax(t["A+R+"]);this.setPowerMax(t["A+R+"])}};is.prototype.getAMinusTariffPowerMax=function(t){var e={};if(t&Ja["A-"]){e["A-"]=this.getPowerMax()}if(t&Ja["A-R+"]){e["A-R+"]=this.getPowerMax()}if(t&Ja["A-R-"]){e["A-R-"]=this.getPowerMax()}return e};is.prototype.setAMinusTariffPowerMax=function(t){if(t){this.setPowerMax(t["A-"]);this.setPowerMax(t["A-R+"]);this.setPowerMax(t["A-R-"])}};is.prototype.getTariffsPowerMax=function(){var t=this.getUint8();var e=this.getUint8();var r=new Array(Za).fill(null);for(var n=0;n<Za;n++){if(e&es(n)){r[n]=this.getAPlusTariffPowerMax(t)}}for(var i=0;i<Za;i++){if(e&rs(i)){r[i]={...r[i],...this.getAMinusTariffPowerMax(t)}}}return r};is.prototype.setTariffsPowerMax=function(t){var e=this;var r=0;var n=0;t.forEach((function(t,e){if(t){r|=ts(t);n|=ns(e,t)}}));this.setUint8(r);this.setUint8(n);t.forEach((function(t){return e.setAPlusTariffPowerMax(t)}));t.forEach((function(t){return e.setAMinusTariffPowerMax(t)}))};var as=oi;var ss=5;var os=function(t){var e=new is(ss);e.setDate(t.date);e.setEnergiesFlags(t.energies);e.setUint8(t.firstHalfhour);e.setUint8(t.halfhoursNumber);return tn(as,e.data)};var fs=si;var hs=function(){return tn(fs)};var vs=Ei;var us=function(){return tn(vs)};var Es=pn;var _s=2;var cs=function(t){var e=new $r(_s);e.setUint8(t.year);e.setUint8(t.month);return tn(Es,e.data)};var gs=Zn;var As=2;var ds=function(t){var e=new $r(As);e.setUint8(t.year);e.setUint8(t.month);return tn(gs,e.data)};var ls=Fn;var Us=function(t){var e=t.year,r=t.month;return tn(ls,[e,r])};var ps=ti;var Ts=function(t){var e=t.year,r=t.month;return tn(ps,[e,r])};var ys=hi;var Rs=function(){return tn(ys)};var Os=On;var ms=function(){return tn(Os)};var Ss=Dn;var Ms=function(t){return tn(Ss,[t.tariffTable])};var Ps=Mn;var Ds=function(){return tn(Ps)};var Ls=Nn;var Ns=function(){return tn(Ls)};var Is=Vn;var Cs=3;var Fs=function(t){var e=new $r(Cs);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return tn(Is,e.data)};var ws=Wn;var xs=3;var Ys=function(t){var e=new $r(xs);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setUint8(t.isActive?0:1);return tn(ws,e.data)};var Bs=Sn;var Hs=function(){return tn(Bs)};var Gs=dn;var bs=5;var Vs=function(t){var e=new $r(bs);e.setUint8(t.tariffTable);e.setUint32(t.id);return tn(Gs,e.data)};var Ws=Yn;var Ks=function(){return tn(Ws)};var Xs=Bn;var js=function(){return tn(Xs)};var Qs=jn;var zs=function(t){return tn(Qs,[t.tariffTable])};var ks=16;var qs=vn;var Zs=1+ks;var $s=function(t){var e=new $r(Zs);e.setUint8(t.accessLevel);e.setBytes(t.key);return tn(qs,e.data)};var Js=ri;var to=2;var eo=function(t){var e=new $r(to);e.setInt16(t.seconds);return tn(Js,e.data)};var ro=Rn;var no=9;var io=function(t){var e=new $r(no);e.setTimeCorrectionParameters(t);return tn(ro,e.data)};var ao=hn;var so=8;var oo=function(t){var e=new $r(so);e.setDateTime(t);return tn(ao,e.data)};var fo=8;var ho=255;var vo=_n;var uo=function(t){var e=t.periods.length<fo;var r=2+t.periods.length+ +e;var n=new $r(r);n.setUint8(t.tariffTable);n.setUint8(t.index);t.periods.forEach((function(t){n.setDayProfile(t)}));if(e){n.setUint8(ho)}return tn(vo,n.data)};var Eo=ni;var _o=function(t){return tn(Eo,[t.displayMode].concat(f(t.order)))};var co=vi;var go=17;var Ao=function(t){var e=new $r(go);e.setOperatorParametersExtended3(t);return tn(co,e.data)};var lo=mn;var Uo=Pr;var po=function(t){var e=new $r(Uo);e.setOperatorParameters(t);return tn(lo,e.data)};var To=Pn;var yo=12;var Ro=function(t){var e=new $r(yo);e.setUint8(t.date.month);e.setUint8(t.date.date);e.setUint8(t.date.hours);e.setUint8(t.date.minutes);e.setInt32(t.saldoNew);e.setInt32(t.saldoOld);return tn(To,e.data)};var Oo=In;var mo=37;var So=function(t){var e=new $r(mo);e.setSaldoParameters(t);return tn(Oo,e.data)};var Mo=cn;var Po=Lr;var Do=function(t){var e=new $r(Po);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setSeasonProfile(t);return tn(Mo,e.data)};var Lo=gn;var No=6;var Io=function(t){var e=new $r(No);e.setUint8(t.tariffTable);e.setUint8(t.index);e.setSpecialDay(t);return tn(Lo,e.data)};var Co=ai;var Fo=2;var wo=function(t){var e=new $r(Fo);var r=0;if(t.readScreensInfo){r|=128}if(t.resetElectroMagneticIndication){r|=1}if(t.resetMagneticIndication){r|=2}e.setUint8(t.type);e.setUint8(r);return tn(Co,e.data)};var xo=yn;var Yo=function(){return tn(xo)};var Bo=Tn;var Ho=function(){return tn(Bo)};var Go={encrypt:function(){},decrypt:function(){}};var bo=function(t){var e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var r=e;t.forEach((function(t){r^=t}));return r};var Vo=16;var Wo=[0];var Ko=function(t){return function(e,r){var n;var i=r.messageId,a=r.accessLevel,s=a===void 0?rn:a,o=r.aesKey;var h=e.map((function(e){if("id"in e){return t[e.id](e.parameters||{})}if("command"in e){return e.command.bytes}throw new Error("wrong command format")}));var v=s|16;var u=[i,v];var E=(n=[]).concat.apply(n,[v].concat(f(h),[Wo]));if(s!==en){var _=(E.length+1)%Vo;if(_){E=E.concat(new Array(Vo-_).fill(0))}}E=E.concat(bo(E));if(o&&s!==en){E=f(Go.encrypt(o,E))}return u.concat(E)}};var Xo={};var jo=Ko(Xo);Xo[ci]=Ai;Xo[di]=li;Xo[Ui]=pi;Xo[Yi]=Bi;Xo[Hi]=Gi;Xo[bi]=Vi;Xo[Wi]=Ki;Xo[Qi]=zi;Xo[Zi]=$i;Xo[Ji]=ea;Xo[ra]=ia;Xo[aa]=sa;Xo[oa]=ha;Xo[va]=Ea;Xo[_a]=ca;Xo[ga]=Aa;Xo[da]=Ua;Xo[ya]=Ra;Xo[Oa]=ma;Xo[Pa]=Da;Xo[La]=Na;Xo[Ia]=Fa;Xo[wa]=xa;Xo[Ya]=Ba;Xo[Ha]=Ga;Xo[ba]=Va;Xo[Wa]=Xa;Xo[ja]=za;Xo[ka]=qa;Xo[as]=os;Xo[fs]=hs;Xo[vs]=us;Xo[Es]=cs;Xo[gs]=ds;Xo[ls]=Us;Xo[ps]=Ts;Xo[ys]=Rs;Xo[Os]=ms;Xo[Ss]=Ms;Xo[Ps]=Ds;Xo[Ls]=Ns;Xo[Is]=Fs;Xo[ws]=Ys;Xo[Bs]=Hs;Xo[Gs]=Vs;Xo[Ws]=Ks;Xo[Xs]=js;Xo[Qs]=zs;Xo[qs]=$s;Xo[Js]=eo;Xo[ro]=io;Xo[ao]=oo;Xo[vo]=uo;Xo[Eo]=_o;Xo[co]=Ao;Xo[lo]=po;Xo[To]=Ro;Xo[Oo]=So;Xo[Mo]=Do;Xo[Lo]=Io;Xo[Co]=wo;Xo[xo]=Yo;Xo[Bo]=Ho;var Qo=145;var zo=30;var ko=function(t){var e=[zo,t.length+2,0,Qo].concat(f(t));return[].concat(f(e),[bo(e)])};getBase64FromBytes=Jr;toBytes=jo;setDataSegment=ko})();
//#endregion


/*
  Incoming arguments:
    * msg - JSON message payload downlink message json
    * msgType - type of message, for ex. 'ATTRIBUTES_UPDATED', 'POST_TELEMETRY_REQUEST', etc.
    * metadata - list of key-value pairs with additional data about the message
    * integrationMetadata - list of key-value pairs with additional data defined in Integration executing this converter

  Output must be an object with the following fields:
    * contentType - BINARY
    * data - payload in base64
*/

var bytes = toBytes(msg.commands);

// send nothing if not fit in a single data segment
if ( bytes.length > MAX_DATA_SEGMENT_SIZE ) {
    bytes = [];
} else {
    bytes = setDataSegment(bytes);
}

var result = {
    contentType: 'BINARY',
    data: getBase64FromBytes(bytes)
};

return result;
