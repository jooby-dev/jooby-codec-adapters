// IMPORTANT!!!
// This example only for default downlink data converter.
// Data converters for other integrations use different input and result.
// Find example of uplink data converter for your integration and edit usage of payload and result
// Integrations list: https://thingsboard.io/docs/user-guide/integrations/

// encoded message should be less than this size
// to be able to send to a device
var MAX_DATA_SEGMENT_SIZE = 50;


//#region [autogenerated jooby-codec bundle from index.js]
var toBytes,setDataSegment,getBase64FromBytes;(function(){"use strict";function t(t,r){(null==r||r>t.length)&&(r=t.length);for(var e=0,a=Array(r);e<r;e++)a[e]=t[e];return a}function r(r){if(Array.isArray(r))return t(r)}function e(t,r,e){return(r=E(r))in t?Object.defineProperty(t,r,{value:e,enumerable:true,configurable:true,writable:true}):t[r]=e,t}function a(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t){return r(t)||a(t)||s(t)||n()}function v(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var a=e.call(t,r);if("object"!=typeof a)return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function E(t){var r=v(t,"string");return"symbol"==typeof r?r:r+""}function s(r,e){if(r){if("string"==typeof r)return t(r,e);var a={}.toString.call(r).slice(8,-1);return"Object"===a&&r.constructor&&(a=r.constructor.name),"Map"===a||"Set"===a?Array.from(r):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?t(r,e):void 0}}var _=1;var o=2;var f=3;var u=4;var T=Math.log,A=Math.pow,R=Math.LN2;var O=function(t,r,e,a,n){var i,v,E=n*8-a-1,s=(1<<E)-1,_=s>>1,o=-7,f=e?n-1:0,u=e?-1:1,T=t[r+f];f+=u;i=T&(1<<-o)-1;T>>=-o;o+=E;for(;o>0;i=i*256+t[r+f],f+=u,o-=8);v=i&(1<<-o)-1;i>>=-o;o+=a;for(;o>0;v=v*256+t[r+f],f+=u,o-=8);if(i===0){i=1-_}else if(i===s){return v?NaN:T?-Infinity:Infinity}else{v=v+A(2,a);i=i-_}return(T?-1:1)*v*A(2,i-a)};var d=function(t,r,e,a,n,i){var v,E,s,_=i*8-n-1,o=(1<<_)-1,f=o>>1,u=n===23?A(2,-24)-A(2,-77):0,O=a?0:i-1,d=a?1:-1,c=e<0||e===0&&1/e<0?1:0;e<0&&(e=-e);if(e!==e||e===Infinity){E=e!==e?1:0;v=o}else{v=T(e)/R|0;if(e*(s=A(2,-v))<1){v--;s*=2}if(v+f>=1){e+=u/s}else{e+=u*A(2,1-f)}if(e*s>=2){v++;s/=2}if(v+f>=o){E=0;v=o}else if(v+f>=1){E=(e*s-1)*A(2,n);v=v+f}else{E=e*A(2,f-1)*A(2,n);v=0}}for(;n>=8;t[r+O]=E&255,O+=d,E/=256,n-=8);v=v<<n|E;_+=n;for(;_>0;t[r+O]=v&255,O+=d,v/=256,_-=8);t[r+O-d]|=c*128};var c=[1,0];var l=[2,1,0];var N=[3,2,1,0];var U=[0,1];var h=[0,1,2];var S=[0,1,2,3];var L=function(t,r){return t[r]};var D=function(t,r,e){var a=e?U:c;var n=t[r+a[0]];var i=t[r+a[1]]<<8;return n|i};var I=function(t,r,e){var a=e?h:l;var n=t[r+a[0]];var i=t[r+a[1]]<<8;var v=t[r+a[2]]<<16;return n|i|v};var g=function(t,r,e){var a=e?S:N;var n=t[r+a[3]]*16777216;var i=t[r+a[2]]*65536;var v=t[r+a[1]]*256;var E=t[r+a[0]];return n+i+v+E};var C=function(t,r,e){t[r]=e&255};var P=function(t,r,e,a){var n=a?U:c;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255};var M=function(t,r,e,a){var n=a?h:l;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255;t[r+n[2]]=e>>>16&255};var y=function(t,r,e,a){var n=a?S:N;t[r+n[0]]=e&255;t[r+n[1]]=e>>>8&255;t[r+n[2]]=e>>>16&255;t[r+n[3]]=e>>>24&255};function m(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;if(typeof t==="number"){var e=new Array(t).fill(0);this.data=e}else{this.data=t}this.offset=0;this.isLittleEndian=r}m.prototype={toUint8Array:function(){return this.data},seek:function(t){if(t<0||t>=this.data.length){throw new Error("Invalid position.")}this.offset=t},setInt8:function(t){C(this.data,this.offset,t<0?t|256:t);this.offset+=_},getInt8:function(){var t=L(this.data,this.offset);this.offset+=_;return t&128?t^-256:t},setUint8:function(t){C(this.data,this.offset,t);this.offset+=_},getUint8:function(){var t=L(this.data,this.offset);this.offset+=_;return t},setInt16:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;P(this.data,this.offset,t<0?t|65536:t,r);this.offset+=o},getInt16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=D(this.data,this.offset,t);this.offset+=o;return r&32768?r^-65536:r},setUint16:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;P(this.data,this.offset,t,r);this.offset+=o},getUint16:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=D(this.data,this.offset,t);this.offset+=o;return r},setInt24:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;M(this.data,this.offset,t<0?t|16777216:t,r);this.offset+=f},getInt24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=I(this.data,this.offset,t);this.offset+=f;return r&8388608?r^-16777216:r},setUint24:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;M(this.data,this.offset,t,r);this.offset+=f},getUint24:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=I(this.data,this.offset,t);this.offset+=f;return r},setInt32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;y(this.data,this.offset,t<0?t|4294967296:t,r);this.offset+=u},getInt32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=g(this.data,this.offset,t);this.offset+=u;return r&2147483648?r^-4294967296:r},setUint32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;y(this.data,this.offset,t,r);this.offset+=u},getUint32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=g(this.data,this.offset,t);this.offset+=u;return r},setFloat32:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.isLittleEndian;d(this.data,this.offset,t,r,23,4);this.offset+=u},getFloat32:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.isLittleEndian;var r=O(this.data,this.offset,t,23,4);this.offset+=u;return r},setString:function(t){this.setUint8(t.length);for(var r=0;r<t.length;++r){this.setUint8(t.charCodeAt(r))}},getString:function(){var t=this.getUint8();var r=this.offset+t;var e=[];while(this.offset<r){e.push(String.fromCharCode(this.getUint8()))}return e.join("")},getBytesToOffset:function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.offset;return this.data.slice(0,t)},getBytesLeft:function(){return this.getBytes(this.bytesLeft)},getBytes:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;this.offset=r+t;return this.data.slice(r,this.offset)},setBytes:function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.offset;var e=this.data;e.splice.apply(e,[r,t.length].concat(i(t)));this.data=e;this.offset=r+t.length}};Object.defineProperties(m.prototype,{size:{get:function(){return this.data.length}},isEmpty:{get:function(){if(this.offset>this.data.length){throw new Error("current offset ".concat(this.offset," is outside the bounds of the buffer"))}return this.data.length-this.offset===0}},bytesLeft:{get:function(){return this.data.length-this.offset}},position:{get:function(){return this.offset}}});var F=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var e=0;for(var a in r){if(a in t&&r[a]){e|=t[a]}}return e};var p=function(t,r,e,a){var n=(1<<r)-1<<e-1;var i=a;var v=t;v&=~n;i<<=e-1;v|=i;return v};var Y=80;var H=81;var G=82;var B=83;var V=84;var w=85;var x=86;var b=87;var W=88;var K=89;var X=90;var j=91;var z=255;var Q=Object.freeze({__proto__:null,DATA_REQUEST:Y,DATA_RESPONSE:H,FRAGMENT_REQUEST:X,FRAGMENT_RESPONSE:j,IDENT_REQUEST:G,IDENT_RESPONSE:B,INVALID:z,L2_CHECK_ADDRESS_REQUEST:x,L2_CHECK_ADDRESS_RESPONSE:b,L2_RM_ADDRESS_REQUEST:W,L2_RM_ADDRESS_RESPONSE:K,L2_SET_ADDRESS_REQUEST:V,L2_SET_ADDRESS_RESPONSE:w});var Z=function(t){var r={};for(var e in t){var a=t[e];r[a]=e}return r};Z(Q);var k=0;var q=1;var $=2;var J=3;var tt=Object.freeze({__proto__:null,READ_ONLY:J,READ_WRITE:$,ROOT:q,UNENCRYPTED:k});Z(tt);var rt=0;var et=1;var at=2;var nt=3;var it=4;var vt=5;var Et=6;var st=7;var _t=8;var ot=9;var ft=10;var ut=11;var Tt=12;var At=13;var Rt=14;var Ot=Object.freeze({__proto__:null,CASE_MODULE_OPEN:ft,CASE_OPEN:rt,CASE_TERMINAL_OPEN:ot,DEVICE_FAILURE:_t,ERROR_ACCESS:vt,MAGNETIC_ON:et,PARAMETERS_UPDATE_LOCAL:nt,PARAMETERS_UPDATE_REMOTE:at,PROTECTION_RESET_EM:At,PROTECTION_RESET_MAGNETIC:Rt,RESTART:it,TARIFF_TABLE_GET:Tt,TARIFF_TABLE_SET:ut,TIME_CORRECT:st,TIME_SET:Et});Z(Ot);var dt=1;var ct=3;var lt=4;var Nt=5;var Ut=7;var ht=8;var St=9;var Lt=13;var Dt=15;var It=16;var gt=17;var Ct=18;var Pt=19;var Mt=20;var yt=21;var mt=22;var Ft=23;var pt=24;var Yt=25;var Ht=28;var Gt=30;var Bt=31;var Vt=40;var wt=41;var xt=42;var bt=44;var Wt=45;var Kt=46;var Xt=47;var jt=49;var zt=50;var Qt=51;var Zt=52;var kt=53;var qt=54;var $t=57;var Jt=58;var tr=59;var rr=60;var er=61;var ar=62;var nr=65;var ir=70;var vr=74;var Er=75;var sr=79;var _r=80;var or=82;var fr=83;var ur=88;var Tr=89;var Ar=91;var Rr=92;var Or=93;var dr=94;var cr=100;var lr=109;var Nr=111;var Ur=112;var hr=113;var Sr=114;var Lr=116;var Dr=117;var Ir=118;var gr=122;var Cr=Object.freeze({__proto__:null,activateRatePlan:Pt,getBv:Ur,getCorrectTime:ar,getCriticalEvent:nr,getCurrentStatusMeter:$t,getCurrentValues:Lt,getDateTime:Ut,getDayDemand:mt,getDayDemandExport:sr,getDayMaxDemand:jt,getDayMaxDemandExport:ur,getDayMaxDemandPrevious:vr,getDayProfile:tr,getDemand:Ir,getDemandParameters:Dr,getDeviceId:Nt,getDeviceType:lt,getDisplayParam:dr,getEnergy:Dt,getEnergyDayPrevious:ct,getEnergyExport:Ar,getEnergyExportDayPrevious:_r,getEventStatus:dt,getEvents:Qt,getEventsCounters:Zt,getExtendedCurrentValues:Jt,getExtendedCurrentValues2:Wt,getHalfHourDemand:yt,getHalfHourDemandExport:fr,getHalfHourDemandPrevious:Er,getHalfHourEnergies:Nr,getMagneticFieldThreshold:lr,getMeterInfo:gr,getMonthDemand:Ft,getMonthDemandExport:or,getMonthMaxDemand:zt,getMonthMaxDemandExport:Tr,getOperatorParameters:Gt,getOperatorParametersExtended3:hr,getRatePlanInfo:bt,getSaldo:wt,getSaldoParameters:Kt,getSeasonProfile:rr,getSpecialDay:er,getVersion:Vt,prepareRatePlan:Mt,resetPowerMaxDay:kt,resetPowerMaxMonth:qt,runTariffPlan:ir,setAccessKey:St,setCorrectDateTime:Rr,setCorrectTime:Ht,setDateTime:ht,setDayProfile:It,setDemandParameters:Lr,setDisplayParam:Or,setOperatorParameters:Bt,setOperatorParametersExtended3:Sr,setSaldo:xt,setSaldoParameters:Xt,setSeasonProfile:gt,setSpecialDay:Ct,setSpecialOperation:cr,turnRelayOff:Yt,turnRelayOn:pt});Z(Cr);var Pr=1;var Mr=2;var yr=3;var mr=16;var Fr=17;var pr=18;var Yr=19;var Hr=20;var Gr=21;var Br=32;var Vr=33;var wr=34;var xr=35;var br=36;var Wr=37;var Kr=38;var Xr=39;var jr=40;var zr=41;var Qr=49;var Zr=50;var kr=51;var qr=52;var $r=53;var Jr=54;var te=55;var re=56;var ee=57;var ae=58;var ne=59;var ie=64;var ve=65;var Ee=66;var se=67;var _e=68;var oe=69;var fe=70;var ue=71;var Te=72;var Ae=73;var Re=74;var Oe=75;var de=76;var ce=77;var le=78;var Ne=79;var Ue=80;var he=81;var Se=82;var Le=83;var De=84;var Ie=85;var ge=86;var Ce=87;var Pe=88;var Me=89;var ye=96;var me=97;var Fe=98;var pe=99;var Ye=100;var He=101;var Ge=102;var Be=103;var Ve=104;var we=105;var xe=112;var be=113;var We=114;var Ke=115;var Xe=116;var je=117;var ze=118;var Qe=119;var Ze=120;var ke=121;var qe=122;var $e=123;var Je=124;var ta=125;var ra=144;var ea=145;var aa=147;var na=148;var ia=152;var va=156;var Ea=157;var sa=158;var _a=159;var oa=160;var fa=161;var ua=162;var Ta=176;var Aa=177;var Ra=178;var Oa=179;var da=180;var ca=181;var la=182;var Na=183;var Ua=185;var ha=186;var Sa=224;var La=225;var Da=226;var Ia=227;var ga=228;var Ca=229;var Pa=230;var Ma=231;var ya=232;var ma=Object.freeze({__proto__:null,ACCESS_ERROR:Fr,ACCESS_LOCKED:mr,ACC_PARAMETERS_EXT_FAULT:Ke,ACC_PARAMETERS_FAULT:We,BAD_TEST_EEPROM:Ve,BAD_TEST_FRAM:we,BATTERY_FAULT:Le,BATTERY_OK:Se,BIPOLAR_POWER_FAULT:da,BIPOLAR_POWER_OK:ca,BLOCK_TARIFF_FAULT:je,CALC_PERIOD_FAULT:Xe,CALIBRATION_FAULT:Ie,CALIBRATION_FLAG_RESET:Be,CALIBRATION_FLAG_SET:Ge,CALIBRATION_OK:De,CALIBRATION_PARAMETERS_FAULT:ze,CASE_CLOSED:Yr,CASE_MODULE_CLOSED:ta,CASE_MODULE_OPENED:Je,CASE_OPENED:pr,CASE_TERMINAL_BOX_CLOSED:$e,CASE_TERMINAL_BOX_OPENED:qe,CHANGE_ACCESS_KEY0:Br,CHANGE_ACCESS_KEY1:Vr,CHANGE_ACCESS_KEY2:wr,CHANGE_ACCESS_KEY3:xr,CHANGE_COR_TIME:zr,CHANGE_PARAMETERS_CHANNEL:Ua,CHANGE_PARAMETERS_LOCAL:br,CHANGE_PARAMETERS_REMOTE:Wr,CHANGE_TARIFF_TABLE:Zr,CHANGE_TARIFF_TABLE_2:ia,CLOCK_FAULT:Ce,CLOCK_OK:ge,CMD_RELAY_2_OFF:me,CMD_RELAY_2_ON:ye,CMD_RELAY_OFF:jr,CMD_RELAY_ON:Xr,CMD_SET_DATETIME:Kr,COSF_MIN_OVER:ne,COSF_OK:ae,CROSS_ZERO_EN_T1:Fe,CROSS_ZERO_EN_T2:pe,CROSS_ZERO_EN_T3:Ye,CROSS_ZERO_EN_T4:He,CROSS_ZERO_EXPORT_EN_T1:sa,CROSS_ZERO_EXPORT_EN_T2:_a,CROSS_ZERO_EXPORT_EN_T3:oa,CROSS_ZERO_EXPORT_EN_T4:fa,CURRENT_UNEQUAL_FAULT:Ra,CURRENT_UNEQUAL_OK:Oa,EM_MAGNETIC_INFLUENCE_OFF:Aa,EM_MAGNETIC_INFLUENCE_ON:Ta,ENERGY_REGISTER_FAULT:Pr,ENERGY_REGISTER_OVERFLOW:Qr,F_MAX_OK:Te,F_MAX_OVER:Ae,F_MIN_OK:Re,F_MIN_OVER:Oe,I_MAX_OK:de,I_MAX_OVER:ce,MAGNETIC_INFLUENCE_OFF:Gr,MAGNETIC_INFLUENCE_ON:Hr,OPERATOR_PARAMETERS_VALUES_FAULT:yr,POWER_A_OFF:Pe,POWER_A_ON:Me,POWER_OVER_RELAY_OFF:Ea,POWER_SALDO_OK:Ue,POWER_SALDO_OVER:he,P_MAX_A_MINUS_OK:Ma,P_MAX_A_MINUS_OVER:ya,P_MAX_OK:le,P_MAX_OVER:Ne,RELAY_HARD_BAD_OFF:ra,RELAY_HARD_BAD_ON:aa,RELAY_HARD_OFF:na,RELAY_HARD_ON:ea,RELAY_OFF:te,RELAY_OFF_BAD_SALDO:ha,RELAY_ON:Jr,RESET_EM_FLAG:la,RESET_MAGNET_FLAG:Na,RESTART:re,SALDO_EN_FAULT:Ze,SALDO_PARAMETERS_FAULT:be,SET_DEMAND_EN_10MIN:Ia,SET_DEMAND_EN_15MIN:ga,SET_DEMAND_EN_1MIN:Sa,SET_DEMAND_EN_30MIN:Ca,SET_DEMAND_EN_3MIN:La,SET_DEMAND_EN_5MIN:Da,SET_DEMAND_EN_60MIN:Pa,SET_NEW_SALDO:xe,SET_SALDO_PARAM:va,SET_TARIFF_TABLE:kr,SUMMER_TIME:qr,TIME_CORRECT:ke,TIME_CORRECT_NEW:ua,T_MAX_OK:_e,T_MAX_OVER:oe,T_MIN_OK:fe,T_MIN_OVER:ue,VENDOR_PAR_FAULT:Mr,V_MAX_OK:ie,V_MAX_OVER:ve,V_MIN_OK:Ee,V_MIN_OVER:se,WATCHDOG_RESTART:ee,WINTER_SUMMER_FAULT:Qe,WINTER_TIME:$r});Z(ma);var Fa=0;var pa=128;var Ya=129;var Ha=130;var Ga=131;var Ba=132;var Va=133;var wa=134;var xa=135;var ba=136;var Wa=137;var Ka=144;var Xa=145;var ja=146;var za=147;var Qa=149;var Za=151;var ka=152;var qa=153;var $a=154;var Ja=155;var tn=156;var rn=159;var en=160;var an=240;var nn=Object.freeze({__proto__:null,ACCESS_DENIED:za,BAD_ARRAY_INDEX:wa,BAD_BLOCK_NUMBER:tn,BAD_DATA_LENGTH:Va,BAD_MESSAGE:Ba,BAD_RATE_PLAN_ID:ba,BAD_RATE_PLAN_SIZE:Wa,BAD_RESPONSE_LENGTH:Ka,BAD_SALDO_WRITE:Qa,BLOCKED_METER:Za,CALIBRATION_DISABLED:ja,DECRYPTION_FAILURE:Ha,INTERNAL:an,INVALID_CORRECTION_INTERVAL:$a,NOT_ALIGNED_DATA:Ya,NOT_PREPARED_RATE_PLAN:xa,NO_DATA_FOR_DATE:Xa,OK:Fa,OUT_OFF_RANGE:rn,SET_METER_TYPE_FAILURE:en,TIME_CORRECTION_FAILURE:qa,TIME_CORRECTION_OUT_HALF_HOUR_DISABLED:Ja,UNENCRYPTED_COMMAND_DISABLED:ka,UNKNOWN_COMMAND:pa,UNKNOWN_PROTOCOL:Ga});Z(nn);var vn=1;var En=2;var sn=3;var _n=4;var on=5;var fn=6;var un=7;var Tn=8;var An=9;var Rn=10;var On=11;var dn=12;var cn=13;var ln=14;var Nn=15;var Un=16;var hn=17;var Sn=18;var Ln=19;var Dn=20;var In=21;var gn=22;var Cn=23;var Pn=24;var Mn=25;var yn=26;var mn=28;var Fn=30;var pn=31;var Yn=Object.freeze({__proto__:null,ACTIVE_ENERGY_T1:_n,ACTIVE_ENERGY_T2:on,ACTIVE_ENERGY_T3:fn,ACTIVE_ENERGY_T4:un,ACTIVE_POWER_IN_NEUTRAL:An,ACTIVE_POWER_PER_PHASE:Tn,BATTERY_VOLTAGE:gn,CURRENT_BALANCE:Fn,CURRENT_IN_NEUTRAL:On,CURRENT_IN_PHASE:Rn,DATE_MONTH_YEAR:ln,EXPORTED_ACTIVE_ENERGY_T1:Un,EXPORTED_ACTIVE_ENERGY_T2:hn,EXPORTED_ACTIVE_ENERGY_T3:Sn,EXPORTED_ACTIVE_ENERGY_T4:Ln,HOUR_MINUTE_SECOND:cn,MAGNET_INDUCTION:mn,OPTOPORT_SPEED:pn,POWER_FACTOR_PHASE_A:Dn,POWER_FACTOR_PHASE_B:In,POWER_THRESHOLD_T1:Cn,POWER_THRESHOLD_T2:Pn,POWER_THRESHOLD_T3:Mn,POWER_THRESHOLD_T4:yn,SET_ALL_SEGMENT_DISPLAY:vn,SOFTWARE_VERSION:En,TOTAL_ACTIVE_ENERGY:sn,TOTAL_EXPORTED_ACTIVE_ENERGY:Nn,VOLTAGE:dn});Z(Yn);var Hn=120;var Gn=121;var Bn=254;var Vn=255;var wn=Object.freeze({__proto__:null,activateRatePlan:Pt,errorDataFrameResponse:Vn,errorResponse:Bn,getBv:Ur,getCorrectTime:ar,getCriticalEvent:nr,getCurrentStatusMeter:$t,getCurrentValues:Lt,getDateTime:Ut,getDayDemand:mt,getDayDemandExport:sr,getDayEnergies:Hn,getDayMaxDemand:jt,getDayMaxDemandExport:ur,getDayMaxDemandPrevious:vr,getDayMaxPower:Gn,getDayProfile:tr,getDemand:Ir,getDemandParameters:Dr,getDeviceId:Nt,getDeviceType:lt,getDisplayParam:dr,getEnergy:Dt,getEnergyDayPrevious:ct,getEnergyExport:Ar,getEnergyExportDayPrevious:_r,getEventStatus:dt,getEvents:Qt,getEventsCounters:Zt,getExtendedCurrentValues:Jt,getExtendedCurrentValues2:Wt,getHalfHourDemand:yt,getHalfHourDemandExport:fr,getHalfHourDemandPrevious:Er,getHalfHourEnergies:Nr,getMagneticFieldThreshold:lr,getMeterInfo:gr,getMonthDemand:Ft,getMonthDemandExport:or,getMonthMaxDemand:zt,getMonthMaxDemandExport:Tr,getOperatorParameters:Gt,getOperatorParametersExtended3:hr,getRatePlanInfo:bt,getSaldo:wt,getSaldoParameters:Kt,getSeasonProfile:rr,getSpecialDay:er,getVersion:Vt,prepareRatePlan:Mt,resetPowerMaxDay:kt,resetPowerMaxMonth:qt,runTariffPlan:ir,setAccessKey:St,setCorrectDateTime:Rr,setCorrectTime:Ht,setDateTime:ht,setDayProfile:It,setDemandParameters:Lr,setDisplayParam:Or,setOperatorParameters:Bt,setOperatorParametersExtended3:Sr,setSaldo:xt,setSaldoParameters:Xt,setSeasonProfile:gt,setSpecialDay:Ct,setSpecialOperation:cr,turnRelayOff:Yt,turnRelayOn:pt});Z(wn);var xn=2400;var bn=9600;var Wn={rs485orTwi:{0:bn,2:xn,4:bn},optoport:{0:xn,2:xn,4:bn}};var Kn={rs485orTwi:Z(Wn.rs485orTwi),optoport:Z(Wn.optoport)};var Xn=11;var jn=74;var zn=7;var Qn=2+zn;var Zn={SET_ALL_SEGMENT_DISPLAY:1,SOFTWARE_VERSION:2,TOTAL_ACTIVE_ENERGY:4,ACTIVE_ENERGY_T1:8,ACTIVE_ENERGY_T2:16,ACTIVE_ENERGY_T3:32,ACTIVE_ENERGY_T4:64,ACTIVE_POWER_PER_PHASE:128,ACTIVE_POWER_IN_NEUTRAL:256,CURRENT_IN_PHASE:512,CURRENT_IN_NEUTRAL:1024,VOLTAGE:2048,HOUR_MINUTE_SECOND:4096,DATE_MONTH_YEAR:8192,TOTAL_EXPORTED_ACTIVE_ENERGY:16384,EXPORTED_ACTIVE_ENERGY_T1:32768,EXPORTED_ACTIVE_ENERGY_T2:65536,EXPORTED_ACTIVE_ENERGY_T3:131072,EXPORTED_ACTIVE_ENERGY_T4:262144,POWER_FACTOR_PHASE_A:524288,POWER_FACTOR_PHASE_B:1048576,BATTERY_VOLTAGE:2097152,POWER_THRESHOLD_T1:4194304,POWER_THRESHOLD_T2:8388608,POWER_THRESHOLD_T3:16777216,POWER_THRESHOLD_T4:33554432,CURRENT_BALANCE:536870912};var kn={...Zn,AUTO_SCREEN_SCROLLING:2147483648};var qn={...Zn,MAGNET_INDUCTION:134217728,OPTOPORT_SPEED:1073741824,SORT_DISPLAY_SCREENS:2147483648};var $n={RELAY_ON_Y:1,RELAY_ON_CENTER:2,RELAY_ON_PB:4,RELAY_ON_TARIFF_1:8,RELAY_ON_TARIFF_2:16,RELAY_ON_TARIFF_3:32,RELAY_ON_TARIFF_4:64,RELAY_ON_V_GOOD:128};var Jn={RELAY_OFF_Y:1,RELAY_OFF_CENTER:2,RELAY_OFF_TARIFF_1:4,RELAY_OFF_TARIFF_2:8,RELAY_OFF_TARIFF_3:16,RELAY_OFF_TARIFF_4:32,RELAY_OFF_I_LIMIT:64,RELAY_OFF_V_BAD:128};var ti={RELAY_OFF_LIM_TARIFF_1:2,RELAY_OFF_LIM_TARIFF_2:4,RELAY_OFF_LIM_TARIFF_3:8,RELAY_OFF_LIM_TARIFF_4:16,RELAY_OFF_PF_MIN:32};var ri={RELAY_ON_TIMEOUT:1,RELAY_ON_SALDO:2,RELAY_OFF_SALDO:4,RELAY_OFF_SALDO_SOFT:8,RELAY_OFF_MAGNET:16,RELAY_ON_MAGNET_TIMEOUT:32,RELAY_ON_MAGNET_AUTO:64};var ei={RELAY_OFF_UNEQUAL_CURRENT:1,RELAY_ON_UNEQUAL_CURRENT:2,RELAY_OFF_BIPOLAR_POWER:4,RELAY_ON_BIPOLAR_POWER:8};var ai={BLOCK_KEY_OPTOPORT:2,MAGNET_SCREEN_CONST:32};var ni={RELAY_OFF_LIMIT_P_MINUS_T1:8,RELAY_OFF_LIMIT_P_MINUS_T2:16,RELAY_OFF_LIMIT_P_MINUS_T3:32,RELAY_OFF_LIMIT_P_MINUS_T4:64};var ii=function(t){var r=0;r=p(r,4,1,Number(Kn.rs485orTwi[t.rs485orTwi]));r=p(r,4,5,Number(Kn.optoport[t.optoport]));return r};var vi=function(t){var r=0;r=p(r,2,1,t.tariff);r=p(r,1,3,+!t.isFirstHalfHour);r=p(r,5,4,t.hour);return r};var Ei=function(t,r){t.setUint8(r.isSummerTime?1:0);t.setUint8(r.seconds);t.setUint8(r.minutes);t.setUint8(r.hours);t.setUint8(r.day||0);t.setUint8(r.date);t.setUint8(r.month);t.setUint8(r.year)};var si=function(t,r){t.setUint32(r.id);t.setUint8(r.tariffSet);t.setUint8(r.activateYear);t.setUint8(r.activateMonth);t.setUint8(r.activateDay);t.setUint8(r.specialProfilesArraySize);t.setUint8(r.seasonProfilesArraySize);t.setUint8(r.dayProfilesArraySize)};var _i=function(t,r){t.setUint8(r.monthTransitionSummer);t.setUint8(r.dateTransitionSummer);t.setUint8(r.hoursTransitionSummer);t.setUint8(r.hoursCorrectSummer);t.setUint8(r.monthTransitionWinter);t.setUint8(r.dateTransitionWinter);t.setUint8(r.hoursTransitionWinter);t.setUint8(r.hoursCorrectWinter);t.setUint8(+r.isCorrectionNeeded)};var oi=function(t,r){t.setUint8(vi(r))};var fi=function(t,r){t.setUint8(r.month);t.setUint8(r.date);r.dayIndexes.forEach(function(r){return t.setUint8(r)})};var ui=function(t,r){t.setUint8(r.month);t.setUint8(r.date);t.setUint8(r.dayIndex);t.setUint8(r.year)};var Ti=function(t,r){var e=r.timeCorrectPeriod|(r.timeCorrectPassHalfhour?128:0);t.setUint32(r.vpThreshold);t.setUint32(r.vThreshold);t.setUint32(r.ipThreshold);t.setUint32(r.pmaxThreshold0);t.setUint32(r.pmaxThreshold1);t.setUint32(r.pmaxThreshold2);t.setUint32(r.pmaxThreshold3);t.setUint8(ii(r.serialPortsSpeed));t.setUint8(r.tint);t.setUint8(r.calcPeriodDate);t.setUint8(r.timeoutDisplay);t.setUint8(r.timeoutScreen);t.setUint32(F(kn,r.displaySet));t.setUint8(F(ri,r.relaySet4));t.setUint8(F(ti,r.relaySet3));t.setUint8(F(Jn,r.relaySet2));t.setUint8(F($n,r.relaySet1));t.setUint8(r.displayType);t.setUint8(r.ten);t.setUint16(r.timeoutRefresh);t.setUint8(r.deltaCorMin);t.setUint8(r.timeoutMagnetOff);t.setUint8(r.timeoutMagnetOn);t.setUint8(F(ai,r.define1));t.setUint8(r.timeoutRelayOn);t.setUint8(r.timeoutRelayKey);t.setUint8(r.timeoutRelayAuto);t.setUint8(r.timeoutBadVAVB);t.setUint8(r.freqMax);t.setUint8(r.freqMin);t.setUint16(r.phMin);t.setUint8(r.year);t.setUint8(r.month);t.setUint8(r.date);t.setUint8(r.energyDecimalPoint);t.setUint8(r.typeMeter);t.setUint8(r.timeoutIMax);t.setUint8(r.timeoutPMax);t.setUint8(r.timeoutCos);t.setUint8(r.pMaxDef);t.setUint32(F(qn,r.displaySetExt));t.setUint8(r.timeoutUneqCurrent);t.setUint8(r.timeoutBipolarPower);t.setUint8(F(ei,r.relaySet5));t.setUint8(e)};var Ai=function(t,r){t.setUint8(r.year);t.setUint8(r.month);t.setUint8(r.date)};var Ri=function(t,r){r.coefficients.forEach(function(r){return t.setUint32(r)});t.setUint8(r.decimalPointTariff);t.setInt32(r.indicationThreshold);t.setInt32(r.relayThreshold);t.setUint8(r.mode);t.setUint8(r.saldoOffTimeBegin);t.setUint8(r.saldoOffTimeEnd);t.setUint8(r.decimalPointIndication);t.setUint32(r.powerThreshold);t.setInt32(r.creditThreshold)};var Oi=function(t,r){var e=r.date.year<<1|r.date.month>>3&1;var a=r.date.month<<5&224|r.date.date&31;t.setUint8(e);t.setUint8(a);t.setUint8(r.demandType);t.setUint16(r.firstIndex);t.setUint8(r.count);t.setUint8(r.period)};var di=function(t,r){t.setUint8(r.channelParam1);t.setUint8(r.counterInterval);t.setUint8(r.channelParam2);t.setUint8(0)};var ci=function(t,r){var e=r.pmaxMinusThreshold0,a=r.pmaxMinusThreshold1,n=r.pmaxMinusThreshold2,i=r.pmaxMinusThreshold3,v=r.relaySet;t.setUint32(e);t.setUint32(a);t.setUint32(n);t.setUint32(i);t.setUint8(F(ni,v))};var li=function(t){return btoa(t.map(function(t){return String.fromCharCode(t)}).join(""))};var Ni=function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];return[t,r.length].concat(i(r))};var Ui=Pt;var hi=1+Xn;var Si=function(t){var r=new m(hi,false);r.setUint8(t.tariffTable);si(r,t.tariffPlan);return Ni(Ui,r.data)};var Li=Ur;var Di=function(){return Ni(Li)};var Ii=ar;var gi=function(){return Ni(Ii)};var Ci=nr;var Pi=function(t){return Ni(Ci,[t.event,t.index])};var Mi=$t;var yi=function(){return Ni(Mi)};var mi=Lt;var Fi=function(){return Ni(mi)};var pi=Ut;var Yi=function(){return Ni(pi)};var Hi=3;var Gi=4;var Bi=mt;var Vi=function(t){var r=new m(t?.energyType?Gi:Hi);Ai(r,t?.date);if(t?.energyType){r.setUint8(t.energyType)}return Ni(Bi,r.data)};var wi=3;var xi=4;var bi=sr;var Wi=function(t){var r=new m(t?.energyType?xi:wi,false);Ai(r,t?.date);if(t?.energyType){r.setUint8(t.energyType)}return Ni(bi,r.data)};var Ki=jt;var Xi=3;var ji=function(t){var r=new m(Xi,false);Ai(r,t.date);return Ni(Ki,r.data)};var zi=ur;var Qi=3;var Zi=function(t){var r=new m(Qi,false);Ai(r,t.date);return Ni(zi,r.data)};var ki=vr;var qi=function(){return Ni(ki)};var $i=tr;var Ji=3;var tv=function(t){var r=new m(Ji,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return Ni($i,r.data)};var rv=Ir;var ev=7;var av=function(t){var r=new m(ev,false);Oi(r,t);return Ni(rv,r.data)};var nv=Dr;var iv=function(){return Ni(nv)};var vv=Nt;var Ev=function(){return Ni(vv)};var sv=lt;var _v=function(){return Ni(sv)};var ov=dr;var fv=1;var uv=function(t){var r=new m(fv,false);r.setUint8(t.displayMode);return Ni(ov,r.data)};var Tv=0;var Av=1;var Rv=Dt;var Ov=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=new m(t?.energyType?Av:Tv,false);if(t?.energyType){r.setUint8(t.energyType)}return Ni(Rv,r.data)};var dv=ct;var cv=function(t){if(t.energyType){return Ni(dv,[t.energyType])}return Ni(dv)};var lv=0;var Nv=1;var Uv=Ar;var hv=function(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var r=new m(t?.energyType?Nv:lv,false);if(t?.energyType){r.setUint8(t.energyType)}return Ni(Uv,r.data)};var Sv=_r;var Lv=function(t){if(t.energyType){return Ni(Sv,[t.energyType])}return Ni(Sv)};var Dv=Qt;var Iv=4;var gv=function(t){var r=new m(Iv,false);Ai(r,t.date);r.setUint8(t.offset);return Ni(Dv,r.data)};var Cv=Zt;var Pv=function(){return Ni(Cv)};var Mv=dt;var yv=function(){return Ni(Mv)};var mv=Jt;var Fv=function(){return Ni(mv)};var pv=Wt;var Yv=function(){return Ni(pv)};var Hv=yt;var Gv=3;var Bv=function(t){var r=new m(Gv,false);Ai(r,t.date);return Ni(Hv,r.data)};var Vv=fr;var wv=3;var xv=function(t){var r=new m(wv,false);Ai(r,t.date);return Ni(Vv,r.data)};var bv=Er;var Wv=function(){return Ni(bv)};var Kv={"A+":1,"A+R+":2,"A+R-":4,"A-":8,"A-R+":16,"A-R-":32};var Xv=function(t){var r={};Object.keys(t).forEach(function(e){r[e]=!!t[e]});return F(Kv,r)};var jv=function(t,r){var e=r.year,a=r.month,n=r.date;var i=e<<1|a>>3&1;var v=a<<5&224|n&31;t.setUint8(i);t.setUint8(v)};var zv=function(t,r){t.setUint8(Xv(r))};var Qv=Nr;var Zv=5;var kv=function(t){var r=new m(Zv,false);jv(r,t.date);zv(r,t.energies);r.setUint8(t.firstHalfhour);r.setUint8(t.halfhoursNumber);return Ni(Qv,r.data)};var qv=lr;var $v=function(){return Ni(qv)};var Jv=gr;var tE=function(){return Ni(Jv)};var rE=Ft;var eE=2;var aE=function(t){var r=new m(eE,false);r.setUint8(t.year);r.setUint8(t.month);return Ni(rE,r.data)};var nE=or;var iE=2;var vE=function(t){var r=new m(iE,false);r.setUint8(t.year);r.setUint8(t.month);return Ni(nE,r.data)};var EE=zt;var sE=function(t){var r=t.year,e=t.month;return Ni(EE,[r,e])};var _E=Tr;var oE=function(t){var r=t.year,e=t.month;return Ni(_E,[r,e])};var fE=Gt;var uE=function(){return Ni(fE)};var TE=hr;var AE=function(){return Ni(TE)};var RE=bt;var OE=function(t){return Ni(RE,[t.tariffTable])};var dE=wt;var cE=function(){return Ni(dE)};var lE=Kt;var NE=function(){return Ni(lE)};var UE=rr;var hE=3;var SE=function(t){var r=new m(hE,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return Ni(UE,r.data)};var LE=er;var DE=3;var IE=function(t){var r=new m(DE,false);r.setUint8(t.tariffTable);r.setUint8(t.index);r.setUint8(t.isActive?0:1);return Ni(LE,r.data)};var gE=Vt;var CE=function(){return Ni(gE)};var PE=Mt;var ME=5;var yE=function(t){var r=new m(ME,false);r.setUint8(t.tariffTable);r.setUint32(t.id);return Ni(PE,r.data)};var mE=kt;var FE=function(){return Ni(mE)};var pE=qt;var YE=function(){return Ni(pE)};var HE=ir;var GE=function(t){return Ni(HE,[t.tariffTable])};var BE=16;var VE=St;var wE=1+BE;var xE=function(t){var r=new m(wE,false);r.setUint8(t.accessLevel);r.setBytes(t.key);return Ni(VE,r.data)};var bE=Rr;var WE=2;var KE=function(t){var r=new m(WE,false);r.setInt16(t.seconds);return Ni(bE,r.data)};var XE=Ht;var jE=9;var zE=function(t){var r=new m(jE,false);_i(r,t);return Ni(XE,r.data)};var QE=ht;var ZE=8;var kE=function(t){var r=new m(ZE,false);Ei(r,t);return Ni(QE,r.data)};var qE=8;var $E=255;var JE=It;var ts=function(t){var r=t.periods.length<qE;var e=2+t.periods.length+ +r;var a=new m(e,false);a.setUint8(t.tariffTable);a.setUint8(t.index);t.periods.forEach(function(t){oi(a,t)});if(r){a.setUint8($E)}return Ni(JE,a.data)};var rs=Lr;var es=4;var as=function(t){var r=new m(es,false);di(r,t);return Ni(rs,r.data)};var ns=Or;var is=function(t){return Ni(ns,[t.displayMode].concat(i(t.order)))};var vs=Bt;var Es=jn;var ss=function(t){var r=new m(Es,false);Ti(r,t);return Ni(vs,r.data)};var _s=Sr;var os=17;var fs=function(t){var r=new m(os,false);ci(r,t);return Ni(_s,r.data)};var us=xt;var Ts=12;var As=function(t){var r=new m(Ts,false);r.setUint8(t.date.month);r.setUint8(t.date.date);r.setUint8(t.date.hours);r.setUint8(t.date.minutes);r.setInt32(t.saldoNew);r.setInt32(t.saldoOld);return Ni(us,r.data)};var Rs=Xt;var Os=37;var ds=function(t){var r=new m(Os,false);Ri(r,t);return Ni(Rs,r.data)};var cs=gt;var ls=Qn;var Ns=function(t){var r=new m(ls,false);r.setUint8(t.tariffTable);r.setUint8(t.index);fi(r,t);return Ni(cs,r.data)};var Us=Ct;var hs=6;var Ss=function(t){var r=new m(hs,false);r.setUint8(t.tariffTable);r.setUint8(t.index);ui(r,t);return Ni(Us,r.data)};var Ls=cr;var Ds=2;var Is=function(t){var r=new m(Ds,false);var e=0;if(t.readScreensInfo){e|=128}if(t.resetElectroMagneticIndication){e|=1}if(t.resetMagneticIndication){e|=2}r.setUint8(t.type);r.setUint8(e);return Ni(Ls,r.data)};var gs=Yt;var Cs=function(){return Ni(gs)};var Ps=pt;var Ms=function(){return Ni(Ps)};var ys=Vn;var ms={encrypt:function(){},decrypt:function(){}};var Fs=function(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:85;var e=r;t.forEach(function(t){e^=t});return e};var ps=e(e(e(e({},k,0),J,1),$,2),q,3);var Ys=function(t){var r=J;t.forEach(function(t){var e;if("accessLevel"in t){e=t.accessLevel}if("command"in t){e=t.command.accessLevel}if(ps[e]>ps[r]){r=e}});return r};var Hs=16;var Gs=[0];var Bs=function(t){return function(r,e){var a=e.messageId,n=a===void 0?1:a,v=e.accessLevel,E=v===void 0?Ys(r):v,s=e.aesKey;var _=r.flatMap(function(r){if("id"in r){return t[r.id](r.parameters||{})}if("command"in r){return r.command.bytes}throw new Error("wrong command format")});var o=E|16;var f=[n,o];var u=r.length===1&&"id"in r[0]&&r[0].id===ys;if(u){return f.concat(_)}var T=[].concat(o,_,Gs);if(E!==k){var A=(T.length+1)%Hs;if(A){T=T.concat(new Array(Hs-A).fill(0))}}T=T.concat(Fs(T));if(s&&E!==k){T=i(ms.encrypt(s,T))}return f.concat(T)}};var Vs={};var ws=Bs(Vs);Vs[Ui]=Si;Vs[Li]=Di;Vs[Ii]=gi;Vs[Ci]=Pi;Vs[Mi]=yi;Vs[mi]=Fi;Vs[pi]=Yi;Vs[Bi]=Vi;Vs[bi]=Wi;Vs[Ki]=ji;Vs[zi]=Zi;Vs[ki]=qi;Vs[$i]=tv;Vs[rv]=av;Vs[nv]=iv;Vs[vv]=Ev;Vs[sv]=_v;Vs[ov]=uv;Vs[Rv]=Ov;Vs[dv]=cv;Vs[Uv]=hv;Vs[Sv]=Lv;Vs[Dv]=gv;Vs[Cv]=Pv;Vs[Mv]=yv;Vs[mv]=Fv;Vs[pv]=Yv;Vs[Hv]=Bv;Vs[Vv]=xv;Vs[bv]=Wv;Vs[Qv]=kv;Vs[qv]=$v;Vs[Jv]=tE;Vs[rE]=aE;Vs[nE]=vE;Vs[EE]=sE;Vs[_E]=oE;Vs[fE]=uE;Vs[TE]=AE;Vs[RE]=OE;Vs[dE]=cE;Vs[lE]=NE;Vs[UE]=SE;Vs[LE]=IE;Vs[gE]=CE;Vs[PE]=yE;Vs[mE]=FE;Vs[pE]=YE;Vs[HE]=GE;Vs[VE]=xE;Vs[bE]=KE;Vs[XE]=zE;Vs[QE]=kE;Vs[JE]=ts;Vs[rs]=as;Vs[ns]=is;Vs[vs]=ss;Vs[_s]=fs;Vs[us]=As;Vs[Rs]=ds;Vs[cs]=Ns;Vs[Us]=Ss;Vs[Ls]=Is;Vs[gs]=Cs;Vs[Ps]=Ms;var xs=145;var bs=30;var Ws=function(t){var r=[bs,t.length+2,0,xs].concat(i(t));return[].concat(i(r),[Fs(r)])};toBytes=ws;getBase64FromBytes=li;setDataSegment=Ws})();
//#endregion


/*
  Incoming arguments:
    * msg - JSON message payload downlink message json
    * msgType - type of message, for ex. 'ATTRIBUTES_UPDATED', 'POST_TELEMETRY_REQUEST', etc.
    * metadata - list of key-value pairs with additional data about the message
    * integrationMetadata - list of key-value pairs with additional data defined in Integration executing this converter

  Output must be an object with the following fields:
    * contentType - BINARY
    * data - payload in base64
*/

var bytes = toBytes(msg.commands);

// send nothing if not fit in a single data segment
if ( bytes.length > MAX_DATA_SEGMENT_SIZE ) {
    bytes = [];
} else {
    bytes = setDataSegment(bytes);
}

var result = {
    contentType: 'BINARY',
    data: getBase64FromBytes(bytes)
};

return result;
